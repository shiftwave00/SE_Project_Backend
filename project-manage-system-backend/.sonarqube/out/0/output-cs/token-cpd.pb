º"
áC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Controllers\AuthorizeController.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Controllers( 3
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
AuthorizeController $
:% &
ControllerBase' 5
{ 
private 
readonly 
AuthorizeService )!
_authorizationService* ?
;? @
private 
readonly 
UserService $
_userService% 1
;1 2
public 
AuthorizeController "
(" #
IConfiguration# 1
configuration2 ?
,? @

PMSContextA K
contextL S
,S T
	JwtHelperU ^
jwt_ b
)b c
{ 	!
_authorizationService !
=" #
new$ '
AuthorizeService( 8
(8 9
context9 @
,@ A
configurationB O
,O P
jwtQ T
)T U
;U V
_userService 
= 
new 
UserService *
(* +
context+ 2
)2 3
;3 4
} 	
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
AuthenticateGithub) ;
(; <
GithubLoginDto< J
dtoK N
)N O
{ 	
return 
Ok 
( 
await !
_authorizationService 1
.1 2
AuthenticateGithub2 D
(D E
dtoE H
)H I
)I J
;J K
} 	
[ 	
HttpPost	 
( 
$str 
) 
] 
public   
IActionResult   
AuthenticateLocal   .
(  . /
LocalAccountDto  / >
dto  ? B
)  B C
{!! 	
var"" 
result"" 
="" !
_authorizationService"" .
."". /
AuthenticateLocal""/ @
(""@ A
dto""A D
)""D E
;""E F
if## 
(## 
result## 
!=## 
null## 
)## 
{$$ 
return%% 
Ok%% 
(%% 
result%%  
)%%  !
;%%! "
}&& 
return'' 
ValidationProblem'' $
(''$ %
$str''% A
)''A B
;''B C
}(( 	
[** 	
HttpPost**	 
]** 
public++ 
IActionResult++ 
CreateAdmin++ (
(++( )
LocalAccountDto++) 8
dto++9 <
,++< =
[++> ?
FromServices++? K
]++K L
IWebHostEnvironment++M `
webHostEnvironment++a s
)++s t
{,, 	
if-- 
(-- 
webHostEnvironment-- "
.--" #
EnvironmentName--# 2
==--3 5
$str--6 C
)--C D
{.. 
_userService// 
.// 

CreateUser// '
(//' (
dto//( +
)//+ ,
;//, -
return00 
Ok00 
(00 
)00 
;00 
}11 
else22 
{33 
return44 
NotFound44 
(44  
)44  !
;44! "
}55 
}66 	
[88 	
	Authorize88	 
]88 
[99 	
HttpGet99	 
]99 
public:: 
IActionResult:: 
CheckAuthentucate:: .
(::. /
)::/ 0
{;; 	
return<< 
Ok<< 
(<< 
User<< 
.<< 
Claims<< !
.<<! "
FirstOrDefault<<" 0
(<<0 1
c<<1 2
=><<3 5
c<<6 7
.<<7 8
Type<<8 <
.<<< =
Equals<<= C
(<<C D
$str<<D K
)<<K L
)<<L M
.<<M N
Value<<N S
)<<S T
;<<T U
}== 	
}>> 
}?? ∆
ÉC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Controllers\ErrorController.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Controllers( 3
{		 
[

 
ApiController

 
]

 
public 

class 
ErrorController  
:! "
ControllerBase# 1
{ 
private 
readonly 
ILogger  
_logger! (
;( )
public 
ErrorController 
( 
ILogger &
<& '
ErrorController' 6
>6 7
logger8 >
)> ?
{ 	
_logger 
= 
logger 
; 
} 	
[ 	
Route	 
( 
$str )
)) *
]* +
public 
IActionResult !
ErrorLocalDevelopment 2
(2 3
[ 	
FromServices	 
] 
IWebHostEnvironment *
webHostEnvironment+ =
)= >
{ 	
if 
( 
webHostEnvironment "
." #
EnvironmentName# 2
!=3 5
$str6 C
)C D
{ 
throw 
new %
InvalidOperationException 3
(3 4
$str P
)P Q
;Q R
} 
var 
context 
= 
HttpContext %
.% &
Features& .
.. /
Get/ 2
<2 3$
IExceptionHandlerFeature3 K
>K L
(L M
)M N
;N O
_logger   
.   
LogError   
(   
context   $
.  $ %
Error  % *
.  * +
Message  + 2
)  2 3
;  3 4
_logger!! 
.!! 
LogError!! 
(!! 
context!! $
.!!$ %
Error!!% *
.!!* +

StackTrace!!+ 5
)!!5 6
;!!6 7
return## 
NotFound## 
(## 
context## #
.### $
Error##$ )
.##) *
Message##* 1
)##1 2
;##2 3
}$$ 	
[&& 	
Route&&	 
(&& 
$str&& 
)&& 
]&& 
public'' 
IActionResult'' 
Error'' "
(''" #
)''# $
=>''% '
Problem''( /
(''/ 0
)''0 1
;''1 2
}(( 
})) ®Z
àC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Controllers\InvitationController.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Controllers( 3
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class  
InvitationController %
:& '
ControllerBase( 6
{ 
private 
readonly 
UserService $
_userService% 1
;1 2
private 
readonly 
InvitationService *
_invitationService+ =
;= >
private 
readonly 
RepoService $
_repoService% 1
;1 2
private 
readonly 
IHubContext $
<$ %
	NotifyHub% .
,. /

INotifyHub0 :
>: ;

_notifyHub< F
;F G
public  
InvitationController #
(# $

PMSContext$ .
	dbContext/ 8
,8 9
IHubContext: E
<E F
	NotifyHubF O
,O P

INotifyHubQ [
>[ \
	notifyHub] f
)f g
{ 	
_userService 
= 
new 
UserService *
(* +
	dbContext+ 4
)4 5
;5 6
_invitationService 
=  
new! $
InvitationService% 6
(6 7
	dbContext7 @
)@ A
;A B
_repoService 
= 
new 
RepoService *
(* +
	dbContext+ 4
)4 5
;5 6

_notifyHub 
= 
	notifyHub "
;" #
} 	
[ 	
	Authorize	 
] 
[   	
HttpGet  	 
(   
$str   "
)  " #
]  # $
public!! 
IActionResult!! 
IsOwner!! $
(!!$ %
int!!% (
id!!) +
)!!+ ,
{"" 	
if## 
(## 
_userService## 
.## 
IsProjectOwner## +
(##+ ,
_userService##, 8
.##8 9
GetUserModel##9 E
(##E F
User##F J
.##J K
Identity##K S
.##S T
Name##T X
)##X Y
,##Y Z
id##[ ]
)##] ^
)##^ _
{$$ 
return%% 
Ok%% 
(%% 
new%% 
ResponseDto%% )
{&& 
success'' 
='' 
true'' "
,''" #
message(( 
=(( 
$str(( 0
})) 
))) 
;)) 
}** 
return,, 
Ok,, 
(,, 
new,, 
ResponseDto,, %
{-- 
success.. 
=.. 
false.. 
,..  
message// 
=// 
$str// -
}00 
)00 
;00 
}11 	
[33 	
	Authorize33	 
]33 
[44 	
HttpPost44	 
(44 
$str44 
)44 
]44 
public55 
IActionResult55 
Invite55 #
(55# $
InvitationDto55$ 1
invitationDto552 ?
)55? @
{66 	
if77 
(77 
_userService77 
.77 
IsProjectOwner77 +
(77+ ,
_userService77, 8
.778 9
GetUserModel779 E
(77E F
User77F J
.77J K
Identity77K S
.77S T
Name77T X
)77X Y
,77Y Z
invitationDto77[ h
.77h i
	ProjectId77i r
)77r s
)77s t
{88 
return99 
Ok99 
(99 
_userService99 &
.99& '

GetAllUser99' 1
(991 2
User992 6
.996 7
Identity997 ?
.99? @
Name99@ D
)99D E
)99E F
;99F G
}:: 
return<< 
Ok<< 
(<< 
new<< 
ResponseDto<< %
{== 
success>> 
=>> 
false>> 
,>>  
message?? 
=?? 
$str?? F
}@@ 
)@@ 
;@@ 
}AA 	
[CC 	
	AuthorizeCC	 
]CC 
[DD 	
HttpPostDD	 
(DD 
$strDD "
)DD" #
]DD# $
publicEE 
asyncEE 
TaskEE 
<EE 
IActionResultEE '
>EE' (
SendInvitationEE) 7
(EE7 8
InvitationDtoEE8 E
invitationDtoEEF S
)EES T
{FF 	
ifGG 
(GG 
_userServiceGG 
.GG 
CheckUserExistGG +
(GG+ ,
invitationDtoGG, 9
.GG9 :
ApplicantIdGG: E
)GGE F
)GGF G
{HH 
UserII 
inviterII 
=II 
_userServiceII +
.II+ ,
GetUserModelII, 8
(II8 9
UserII9 =
.II= >
IdentityII> F
.IIF G
NameIIG K
)IIK L
;IIL M
UserJJ 
	applicantJJ 
=JJ  
_userServiceJJ! -
.JJ- .
GetUserModelJJ. :
(JJ: ;
invitationDtoJJ; H
.JJH I
ApplicantIdJJI T
)JJT U
;JJU V
ProjectKK 
projectKK 
=KK  !
_repoServiceKK" .
.KK. /!
GetProjectByProjectIdKK/ D
(KKD E
invitationDtoKKE R
.KKR S
	ProjectIdKKS \
)KK\ ]
;KK] ^
ifMM 
(MM 
_userServiceMM  
.MM  !
IsProjectOwnerMM! /
(MM/ 0
inviterMM0 7
,MM7 8
invitationDtoMM9 F
.MMF G
	ProjectIdMMG P
)MMP Q
&&MMR T
!MMU V
_invitationServiceMMV h
.MMh i
IsUserInProjectMMi x
(MMx y
	applicant	MMy Ç
,
MMÇ É
project
MMÑ ã
)
MMã å
)
MMå ç
{NN 
tryOO 
{PP 
varQQ 

invitationQQ &
=QQ' (
_invitationServiceQQ) ;
.QQ; <
CreateInvitationQQ< L
(QQL M
inviterQQM T
,QQT U
	applicantQQV _
,QQ_ `
projectQQa h
)QQh i
;QQi j
ifRR 
(RR 
!RR 
_invitationServiceRR /
.RR/ 0
IsInvitationExistRR0 A
(RRA B

invitationRRB L
)RRL M
)RRM N
{SS 
_invitationServiceTT .
.TT. /
AddInvitationTT/ <
(TT< =

invitationTT= G
)TTG H
;TTH I
awaitVV !

_notifyHubVV" ,
.VV, -
ClientsVV- 4
.VV4 5
GroupsVV5 ;
(VV; <

invitationVV< F
.VVF G
	ApplicantVVG P
.VVP Q
AccountVVQ X
)VVX Y
.VVY Z
ReceiveNotificationVVZ m
(VVm n
)VVn o
;VVo p
returnXX "
OkXX# %
(XX% &
newXX& )
ResponseDtoXX* 5
{YY 
successZZ  '
=ZZ( )
trueZZ* .
,ZZ. /
message[[  '
=[[( )
$str[[* ;
}\\ 
)\\ 
;\\ 
}]] 
else^^ 
{__ 
return`` "
Ok``# %
(``% &
new``& )
ResponseDto``* 5
{aa 
successbb  '
=bb( )
falsebb* /
,bb/ 0
messagecc  '
=cc( )
$strcc* M
}dd 
)dd 
;dd 
}ee 
}ff 
catchgg 
(gg 
	Exceptiongg $
egg% &
)gg& '
{hh 
returnii 
NotFoundii '
(ii' (
eii( )
)ii) *
;ii* +
}jj 
}kk 
elsell 
{mm 
returnnn 
Oknn 
(nn 
newnn !
ResponseDtonn" -
{oo 
successpp 
=pp  !
falsepp" '
,pp' (
messageqq 
=qq  !
$strqq" *
+qq+ ,
	applicantqq- 6
.qq6 7
Nameqq7 ;
+qq< =
$strqq> ]
}rr 
)rr 
;rr 
}ss 
}uu 
returnww 
Okww 
(ww 
newww 
ResponseDtoww %
{xx 
successyy 
=yy 
falseyy 
,yy  
messagezz 
=zz 
$strzz F
}{{ 
){{ 
;{{ 
}|| 	
[~~ 	
	Authorize~~	 
]~~ 
[ 	
HttpGet	 
] 
public
ÄÄ 
IActionResult
ÄÄ 
GetInvitations
ÄÄ +
(
ÄÄ+ ,
)
ÄÄ, -
{
ÅÅ 	
User
ÇÇ 
user
ÇÇ 
=
ÇÇ 
_userService
ÇÇ $
.
ÇÇ$ %
GetUserModel
ÇÇ% 1
(
ÇÇ1 2
User
ÇÇ2 6
.
ÇÇ6 7
Identity
ÇÇ7 ?
.
ÇÇ? @
Name
ÇÇ@ D
)
ÇÇD E
;
ÇÇE F
var
ÉÉ 
result
ÉÉ 
=
ÉÉ  
_invitationService
ÉÉ +
.
ÉÉ+ ,
GetInvitations
ÉÉ, :
(
ÉÉ: ;
user
ÉÉ; ?
)
ÉÉ? @
;
ÉÉ@ A
return
ÑÑ 
Ok
ÑÑ 
(
ÑÑ 
result
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 	
[
áá 	
	Authorize
áá	 
]
áá 
[
àà 	
HttpPost
àà	 
(
àà 
$str
àà 
)
àà 
]
àà 
public
ââ 
IActionResult
ââ 
ReplyToInvitation
ââ .
(
ââ. /"
ReplyToInvitationDto
ââ/ C"
replyToInvitationDto
ââD X
)
ââX Y
{
ää 	

Invitation
ãã 

invitation
ãã !
=
ãã" # 
_invitationService
ãã$ 6
.
ãã6 7
GetInvitation
ãã7 D
(
ããD E"
replyToInvitationDto
ããE Y
.
ããY Z
InvitationId
ããZ f
)
ããf g
;
ããg h
if
çç 
(
çç "
replyToInvitationDto
çç $
.
çç$ %
IsAgreed
çç% -
)
çç- .
{
éé 
_userService
èè 
.
èè 

AddProject
èè '
(
èè' (

invitation
èè( 2
)
èè2 3
;
èè3 4
}
êê 
try
íí 
{
ìì  
_invitationService
îî "
.
îî" #
DeleteInvitation
îî# 3
(
îî3 4

invitation
îî4 >
)
îî> ?
;
îî? @
return
ïï 
Ok
ïï 
(
ïï 
new
ïï 
ResponseDto
ïï )
{
ññ 
success
óó 
=
óó 
true
óó "
,
óó" #
message
òò 
=
òò 
$str
òò .
}
ôô 
)
ôô 
;
ôô 
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
e
õõ 
)
õõ 
{
úú 
return
ùù 
NotFound
ùù 
(
ùù  
e
ùù  !
)
ùù! "
;
ùù" #
}
ûû 
}
üü 	
}
†† 
}°° ¡É
ÖC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Controllers\ProjectController.cs
	namespace

 	)
project_manage_system_backend


 '
.

' (
Controllers

( 3
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
ProjectController "
:# $
ControllerBase% 3
{ 
private 
readonly 
ProjectService '
_projectService( 7
;7 8
private 
readonly 
UserService $
_userService% 1
;1 2
private 
readonly 

PMSContext #

_dbContext$ .
;. /
public 
ProjectController  
(  !

PMSContext! +
	dbContext, 5
)5 6
{ 	

_dbContext 
= 
	dbContext "
;" #
_projectService 
= 
new !
ProjectService" 0
(0 1

_dbContext1 ;
); <
;< =
_userService 
= 
new 
UserService *
(* +

_dbContext+ 5
)5 6
;6 7
} 	
[ 	
	Authorize	 
] 
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
IActionResult 

AddProject '
(' (

ProjectDto( 2

projectDto3 =
)= >
{ 	
try 
{   
_projectService!! 
.!!  
CreateProject!!  -
(!!- .

projectDto!!. 8
,!!8 9
User!!: >
.!!> ?
Identity!!? G
.!!G H
Name!!H L
)!!L M
;!!M N
return"" 
Ok"" 
("" 
new"" 
ResponseDto"" )
{## 
success$$ 
=$$ 
true$$ "
,$$" #
message%% 
=%% 
$str%% -
}&& 
)&& 
;&& 
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
return** 
Ok** 
(** 
new** 
ResponseDto** )
{++ 
success,, 
=,, 
false,, #
,,,# $
message-- 
=-- 
$str-- +
+--, -
ex--. 0
.--0 1
Message--1 8
}.. 
).. 
;.. 
}// 
}00 	
[22 	
	Authorize22	 
]22 
[33 	
HttpPost33	 
(33 
$str33 
)33 
]33 
public44 
IActionResult44 
EditProjectName44 ,
(44, -

ProjectDto44- 7

projectDto448 B
)44B C
{55 	
try66 
{77 #
CheckUserIsProjectOwner88 '
(88' (
User88( ,
.88, -
Identity88- 5
.885 6
Name886 :
,88: ;

projectDto88< F
.88F G
	ProjectId88G P
)88P Q
;88Q R
_projectService99 
.99  
EditProjectName99  /
(99/ 0

projectDto990 :
)99: ;
;99; <
return:: 
Ok:: 
(:: 
new:: 
ResponseDto:: )
{;; 
success<< 
=<< 
true<< "
,<<" #
message== 
=== 
$str== -
,==- .
}>> 
)>> 
;>> 
}?? 
catch@@ 
(@@ 
	Exception@@ 
ex@@ 
)@@  
{AA 
returnBB 
OkBB 
(BB 
newBB 
ResponseDtoBB )
{CC 
successDD 
=DD 
falseDD #
,DD# $
messageEE 
=EE 
exEE  
.EE  !
MessageEE! (
,EE( )
}FF 
)FF 
;FF 
}GG 
}II 	
[KK 	
	AuthorizeKK	 
]KK 
[LL 	

HttpDeleteLL	 
(LL 
$strLL *
)LL* +
]LL+ ,
publicMM 
IActionResultMM 
DeleteProjectMM *
(MM* +
intMM+ .
	projectIdMM/ 8
,MM8 9
stringMM: @
userIdMMA G
)MMG H
{NN 	
tryOO 
{PP #
CheckUserIsProjectOwnerQQ '
(QQ' (
userIdQQ( .
,QQ. /
	projectIdQQ0 9
)QQ9 :
;QQ: ;
_projectServiceSS 
.SS  
DeleteProjectSS  -
(SS- .
	projectIdSS. 7
)SS7 8
;SS8 9
returnUU 
OkUU 
(UU 
newUU 
ResponseDtoUU )
{VV 
successWW 
=WW 
trueWW "
,WW" #
messageXX 
=XX 
$strXX /
,XX/ 0
}YY 
)YY 
;YY 
}ZZ 
catch[[ 
([[ 
	Exception[[ 
ex[[ 
)[[  
{\\ 
return]] 
Ok]] 
(]] 
new]] 
ResponseDto]] )
{^^ 
success__ 
=__ 
false__ #
,__# $
message`` 
=`` 
ex``  
.``  !
Message``! (
,``( )
}aa 
)aa 
;aa 
}bb 
}cc 	
[ee 	
	Authorizeee	 
]ee 
[ff 	

HttpDeleteff	 
(ff 
$strff 1
)ff1 2
]ff2 3
publicgg 
IActionResultgg 
DeleteProjectMembergg 0
(gg0 1
intgg1 4
	projectIdgg5 >
,gg> ?
stringgg@ F
userIdggG M
)ggM N
{hh 	
tryii 
{jj #
CheckUserIsProjectOwnerkk '
(kk' (
Userkk( ,
.kk, -
Identitykk- 5
.kk5 6
Namekk6 :
,kk: ;
	projectIdkk< E
)kkE F
;kkF G
ifll 
(ll 
_userServicell  
.ll  !
CheckUserExistll! /
(ll/ 0
userIdll0 6
)ll6 7
)ll7 8
{mm 
varnn 
usernn 
=nn 
_userServicenn +
.nn+ ,
GetUserModelnn, 8
(nn8 9
userIdnn9 ?
)nn? @
;nn@ A
ifoo 
(oo 
!oo 
_userServiceoo %
.oo% &
IsProjectOwneroo& 4
(oo4 5
useroo5 9
,oo9 :
	projectIdoo; D
)ooD E
)ooE F
{pp 
_projectServiceqq '
.qq' (
DeleteProjectMemberqq( ;
(qq; <
userIdqq< B
,qqB C
	projectIdqqD M
)qqM N
;qqN O
returnss 
Okss !
(ss! "
newss" %
ResponseDtoss& 1
{tt 
successuu #
=uu$ %
trueuu& *
,uu* +
messagevv #
=vv$ %
$strvv& 7
,vv7 8
}ww 
)ww 
;ww 
}xx 
}yy 
elsezz 
{{{ 
return|| 
Ok|| 
(|| 
new|| !
ResponseDto||" -
{}} 
success~~ 
=~~  !
false~~" '
,~~' (
message 
=  !
$str" 5
,5 6
}
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
}
ÇÇ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÑÑ 
return
ÖÖ 
Ok
ÖÖ 
(
ÖÖ 
new
ÖÖ 
ResponseDto
ÖÖ )
{
ÜÜ 
success
áá 
=
áá 
false
áá #
,
áá# $
message
àà 
=
àà 
ex
àà  
.
àà  !
Message
àà! (
,
àà( )
}
ââ 
)
ââ 
;
ââ 
}
ää 
return
åå 
NotFound
åå 
(
åå 
)
åå 
;
åå 
}
çç 	
[
èè 	
	Authorize
èè	 
]
èè 
[
êê 	
HttpGet
êê	 
]
êê 
public
ëë 
IActionResult
ëë 

GetProject
ëë '
(
ëë' (
)
ëë( )
{
íí 	
var
ìì 
result
ìì 
=
ìì 
_projectService
ìì (
.
ìì( )%
GetProjectByUserAccount
ìì) @
(
ìì@ A
User
ììA E
.
ììE F
Identity
ììF N
.
ììN O
Name
ììO S
)
ììS T
;
ììT U
return
îî 
Ok
îî 
(
îî 
result
îî 
)
îî 
;
îî 
}
ïï 	
[
óó 	
	Authorize
óó	 
]
óó 
[
òò 	
HttpGet
òò	 
(
òò 
$str
òò 
)
òò 
]
òò 
public
ôô 
IActionResult
ôô "
GetAllProjectByAdmin
ôô 1
(
ôô1 2
)
ôô2 3
{
öö 	
if
õõ 
(
õõ 
_userService
õõ 
.
õõ 
IsAdmin
õõ $
(
õõ$ %
User
õõ% )
.
õõ) *
Identity
õõ* 2
.
õõ2 3
Name
õõ3 7
)
õõ7 8
)
õõ8 9
return
úú 
Ok
úú 
(
úú 
_projectService
úú )
.
úú) *
GetAllProject
úú* 7
(
úú7 8
)
úú8 9
)
úú9 :
;
úú: ;
return
ùù 

BadRequest
ùù 
(
ùù 
$str
ùù 3
)
ùù3 4
;
ùù4 5
}
ûû 	
[
†† 	
	Authorize
††	 
]
†† 
[
°° 	
HttpGet
°°	 
(
°° 
$str
°° 
)
°° 
]
°°  
public
¢¢ 
IActionResult
¢¢ 

GetProject
¢¢ '
(
¢¢' (
int
¢¢( +
	projectId
¢¢, 5
)
¢¢5 6
{
££ 	
var
§§ 
result
§§ 
=
§§ 
_projectService
§§ (
.
§§( )#
GetProjectByProjectId
§§) >
(
§§> ?
	projectId
§§? H
,
§§H I
User
§§J N
.
§§N O
Identity
§§O W
.
§§W X
Name
§§X \
)
§§\ ]
;
§§] ^
return
•• 
Ok
•• 
(
•• 
result
•• 
)
•• 
;
•• 
}
¶¶ 	
private
®® 
bool
®® %
CheckUserIsProjectOwner
®® ,
(
®®, -
string
®®- 3
userId
®®4 :
,
®®: ;
int
®®< ?
	projectId
®®@ I
)
®®I J
{
©© 	
if
™™ 
(
™™ 
_userService
™™ 
.
™™ 
CheckUserExist
™™ +
(
™™+ ,
userId
™™, 2
)
™™2 3
)
™™3 4
{
´´ 
var
¨¨ 
user
¨¨ 
=
¨¨ 
_userService
¨¨ '
.
¨¨' (
GetUserModel
¨¨( 4
(
¨¨4 5
userId
¨¨5 ;
)
¨¨; <
;
¨¨< =
if
≠≠ 
(
≠≠ 
_userService
≠≠  
.
≠≠  !
IsProjectOwner
≠≠! /
(
≠≠/ 0
user
≠≠0 4
,
≠≠4 5
	projectId
≠≠6 ?
)
≠≠? @
)
≠≠@ A
{
ÆÆ 
return
ØØ 
true
ØØ 
;
ØØ  
}
∞∞ 
else
±± 
{
≤≤ 
throw
≥≥ 
new
≥≥ 
	Exception
≥≥ '
(
≥≥' (
$str
≥≥( G
)
≥≥G H
;
≥≥H I
}
¥¥ 
}
µµ 
else
∂∂ 
{
∑∑ 
throw
∏∏ 
new
∏∏ 
	Exception
∏∏ #
(
∏∏# $
$str
∏∏$ A
)
∏∏A B
;
∏∏B C
}
ππ 
}
∫∫ 	
[
ºº 	
	Authorize
ºº	 
]
ºº 
[
ΩΩ 	
HttpGet
ΩΩ	 
(
ΩΩ 
$str
ΩΩ %
)
ΩΩ% &
]
ΩΩ& '
public
ææ 
IActionResult
ææ 
GetProjectMember
ææ -
(
ææ- .
int
ææ. 1
	projectId
ææ2 ;
)
ææ; <
{
øø 	
try
¿¿ 
{
¡¡ 
return
¬¬ 
Ok
¬¬ 
(
¬¬ 
_projectService
¬¬ )
.
¬¬) *
GetProjectMember
¬¬* :
(
¬¬: ;
	projectId
¬¬; D
)
¬¬D E
)
¬¬E F
;
¬¬F G
}
√√ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
≈≈ 
return
∆∆ 
NotFound
∆∆ 
(
∆∆  
ex
∆∆  "
.
∆∆" #
Message
∆∆# *
)
∆∆* +
;
∆∆+ ,
}
«« 
}
»» 	
[
   	
	Authorize
  	 
]
   
[
ÀÀ 	
	HttpPatch
ÀÀ	 
(
ÀÀ 
$str
ÀÀ  
)
ÀÀ  !
]
ÀÀ! "
public
ÃÃ 
IActionResult
ÃÃ $
EditProjectNameByAdmin
ÃÃ 3
(
ÃÃ3 4
int
ÃÃ4 7
	projectId
ÃÃ8 A
,
ÃÃA B
[
ÃÃC D
FromBody
ÃÃD L
]
ÃÃL M
JsonPatchDocument
ÃÃN _
<
ÃÃ_ `
Project
ÃÃ` g
>
ÃÃg h

newProject
ÃÃi s
)
ÃÃs t
{
ÕÕ 	
if
ŒŒ 
(
ŒŒ 
_userService
ŒŒ 
.
ŒŒ 
IsAdmin
ŒŒ $
(
ŒŒ$ %
User
ŒŒ% )
.
ŒŒ) *
Identity
ŒŒ* 2
.
ŒŒ2 3
Name
ŒŒ3 7
)
ŒŒ7 8
)
ŒŒ8 9
{
œœ 
if
–– 
(
–– 
_projectService
–– #
.
––# $$
EditProjectNameByAdmin
––$ :
(
––: ;
	projectId
––; D
,
––D E

newProject
––F P
)
––P Q
)
––Q R
{
—— 
return
““ 
Ok
““ 
(
““ 
new
““ !
ResponseDto
““" -
{
”” 
success
‘‘ 
=
‘‘  !
true
‘‘" &
,
‘‘& '
message
’’ 
=
’’  !
$str
’’" 3
}
÷÷ 
)
÷÷ 
;
÷÷ 
}
◊◊ 
return
ÿÿ 
Ok
ÿÿ 
(
ÿÿ 
new
ÿÿ 
ResponseDto
ÿÿ )
{
ŸŸ 
success
⁄⁄ 
=
⁄⁄ 
false
⁄⁄ #
,
⁄⁄# $
message
€€ 
=
€€ 
$str
€€ ,
}
‹‹ 
)
‹‹ 
;
‹‹ 
}
›› 
return
ﬁﬁ 

BadRequest
ﬁﬁ 
(
ﬁﬁ 
$str
ﬁﬁ ,
)
ﬁﬁ, -
;
ﬁﬁ- .
}
ﬂﬂ 	
[
·· 	
	Authorize
··	 
]
·· 
[
‚‚ 	

HttpDelete
‚‚	 
(
‚‚ 
$str
‚‚ !
)
‚‚! "
]
‚‚" #
public
„„ 
IActionResult
„„ "
DeleteProjectByAdmin
„„ 1
(
„„1 2
int
„„2 5
	projectId
„„6 ?
)
„„? @
{
‰‰ 	
if
ÂÂ 
(
ÂÂ 
_userService
ÂÂ 
.
ÂÂ 
IsAdmin
ÂÂ $
(
ÂÂ$ %
User
ÂÂ% )
.
ÂÂ) *
Identity
ÂÂ* 2
.
ÂÂ2 3
Name
ÂÂ3 7
)
ÂÂ7 8
)
ÂÂ8 9
{
ÊÊ 
try
ÁÁ 
{
ËË 
_projectService
ÈÈ #
.
ÈÈ# $
DeleteProject
ÈÈ$ 1
(
ÈÈ1 2
	projectId
ÈÈ2 ;
)
ÈÈ; <
;
ÈÈ< =
return
ÍÍ 
Ok
ÍÍ 
(
ÍÍ 
new
ÍÍ !
ResponseDto
ÍÍ" -
{
ÎÎ 
success
ÏÏ 
=
ÏÏ  !
true
ÏÏ" &
,
ÏÏ& '
message
ÌÌ 
=
ÌÌ  !
$str
ÌÌ" 3
}
ÓÓ 
)
ÓÓ 
;
ÓÓ 
}
ÔÔ 
catch
 
(
 
	Exception
  
e
! "
)
" #
{
ÒÒ 
return
ÚÚ 
Ok
ÚÚ 
(
ÚÚ 
new
ÚÚ !
ResponseDto
ÚÚ" -
{
ÛÛ 
success
ÙÙ 
=
ÙÙ  !
false
ÙÙ" '
,
ÙÙ' (
message
ıı 
=
ıı  !
$"
ıı" $
$str
ıı$ 1
{
ıı1 2
e
ıı2 3
.
ıı3 4
Message
ıı4 ;
}
ıı; <
"
ıı< =
}
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
}
˘˘ 
return
˙˙ 

BadRequest
˙˙ 
(
˙˙ 
$str
˙˙ ,
)
˙˙, -
;
˙˙- .
}
˚˚ 	
}
¸¸ 
}˝˝ Ö
ÇC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Controllers\RepoController.cs
	namespace		 	)
project_manage_system_backend		
 '
.		' (
Controllers		( 3
{

 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
RepoController 
:  !
ControllerBase" 0
{ 
private 
readonly 
RepoService $
_repoService% 1
;1 2
public 
RepoController 
( 

PMSContext (
	dbContext) 2
)2 3
{ 	
_repoService 
= 
new 
RepoService *
(* +
	dbContext+ 4
)4 5
;5 6
} 	
[ 	
	Authorize	 
] 
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
AddRepo) 0
(0 1

AddRepoDto1 ;

addRepoDto< F
)F G
{ 	
var 
result 
= 
await 
_repoService +
.+ ,
AddRepo, 3
(3 4

addRepoDto4 >
)> ?
;? @
return 
Ok 
( 
new 
ResponseDto %
{& '
success( /
=0 1
result2 8
.8 9
success9 @
,@ A
messageB I
=J K
resultL R
.R S
messageS Z
}[ \
)\ ]
;] ^
} 	
[ 	
	Authorize	 
] 
[ 	

HttpDelete	 
( 
$str *
)* +
]+ ,
public 
IActionResult 

DeleteRepo '
(' (
int( +
repoId, 2
,2 3
int4 7
	projectId8 A
)A B
{   	
try!! 
{"" 
bool## 
success## 
=## 
_repoService## +
.##+ ,

DeleteRepo##, 6
(##6 7
	projectId##7 @
,##@ A
repoId##B H
)##H I
;##I J
return$$ 
Ok$$ 
($$ 
new$$ 
ResponseDto$$ )
($$) *
)$$* +
{%% 
success&& 
=&& 
success&& %
,&&% &
message'' 
='' 
success'' %
?''& '
$str''( 1
:''2 3
$str''4 ;
}(( 
)(( 
;(( 
})) 
catch** 
(** 
	Exception** 
e** 
)** 
{++ 
return,, 
Ok,, 
(,, 
new,, 
ResponseDto,, )
(,,) *
),,* +
{-- 
success.. 
=.. 
false.. #
,..# $
message// 
=// 
e// 
.//  
Message//  '
}00 
)00 
;00 
}11 
}22 	
[44 	
	Authorize44	 
]44 
[55 	
HttpGet55	 
(55 
$str55 
)55 
]55 
public66 
IActionResult66 
GetRepoByProjectId66 /
(66/ 0
int660 3
id664 6
)666 7
{77 	
var88 
result88 
=88 
_repoService88 %
.88% &$
GetRepositoryByProjectId88& >
(88> ?
id88? A
)88A B
;88B C
return99 
Ok99 
(99 
result99 
)99 
;99 
}:: 	
};; 
}<< ®F
ÜC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Controllers\RepoInfoController.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Controllers( 3
{		 
[

 
Route

 

(


 
$str

 
)

 
]

 
[ 
ApiController 
] 
public 

class 
RepoInfoController #
:$ %
ControllerBase& 4
{ 
private 
readonly 
RepoInfoService (
_repoInfoService) 9
;9 :
private 
readonly 
SonarqubeService )
_sonarqubeService* ;
;; <
public 
RepoInfoController !
(! "

PMSContext" ,
	dbContext- 6
)6 7
{ 	
_repoInfoService 
= 
new "
RepoInfoService# 2
(2 3
	dbContext3 <
)< =
;= >
_sonarqubeService 
= 
new  #
SonarqubeService$ 4
(4 5
	dbContext5 >
)> ?
;? @
} 	
[ 	
	Authorize	 
] 
[ 	
HttpGet	 
( 
$str "
)" #
]# $
public 
async 
Task 
< 
IActionResult '
>' (
	GetCommit) 2
(2 3
int3 6
repoId7 =
)= >
{ 	
string 
oauth_token 
=  
User! %
.% &
Claims& ,
., -
FirstOrDefault- ;
(; <
c< =
=>> @
cA B
.B C
TypeC G
.G H
EqualsH N
(N O
$strO V
)V W
)W X
.X Y
ValueY ^
;^ _
return 
Ok 
( 
await 
_repoInfoService ,
., -
RequestCommit- :
(: ;
repoId; A
,A B
oauth_tokenC N
)N O
)O P
;P Q
} 	
[ 	
	Authorize	 
] 
[ 	
HttpGet	 
( 
$str $
)$ %
]% &
public   
async   
Task   
<   
IActionResult   '
>  ' (
GetCodebase  ) 4
(  4 5
int  5 8
repoId  9 ?
)  ? @
{!! 	
string"" 

oauthToken"" 
="" 
User""  $
.""$ %
Claims""% +
.""+ ,
FirstOrDefault"", :
("": ;
c""; <
=>""= ?
c""@ A
.""A B
Type""B F
.""F G
Equals""G M
(""M N
$str""N U
)""U V
)""V W
.""W X
Value""X ]
;""] ^
return## 
Ok## 
(## 
await## 
_repoInfoService## ,
.##, -
RequestCodebase##- <
(##< =
repoId##= C
,##C D

oauthToken##E O
)##O P
)##P Q
;##Q R
}$$ 	
[&& 	
	Authorize&&	 
]&& 
['' 	
HttpGet''	 
('' 
$str'' &
)''& '
]''' (
public(( 
async(( 
Task(( 
<(( 
IActionResult(( '
>((' ($
GetContributorsActtivity(() A
(((A B
int((B E
repoId((F L
)((L M
{)) 	
string** 

oauthToken** 
=** 
User**  $
.**$ %
Claims**% +
.**+ ,
FirstOrDefault**, :
(**: ;
c**; <
=>**= ?
c**@ A
.**A B
Type**B F
.**F G
Equals**G M
(**M N
$str**N U
)**U V
)**V W
.**W X
Value**X ]
;**] ^
return++ 
Ok++ 
(++ 
await++ 
_repoInfoService++ ,
.++, -'
RequestContributorsActivity++- H
(++H I
repoId++I O
,++O P

oauthToken++Q [
)++[ \
)++\ ]
;++] ^
},, 	
[.. 	
	Authorize..	 
].. 
[// 	
HttpGet//	 
(// 
$str// !
)//! "
]//" #
public00 
async00 
Task00 
<00 
IActionResult00 '
>00' (
GetIssue00) 1
(001 2
int002 5
repoId006 <
)00< =
{11 	
string22 

oauthToken22 
=22 
User22  $
.22$ %
Claims22% +
.22+ ,
FirstOrDefault22, :
(22: ;
c22; <
=>22= ?
c22@ A
.22A B
Type22B F
.22F G
Equals22G M
(22M N
$str22N U
)22U V
)22V W
.22W X
Value22X ]
;22] ^
return33 
Ok33 
(33 
await33 
_repoInfoService33 ,
.33, -
RequestIssue33- 9
(339 :
repoId33: @
,33@ A

oauthToken33B L
)33L M
)33M N
;33N O
}44 	
[66 	
	Authorize66	 
]66 
[77 	
HttpGet77	 
(77 
$str77 %
)77% &
]77& '
public88 
async88 
Task88 
<88 
IActionResult88 '
>88' (
GetSonarqube88) 5
(885 6
int886 9
repoid88: @
)88@ A
{99 	
return:: 
Ok:: 
(:: 
await:: 
_sonarqubeService:: -
.::- .!
GetSonarqubeInfoAsync::. C
(::C D
repoid::D J
)::J K
)::K L
;::L M
};; 	
[== 	
	Authorize==	 
]== 
[>> 	
HttpGet>>	 
(>> 
$str>> +
)>>+ ,
]>>, -
public?? 
async?? 
Task?? 
<?? 
IActionResult?? '
>??' (
IsHaveSonarqube??) 8
(??8 9
int??9 <
repoid??= C
)??C D
{@@ 	
returnAA 
OkAA 
(AA 
awaitAA 
_sonarqubeServiceAA -
.AA- .
IsHaveSonarqubeAA. =
(AA= >
repoidAA> D
)AAD E
)AAE F
;AAF G
}BB 	
[DD 	
HttpGetDD	 
(DD 
$strDD /
)DD/ 0
]DD0 1
publicEE 
asyncEE 
TaskEE 
<EE 
IActionResultEE '
>EE' (!
GetSonarqubeCodeSmellEE) >
(EE> ?
intEE? B
repoidEEC I
)EEI J
{FF 	
returnGG 
OkGG 
(GG 
awaitGG 
_sonarqubeServiceGG -
.GG- .&
GetSonarqubeCodeSmellAsyncGG. H
(GGH I
repoidGGI O
)GGO P
)GGP Q
;GGQ R
}HH 	
[JJ 	
HttpGetJJ	 
(JJ 
$strJJ )
)JJ) *
]JJ* +
publicKK 
asyncKK 
TaskKK 
<KK 
IActionResultKK '
>KK' (
GetSonarqubeBugKK) 8
(KK8 9
intKK9 <
repoidKK= C
)KKC D
{LL 	
returnMM 
OkMM 
(MM 
awaitMM 
_sonarqubeServiceMM -
.MM- . 
GetSonarqubeBugAsyncMM. B
(MMB C
repoidMMC I
)MMI J
)MMJ K
;MMK L
}NN 	
[PP 	
HttpGetPP	 
(PP 
$strPP .
)PP. /
]PP/ 0
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
IActionResultQQ '
>QQ' (
GetCoverageSheetQQ( 8
(QQ8 9
intQQ9 <
repoidQQ= C
)QQC D
{RR 	
returnSS 
OkSS 
(SS 
awaitSS 
_sonarqubeServiceSS -
.SS- .
GetCoverageSS. 9
(SS9 :
repoidSS: @
)SS@ A
)SSA B
;SSB C
}TT 	
[VV 	
HttpGetVV	 
(VV 
$strVV 2
)VV2 3
]VV3 4
publicWW 
asyncWW 
TaskWW 
<WW 
IActionResultWW '
>WW' (
GetDuplicationSheetWW) <
(WW< =
intWW= @
repoidWWA G
)WWG H
{XX 	
returnYY 
OkYY 
(YY 
awaitYY 
_sonarqubeServiceYY -
.YY- .
GetDuplicationYY. <
(YY< =
repoidYY= C
)YYC D
)YYD E
;YYE F
}ZZ 	
}[[ 
}\\ Ñ4
ÇC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Controllers\UserController.cs
	namespace

 	)
project_manage_system_backend


 '
.

' (
Controllers

( 3
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
UserController 
:  !
ControllerBase" 0
{ 
private 
readonly 
UserService $
_userService% 1
;1 2
public 
UserController 
( 

PMSContext (
	dbContext) 2
)2 3
{ 	
_userService 
= 
new 
UserService *
(* +
	dbContext+ 4
)4 5
;5 6
} 	
[ 	
	Authorize	 
] 
[ 	
HttpGet	 
] 
public 
IActionResult 
GetUser $
($ %
)% &
{ 	
return 
Ok 
( 
_userService "
." #
GetUser# *
(* +
User+ /
./ 0
Identity0 8
.8 9
Name9 =
)= >
)> ?
;? @
} 	
[ 	
	Authorize	 
] 
[ 	
HttpGet	 
( 
$str 
) 
] 
public   
IActionResult   

GetAllUser   '
(  ' (
)  ( )
{!! 	
return"" 
Ok"" 
("" 
_userService"" "
.""" # 
GetAllUserNotInclude""# 7
(""7 8
User""8 <
.""< =
Identity""= E
.""E F
Name""F J
)""J K
)""K L
;""L M
}## 	
[%% 	
	Authorize%%	 
]%% 
[&& 	

HttpDelete&&	 
]&& 
public'' 
IActionResult'' 

DeleteUser'' '
(''' (
string''( .
account''/ 6
)''6 7
{(( 	
try)) 
{** 
if++ 
(++ 
_userService++  
.++  !
IsAdmin++! (
(++( )
User++) -
.++- .
Identity++. 6
.++6 7
Name++7 ;
)++; <
)++< =
{,, 
_userService--  
.--  !
DeleteUserByAccount--! 4
(--4 5
account--5 <
)--< =
;--= >
return.. 
Ok.. 
(.. 
new.. !
ResponseDto.." -
{... /
success..0 7
=..8 9
true..: >
,..> ?
message..@ G
=..H I
$str..J [
}..\ ]
)..] ^
;..^ _
}// 
}00 
catch11 
(11 
System11 
.11 
	Exception11 #
e11$ %
)11% &
{22 
return33 
Ok33 
(33 
new33 
ResponseDto33 )
{33* +
success33, 3
=334 5
false336 ;
,33; <
message33= D
=33E F
$"33G I
$str33I U
{33U V
e33V W
.33W X
Message33X _
}33_ `
"33` a
}33b c
)33c d
;33d e
}44 
return55 

BadRequest55 
(55 
)55 
;55  
}66 	
[88 	
	Authorize88	 
]88 
[99 	
HttpPost99	 
(99 
$str99 
)99 
]99 
public:: 
IActionResult:: 
EditUserName:: )
(::) *
UserInfoDto::* 5
userinfoDto::6 A
)::A B
{;; 	
try<< 
{== 
_userService>> 
.>> 
EditUserName>> )
(>>) *
User>>* .
.>>. /
Identity>>/ 7
.>>7 8
Name>>8 <
,>>< =
userinfoDto>>> I
.>>I J
name>>J N
)>>N O
;>>O P
return?? 
Ok?? 
(?? 
new?? 
ResponseDto?? )
{@@ 
successAA 
=AA 
trueAA "
,AA" #
messageBB 
=BB 
$strBB .
}CC 
)CC 
;CC 
}DD 
catchEE 
(EE 
	ExceptionEE 
exEE 
)EE  
{FF 
returnGG 
OkGG 
(GG 
newGG 
ResponseDtoGG )
{HH 
successII 
=II 
falseII #
,II# $
messageJJ 
=JJ 
exJJ  
.JJ  !
MessageJJ! (
}KK 
)KK 
;KK 
}LL 
}MM 	
[OO 	
	AuthorizeOO	 
]OO 
[PP 	
	HttpPatchPP	 
(PP 
$strPP 
)PP 
]PP  
publicQQ 
IActionResultQQ 
EditUserInfoQQ )
(QQ) *
stringQQ* 0
accountQQ1 8
,QQ8 9
[QQ: ;
FromBodyQQ; C
]QQC D
JsonPatchDocumentQQE V
<QQV W
UserQQW [
>QQ[ \
newUserInfoQQ] h
)QQh i
{RR 	
ifSS 
(SS 
_userServiceSS 
.SS 
IsAdminSS $
(SS$ %
UserSS% )
.SS) *
IdentitySS* 2
.SS2 3
NameSS3 7
)SS7 8
)SS8 9
{TT 
ifUU 
(UU 
_userServiceUU  
.UU  !
EditUserInfoUU! -
(UU- .
accountUU. 5
,UU5 6
newUserInfoUU7 B
)UUB C
)UUC D
{VV 
returnWW 
OkWW 
(WW 
newWW !
ResponseDtoWW" -
{XX 
successYY 
=YY  !
trueYY" &
,YY& '
messageZZ 
=ZZ  !
$strZZ" 2
}[[ 
)[[ 
;[[ 
}\\ 
return^^ 
Ok^^ 
(^^ 
new^^ 
ResponseDto^^ )
{__ 
success`` 
=`` 
false`` #
,``# $
messageaa 
=aa 
$straa ,
}bb 
)bb 
;bb 
}cc 
returndd 

BadRequestdd 
(dd 
$strdd ,
)dd, -
;dd- .
}ee 	
}ff 
}gg Ö

wC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\AddRepoDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 

AddRepoDto 
{ 
public 
int 
	projectId 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
url		 
{		 
get		 
;		  
set		! $
;		$ %
}		& '
public 
bool 
isSonarqube 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string  
accountColonPassword *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
string 
sonarqubeUrl "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

projectKey  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
} ™
yC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\AuthorizeDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
AuthorizeDto 
{ 
public 
string 
Token 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
	Authority 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
UserAccount		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
}

 
} …
äC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\ContributorsCommitActivityDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
Author 
{ 
public 
string 
login 
{ 
get !
;! "
set# &
;& '
}( )
public		 
string		 

avatar_url		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
html_url

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
email 
{ 
get !
;! "
set# &
;& '
}( )
} 
public 

class 
Week 
{ 
public 
string 
ws 
{ 
get 
; 
set  #
;# $
}% &
public 
int 
w 
{ 
get 
; 
set 
;  
}! "
public 
int 
a 
{ 
get 
; 
set 
;  
}! "
public 
int 
d 
{ 
get 
; 
set 
;  
}! "
public 
int 
c 
{ 
get 
; 
set 
;  
}! "
} 
public 

class )
ContributorsCommitActivityDto .
{ 
public 
Author 
author 
{ 
get "
;" #
set$ '
;' (
}) *
public   
List   
<   
Week   
>   
weeks   
{    !
get  " %
;  % &
set  ' *
;  * +
}  , -
public!! 
int!! 
total!! 
{!! 
get!! 
;!! 
set!!  #
;!!# $
}!!% &
public"" 
int"" 
totalAdditions"" !
{""" #
get""$ '
;""' (
set"") ,
;"", -
}"". /
public## 
int## 
totalDeletions## !
{##" #
get##$ '
;##' (
set##) ,
;##, -
}##. /
public$$ 
string$$ 
commitsHtmlUrl$$ $
{$$% &
get$$' *
;$$* +
set$$, /
;$$/ 0
}$$1 2
}%% 
}&& ˇ
àC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Github\RequestCommitInfoDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
WeekTotalData 
{ 
public 
string 
Week 
{ 
get  
;  !
set" %
;% &
}' (
public

 
int

 
Total

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
} 
public 

class 
	DayCommit 
{ 
public 
string 
Day 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
Commit 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 

class 
DayOfWeekData 
{ 
public 
string 
Week 
{ 
get  
;  !
set" %
;% &
}' (
public 
List 
< 
	DayCommit 
> 
DetailDatas *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
public 

class  
RequestCommitInfoDto %
{ 
public 
List 
< 
WeekTotalData !
>! "
WeekTotalData# 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public!! 
List!! 
<!! 
DayOfWeekData!! !
>!!! "
DayOfWeekData!!# 0
{!!1 2
get!!3 6
;!!6 7
set!!8 ;
;!!; <
}!!= >
}"" 
}## ˙
ÉC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Github\RequestLoginDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
GithubLoginDto 
{ 
public 
string 
Code 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ˚
ÖC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Gitlab\RequestCommitsDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
., -
Gitlab- 3
{ 
public 

class 
Stats 
{ 
public 
int 
	additions 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
int		 
	deletions		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
int

 
total

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
} 
public 

class 
RequestCommitsDto "
{ 
public 
string 
committer_name $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
committer_email %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
committed_date &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
Stats 
stats 
{ 
get  
;  !
set" %
;% &
}' (
public 
List 
< 
string 
> 

parent_ids &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} ∏
âC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Gitlab\RequestContributorDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class !
RequestContributorDto &
{ 
public 
string 
name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
email 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
commits 
{ 
get  
;  !
set" %
;% &
}' (
} 
}		 Ã
ÉC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Gitlab\RequestIssueDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
., -
Gitlab- 3
{ 
public 

class 
Author 
{ 
public 
string 
username 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
web_url 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 

class 
RequestIssueDto  
{		 
public 
int 
iid 
{ 
get 
; 
set !
;! "
}# $
public 
string 
web_url 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
title 
{ 
get !
;! "
set# &
;& '
}( )
public 
Author 
author 
{ 
get "
;" #
set$ '
;' (
}) *
public!! 
string!! 
state!! 
{!! 
get!! !
;!!! "
set!!# &
;!!& '
}!!( )
public&& 
string&& 

created_at&&  
{&&! "
get&&# &
;&&& '
set&&( +
;&&+ ,
}&&- .
public++ 
string++ 
	closed_at++ 
{++  !
get++" %
;++% &
set++' *
;++* +
}++, -
},, 
}-- ◊
xC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Gitlab\User.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
., -
Gitlab- 3
{ 
public 

class 
User 
{ 
public 
int 
id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
username 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

avatar_url  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
web_url 
{ 
get  #
;# $
set% (
;( )
}* +
}		 
}

 Æ
zC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\InvitationDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
InvitationDto 
{ 
public 
string 
ApplicantId !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
	ProjectId 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public 

class  
ReplyToInvitationDto %
{		 
public

 
int

 
InvitationId

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
bool 
IsAgreed 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ê
zC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\LocalLoginDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
LocalAccountDto  
{ 
public 
string 
Account 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
}		 ä
wC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\ProjectDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 

ProjectDto 
{ 
public 
int 
	ProjectId 
{ 
set "
;" #
get$ '
;' (
}) *
public 
string 
ProjectName !
{" #
set$ '
;' (
get) ,
;, -
}. /
} 
} ÿ
}C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\ProjectResultDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
ProjectResultDto !
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
OwnerId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
	OwnerName 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
int		 
Members		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
}

 
} æ
zC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\RepoIssuesDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
RepoIssuesDto 
{ 
public 
string $
averageDealWithIssueTime .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public		 
List		 
<		 !
ResponseRepoIssuesDto		 )
>		) *

openIssues		+ 5
{		6 7
get		8 ;
;		; <
set		= @
;		@ A
}		B C
public 
List 
< !
ResponseRepoIssuesDto )
>) *
closeIssues+ 6
{7 8
get9 <
;< =
set> A
;A B
}C D
} 
} ±
|C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\RequestOauthDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
RequestOauthDto  
{ 
public 
string 
	Client_id 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Client_secret #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public		 
string		 
Code		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
}

 
} ﬂ
ÄC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\ResponseCodebaseDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
ResponseCodebaseDto $
{ 
public 
string 
date 
{ 
get  
;  !
set" %
;% &
}' (
public 
int 
numberOfRowsAdded $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
numberOfRowsDeleted &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
int 
numberOfRows 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} ∆
ÇC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\ResponseCommitInfoDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class !
ResponseCommitInfoDto &
{ 
public 
int 
week 
{ 
get 
; 
set "
;" #
}$ %
public 
int 
[ 
] 
days 
{ 
get 
;  
set! $
;$ %
}& '
public		 
int		 
total		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
}

 
} á
xC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\ResponseDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
ResponseDto 
{ 
public 
bool 
success 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
message 
{ 
get  #
;# $
set% (
;( )
}* +
} 
}		 á
ÄC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\ResponseRepoInfoDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
Owner 
{ 
public 
string 
login 
{ 
get !
;! "
set# &
;& '
}( )
public

 
string

 
name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
username 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

avatar_url  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
web_url 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 

class 
ResponseRepoInfoDto $
{ 
public 
bool 
success 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
message 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
url 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
html_url 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
Owner 
owner 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
web_url 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
id 
{ 
get 
; 
set  
;  !
}" #
}   
}!! ™
ÇC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\ResponseRepoIssuesDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
user 
{ 
public 
string 
login 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
html_url 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
public 

class !
ResponseRepoIssuesDto &
{ 
public 
int 
number 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
html_url 
{  
get! $
;$ %
set& )
;) *
}+ ,
public   
string   
title   
{   
get   !
;  ! "
set  # &
;  & '
}  ( )
public%% 
user%% 
user%% 
{%% 
get%% 
;%% 
set%%  #
;%%# $
}%%% &
public** 
string** 
state** 
{** 
get** !
;**! "
set**# &
;**& '
}**( )
public// 
string// 

created_at//  
{//! "
get//# &
;//& '
set//( +
;//+ ,
}//- .
public44 
string44 
	closed_at44 
{44  !
get44" %
;44% &
set44' *
;44* +
}44, -
}55 
}66 õ
ÄC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\ResponseUserInfoDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
ResponseUserInfoDto $
{ 
public 
string 
login 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 

avatar_url  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
}		 ¿
ÖC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Sonarqube\BugDataInfoDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 

BugDataDto 
{ 
public 
int 
total 
{ 
get 
; 
set  #
;# $
}% &
public 
List 
< 
Issues 
> 
issues "
{# $
get% (
;( )
set* -
;- .
}/ 0
}

 
} °
áC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Sonarqube\CodeSmellDataDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
CodeSmellDataDto !
{ 
public 
int 
total 
{ 
get 
; 
set  #
;# $
}% &
public 
List 
< 
Issues 
> 
issues "
{# $
get% (
;( )
set* -
;- .
}/ 0
}		 
public 

class 
Issues 
{ 
public 
string 
key 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
severity 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	component 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
line 
{ 
get 
; 
set "
;" #
}$ %
public 
string 
message 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ô
áC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Sonarqube\SonarqubeInfoDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
SonarqubeInfoDto !
{ 
public 
List 
< 
Measure 
> 
measures %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public		 
string		 
projectName		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
}

 
public 

class 
Measure 
{ 
public 
string 
metric 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
value 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
	component 
{  !
get" %
;% &
set' *
;* +
}, -
public 
bool 
	bestValue 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ≈
ÑC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\Sonarqube\SonarSheetDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{- .
public 

class 
SonarSheetDto 
{ 
public 
	Component 
baseComponent &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
List 
< 
	Component 
> 

components )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
}		 
public 

class 
	Component 
{ 
public 
string 
key 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
	qualifier 
{  !
get" %
;% &
set' *
;* +
}, -
public 
List 
< 
Measures 
> 
measures &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
public 

class 
Measures 
{ 
public 
string 
metric 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
value 
{ 
get !
;! "
set# &
;& '
}( )
} 
} û
xC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Dtos\UserInfoDto.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Dtos( ,
{ 
public 

class 
UserInfoDto 
{ 
public 
string 
id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
	avatarUrl 
{  !
get" %
;% &
set' *
;* +
}, -
} 
}		 Ë
{C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Factory\RepoFactory.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Factory( /
{ 
public 

class 
RepoFactory 
{		 
const

 
string

 

GITHUB_COM

 
=

  !
$str

" .
;

. /
const 
string 

GITLAB_COM 
=  !
$str" @
;@ A
public 
IRepo 
CreateRepoBy !
(! "
string" (
url) ,
,, -

HttpClient. 8

httpClient9 C
,C D
stringE K

oauthTokenL V
)V W
{ 	
string 
matchPatten 
=  
$str! Z
;Z [
if 
( 
Regex 
. 
IsMatch 
( 
url !
,! "
matchPatten# .
.. /
Replace/ 6
(6 7
$str7 A
,A B

GITHUB_COMC M
)M N
)N O
)O P
{ 
return 
new 

GithubRepo %
(% &

oauthToken& 0
,0 1

httpClient2 <
)< =
;= >
} 
else 
if 
( 
Regex 
. 
IsMatch "
(" #
url# &
,& '
matchPatten( 3
.3 4
Replace4 ;
(; <
$str< F
,F G

GITLAB_COMH R
)R S
)S T
)T U
{ 
return 
new 

GitlabRepo %
(% &

oauthToken& 0
,0 1

httpClient2 <
)< =
;= >
} 
else 
{ 
throw 
new 
	Exception #
(# $
$str$ 9
)9 :
;: ;
} 
} 	
} 
} ∂
C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Factory\RepoInfoFactory.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Factory( /
{ 
public 

class 
RepoInfoFactory  
{		 
public

 
	IRepoInfo

 
CreateRepoInfo

 '
(

' (
Repo

( ,
repo

- 1
,

1 2

HttpClient

3 =

httpClient

> H
,

H I
string

J P

oauthToken

Q [
)

[ \
{ 	
if 
( 
repo 
. 
Url 
. 
Contains !
(! "
$str" *
)* +
)+ ,
{ 
return 
new 

GithubInfo %
(% &

oauthToken& 0
,0 1

httpClient2 <
)< =
;= >
} 
else 
if 
( 
repo 
. 
Url 
. 
Contains &
(& '
$str' /
)/ 0
)0 1
{ 
return 
new 

GitlabInfo %
(% &

oauthToken& 0
,0 1

httpClient2 <
)< =
;= >
} 
else 
{ 
throw 
new 
	Exception #
(# $
$str$ 1
)1 2
;2 3
} 
} 	
} 
} ˚
wC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Hubs\INotifyHub.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Hubs( ,
{ 
public 

	interface 

INotifyHub 
{ 
Task 
ReceiveNotification  
(  !
)! "
;" #
Task		 !
SubscribeNotification		 "
(		" #
)		# $
;		$ %
Task #
UnsubscribeNotification $
($ %
)% &
;& '
} 
} Ç

vC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Hubs\NotifyHub.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Hubs( ,
{ 
public 

class 
	NotifyHub 
: 
Hub  
<  !

INotifyHub! +
>+ ,
{ 
public 
async 
Task !
SubscribeNotification /
(/ 0
string0 6
userAccount7 B
)B C
{		 	
await

 
Groups

 
.

 
AddToGroupAsync

 (
(

( )
Context

) 0
.

0 1
ConnectionId

1 =
,

= >
userAccount

? J
)

J K
;

K L
} 	
public 
async 
Task #
UnsubscribeNotification 1
(1 2
string2 8
userAccount9 D
)D E
{ 	
await 
Groups 
.  
RemoveFromGroupAsync -
(- .
Context. 5
.5 6
ConnectionId6 B
,B C
userAccountD O
)O P
;P Q
} 	
} 
} Ÿ
yC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Models\Invitation.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Models( .
{ 
public 

class 

Invitation 
{ 
public 
int 
ID 
{ 
get 
; 
set  
;  !
}" #
public 
User 
Inviter 
{ 
get !
;! "
set# &
;& '
}( )
public 
User 
	Applicant 
{ 
get  #
;# $
set% (
;( )
}* +
public 
Project 
InvitedProject %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public		 
bool		 
IsAgreed		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
}

 
} “
vC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Models\Project.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Models( .
{ 
public 

class 
Project 
{ 
public 
int 
ID 
{ 
get 
; 
set  
;  !
}" #
public		 
string		 
Name		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public 
User 
Owner 
{ 
get 
;  
set! $
;$ %
}& '
public 
List 
< 
Repo 
> 
Repositories &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
List; ?
<? @
Repo@ D
>D E
(E F
)F G
;G H
public 
List 
< 
UserProject 
>  
Users! &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
List; ?
<? @
UserProject@ K
>K L
(L M
)M N
;N O
} 
} ◊
sC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Models\Repo.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Models( .
{ 
public 

class 
Repo 
{ 
public 
int 
ID 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public		 
string		 
Url		 
{		 
get		 
;		  
set		! $
;		$ %
}		& '
public 
string 
Owner 
{ 
get !
;! "
set# &
;& '
}( )
public 
Project 
Project 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
bool 
IsSonarqube 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
AccountColonPw $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
SonarqubeUrl "
{# $
get% (
;( )
set* -
;- .
}/ 0
public"" 
string"" 

ProjectKey""  
{""! "
get""# &
;""& '
set""( +
;""+ ,
}""- .
public'' 
string'' 
RepoId'' 
{'' 
get'' "
;''" #
set''$ '
;''' (
}'') *
}(( 
})) Ë
sC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Models\User.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Models( .
{ 
public 

class 
User 
{ 
[ 	
Key	 
] 
public 
string 
Account 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
	AvatarUrl 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
	Authority 
{  !
get" %
;% &
set' *
;* +
}, -
public 
List 
< 
UserProject 
>  
Projects! )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
=8 9
new: =
List> B
<B C
UserProjectC N
>N O
(O P
)P Q
;Q R
} 
} æ
zC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Models\UserProject.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Models( .
{ 
public 

class 
UserProject 
{ 
public 
string 
Account 
{ 
get  #
;# $
set% (
;( )
}* +
public 
User 
User 
{ 
get 
; 
set  #
;# $
}% &
public 
int 
	ProjectId 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Project 
Project 
{  
get! $
;$ %
set& )
;) *
}+ ,
}		 
}

 ™
oC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Program.cs
	namespace 	)
project_manage_system_backend
 '
{ 
public		 

static		 
class		 
Program		 
{

 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
var 
logger 
= 
NLog 
. 
Web !
.! "
NLogBuilder" -
.- .
ConfigureNLog. ;
(; <
$str< I
)I J
.J K!
GetCurrentClassLoggerK `
(` a
)a b
;b c
try 
{ 
logger 
. 
Debug 
( 
$str (
)( )
;) *
CreateHostBuilder !
(! "
args" &
)& '
.' (
Build( -
(- .
). /
./ 0
Run0 3
(3 4
)4 5
;5 6
} 
catch 
( 
	Exception 
ex 
)  
{ 
logger 
. 
Error 
( 
ex 
,  
$str! G
)G H
;H I
throw 
; 
} 
finally 
{ 
NLog 
. 

LogManager 
.  
Shutdown  (
(( )
)) *
;* +
} 
} 	
public!! 
static!! 
IHostBuilder!! "
CreateHostBuilder!!# 4
(!!4 5
string!!5 ;
[!!; <
]!!< =
args!!> B
)!!B C
=>!!D F
Host"" 
.""  
CreateDefaultBuilder"" %
(""% &
args""& *
)""* +
.## $
ConfigureWebHostDefaults## )
(##) *

webBuilder##* 4
=>##5 7
{$$ 

webBuilder%% 
.%% 

UseStartup%% )
<%%) *
Startup%%* 1
>%%1 2
(%%2 3
)%%3 4
;%%4 5
}&& 
)&& 
.'' 
ConfigureLogging'' !
(''! "
logging''" )
=>''* ,
{(( 
logging)) 
.)) 
SetMinimumLevel)) +
())+ ,
	Microsoft)), 5
.))5 6

Extensions))6 @
.))@ A
Logging))A H
.))H I
LogLevel))I Q
.))Q R
Trace))R W
)))W X
;))X Y
}** 
)** 
.++ 
UseNLog++ 
(++ 
)++ 
;++ 
},, 
}-- õ†
{C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\RepoInfo\GithubInfo.cs
	namespace 	)
project_manage_system_backend
 '
.' (
RepoInfo( 0
{ 
public 

class 

GithubInfo 
: 
RepoInfoBase *
{ 
public 

GithubInfo 
( 
string  

oauthToken! +
,+ ,

HttpClient- 7

httpClient8 B
=C D
nullE I
)I J
:K L
baseM Q
(Q R

oauthTokenR \
,\ ]

httpClient^ h
)h i
{ 	
_httpClient 
. !
DefaultRequestHeaders -
.- .
Authorization. ;
=< =
new> A%
AuthenticationHeaderValueB [
([ \
$str\ d
,d e

oauthTokenf p
)p q
;q r
} 	
public 
override 
async 
Task "
<" #
List# '
<' (
ResponseCodebaseDto( ;
>; <
>< =
RequestCodebase> M
(M N
RepoN R
repoS W
)W X
{ 	
string 
repoURL 
= 
$str <
+= >
repo? C
.C D
OwnerD I
+J K
$strL O
+P Q
repoR V
.V W
NameW [
+\ ]
$str^ u
;u v
_httpClient 
. !
DefaultRequestHeaders -
.- .
Add. 1
(1 2
$str2 >
,> ?
$str@ I
)I J
;J K
var 
response 
= 
await  
_httpClient! ,
., -
GetAsync- 5
(5 6
repoURL6 =
)= >
;> ?
var 
contents 
= 
await  
response! )
.) *
Content* 1
.1 2
ReadAsStringAsync2 C
(C D
)D E
;E F
var 
	codebases 
= 

Newtonsoft &
.& '
Json' +
.+ ,
JsonConvert, 7
.7 8
DeserializeObject8 I
<I J
ListJ N
<N O
intO R
[R S
]S T
>T U
>U V
(V W
contentsW _
)_ `
;` a
List 
< 
ResponseCodebaseDto $
>$ %
codebaseSet& 1
=2 3
new4 7
List8 <
<< =
ResponseCodebaseDto= P
>P Q
(Q R
)R S
;S T
foreach!! 
(!! 
var!! 
codebase!! !
in!!" $
	codebases!!% .
)!!. /
{"" 
ResponseCodebaseDto## #
codebaseDto##$ /
=##0 1
new##2 5
ResponseCodebaseDto##6 I
(##I J
)##J K
{$$ 
date%% 
=%% 
DateHandler%% &
.%%& '
ConvertToDateString%%' :
(%%: ;
codebase%%; C
[%%C D
$num%%D E
]%%E F
)%%F G
,%%G H
numberOfRowsAdded&& %
=&&& '
Convert&&( /
.&&/ 0
ToInt32&&0 7
(&&7 8
codebase&&8 @
[&&@ A
$num&&A B
]&&B C
)&&C D
,&&D E
numberOfRowsDeleted'' '
=''( )
Convert''* 1
.''1 2
ToInt32''2 9
(''9 :
codebase'': B
[''B C
$num''C D
]''D E
)''E F
,''F G
numberOfRows((  
=((! "
Convert((# *
.((* +
ToInt32((+ 2
(((2 3
codebase((3 ;
[((; <
$num((< =
]((= >
)((> ?
+((@ A
Convert((B I
.((I J
ToInt32((J Q
(((Q R
codebase((R Z
[((Z [
$num(([ \
]((\ ]
)((] ^
})) 
;)) 
codebaseSet++ 
.++ 
Add++ 
(++  
codebaseDto++  +
)+++ ,
;++, -
},, 
int.. 
thisWeekRows.. 
=.. 
$num..  
;..  !
foreach00 
(00 
var00 
codebase00 !
in00" $
codebaseSet00% 0
)000 1
{11 
codebase22 
.22 
numberOfRows22 %
+=22& (
thisWeekRows22) 5
;225 6
thisWeekRows33 
=33 
codebase33 '
.33' (
numberOfRows33( 4
;334 5
}44 
return66 
codebaseSet66 
;66 
}77 	
public99 
override99 
async99 
Task99 "
<99" # 
RequestCommitInfoDto99# 7
>997 8
RequestCommit999 F
(99F G
Repo99G K
repo99L P
)99P Q
{:: 	
string;; 
url;; 
=;; 
$str;; 8
+;;9 :
repo;;; ?
.;;? @
Owner;;@ E
+;;F G
$str;;H K
+;;L M
repo;;N R
.;;R S
Name;;S W
+;;X Y
$str;;Z r
;;;r s
var== 
response== 
=== 
await==  
_httpClient==! ,
.==, -
GetAsync==- 5
(==5 6
url==6 9
)==9 :
;==: ;
if?? 
(?? 
response?? 
.?? 

StatusCode?? #
==??$ &
System??' -
.??- .
Net??. 1
.??1 2
HttpStatusCode??2 @
.??@ A
Accepted??A I
)??I J
{@@ 
awaitAA 
TaskAA 
.AA 
DelayAA  
(AA  !
$numAA! %
)AA% &
;AA& '
responseBB 
=BB 
awaitBB  
_httpClientBB! ,
.BB, -
GetAsyncBB- 5
(BB5 6
urlBB6 9
)BB9 :
;BB: ;
}CC 
stringEE 
contentEE 
=EE 
awaitEE "
responseEE# +
.EE+ ,
ContentEE, 3
.EE3 4
ReadAsStringAsyncEE4 E
(EEE F
)EEF G
;EEG H
varFF 
commitInfosFF 
=FF 
JsonSerializerFF ,
.FF, -
DeserializeFF- 8
<FF8 9
ListFF9 =
<FF= >!
ResponseCommitInfoDtoFF> S
>FFS T
>FFT U
(FFU V
contentFFV ]
)FF] ^
;FF^ _
ListHH 
<HH 
WeekTotalDataHH 
>HH 
weekChartDatasHH  .
=HH/ 0
newHH1 4
ListHH5 9
<HH9 :
WeekTotalDataHH: G
>HHG H
(HHH I
)HHI J
;HHJ K
ListII 
<II 
DayOfWeekDataII 
>II 
detailChartDatasII  0
=II1 2
newII3 6
ListII7 ;
<II; <
DayOfWeekDataII< I
>III J
(IIJ K
)IIK L
;IIL M
foreachKK 
(KK 
varKK 

commitInfoKK #
inKK$ &
commitInfosKK' 2
)KK2 3
{LL 
weekChartDatasMM 
.MM 
AddMM "
(MM" #"
ConvertToWeekChartDataMM# 9
(MM9 :

commitInfoMM: D
)MMD E
)MME F
;MMF G
detailChartDatasNN  
.NN  !
AddNN! $
(NN$ %$
ConvertToDetailChartDataNN% =
(NN= >

commitInfoNN> H
)NNH I
)NNI J
;NNJ K
}OO 
returnQQ 
newQQ  
RequestCommitInfoDtoQQ +
{RR 
WeekTotalDataSS 
=SS 
weekChartDatasSS  .
,SS. /
DayOfWeekDataTT 
=TT 
detailChartDatasTT  0
}UU 
;UU 
}VV 	
publicXX 
overrideXX 
asyncXX 
TaskXX "
<XX" #
ListXX# '
<XX' ()
ContributorsCommitActivityDtoXX( E
>XXE F
>XXF G'
RequestContributorsActivityXXH c
(XXc d
RepoXXd h
repoXXi m
)XXm n
{YY 	
stringZZ 
urlZZ 
=ZZ 
$strZZ 8
+ZZ9 :
repoZZ; ?
.ZZ? @
OwnerZZ@ E
+ZZF G
$strZZH K
+ZZL M
repoZZN R
.ZZR S
NameZZS W
+ZZX Y
$strZZZ o
;ZZo p
var[[ 
response[[ 
=[[ 
await[[  
_httpClient[[! ,
.[[, -
GetAsync[[- 5
([[5 6
url[[6 9
)[[9 :
;[[: ;
string\\ 
content\\ 
=\\ 
await\\ "
response\\# +
.\\+ ,
Content\\, 3
.\\3 4
ReadAsStringAsync\\4 E
(\\E F
)\\F G
;\\G H
var]] 
result]] 
=]] 
JsonSerializer]] '
.]]' (
Deserialize]]( 3
<]]3 4
List]]4 8
<]]8 9)
ContributorsCommitActivityDto]]9 V
>]]V W
>]]W X
(]]X Y
content]]Y `
)]]` a
;]]a b
result__ 
.__ 
Sort__ 
(__ 
(__ 
r1__ 
,__ 
r2__ 
)__  
=>__! #
r2__$ &
.__& '
total__' ,
.__, -
	CompareTo__- 6
(__6 7
r1__7 9
.__9 :
total__: ?
)__? @
)__@ A
;__A B
foreachaa 
(aa 
varaa 
itemaa 
inaa  
resultaa! '
)aa' (
{bb 
itemcc 
.cc 
commitsHtmlUrlcc #
=cc$ %
$"cc& (
$strcc( ;
{cc; <
repocc< @
.cc@ A
OwnerccA F
}ccF G
$strccG H
{ccH I
repoccI M
.ccM N
NameccN R
}ccR S
$strccS c
{ccc d
itemccd h
.cch i
authorcci o
.cco p
loginccp u
}ccu v
"ccv w
;ccw x
foreachdd 
(dd 
vardd 
weekdd !
indd" $
itemdd% )
.dd) *
weeksdd* /
)dd/ 0
{ee 
weekff 
.ff 
wsff 
=ff 
DateHandlerff )
.ff) *
ConvertToDateStringff* =
(ff= >
weekff> B
.ffB C
wffC D
)ffD E
;ffE F
itemgg 
.gg 
totalAdditionsgg '
+=gg( *
weekgg+ /
.gg/ 0
agg0 1
;gg1 2
itemhh 
.hh 
totalDeletionshh '
+=hh( *
weekhh+ /
.hh/ 0
dhh0 1
;hh1 2
}ii 
}jj 
returnkk 
resultkk 
;kk 
}ll 	
publicnn 
overridenn 
asyncnn 
Tasknn "
<nn" #
RepoIssuesDtonn# 0
>nn0 1
RequestIssuenn2 >
(nn> ?
Reponn? C
reponnD H
)nnH I
{oo 	
RepoIssuesDtopp 
resultpp  
=pp! "
newpp# &
RepoIssuesDtopp' 4
(pp4 5
)pp5 6
;pp6 7
Listqq 
<qq 
doubleqq 
>qq 

closedTimeqq #
=qq$ %
newqq& )
Listqq* .
<qq. /
doubleqq/ 5
>qq5 6
(qq6 7
)qq7 8
;qq8 9
stringrr 
urlrr 
=rr 
reporr 
.rr 
Urlrr !
.rr! "
Replacerr" )
(rr) *
$strrr* 7
,rr7 8
$strrr9 P
)rrP Q
;rrQ R
resultuu 
.uu 
closeIssuesuu 
=uu  
awaituu! &
GetRepoIssuesuu' 4
(uu4 5
$struu5 =
,uu= >
urluu? B
,uuB C
$numuuD G
)uuG H
;uuH I
resultvv 
.vv 

openIssuesvv 
=vv 
awaitvv  %
GetRepoIssuesvv& 3
(vv3 4
$strvv4 :
,vv: ;
urlvv< ?
,vv? @
$numvvA D
)vvD E
;vvE F
foreachxx 
(xx 
varxx 
itemxx 
inxx  
resultxx! '
.xx' (
closeIssuesxx( 3
)xx3 4
{yy 
DateTimezz 
closedzz 
=zz  !
Convertzz" )
.zz) *

ToDateTimezz* 4
(zz4 5
itemzz5 9
.zz9 :
	closed_atzz: C
)zzC D
;zzD E
DateTime{{ 
created{{  
={{! "
Convert{{# *
.{{* +

ToDateTime{{+ 5
({{5 6
item{{6 :
.{{: ;

created_at{{; E
){{E F
;{{F G
item}} 
.}} 
	closed_at}} 
=}}  
closed}}! '
.}}' (
ToString}}( 0
(}}0 1
$str}}1 F
)}}F G
;}}G H
item~~ 
.~~ 

created_at~~ 
=~~  !
created~~" )
.~~) *
ToString~~* 2
(~~2 3
$str~~3 H
)~~H I
;~~I J

closedTime
ÄÄ 
.
ÄÄ 
Add
ÄÄ 
(
ÄÄ 
(
ÄÄ  
closed
ÄÄ  &
-
ÄÄ' (
created
ÄÄ) 0
)
ÄÄ0 1
.
ÄÄ1 2
TotalSeconds
ÄÄ2 >
)
ÄÄ> ?
;
ÄÄ? @
}
ÅÅ 
foreach
ÇÇ 
(
ÇÇ 
var
ÇÇ 
item
ÇÇ 
in
ÇÇ  
result
ÇÇ! '
.
ÇÇ' (

openIssues
ÇÇ( 2
)
ÇÇ2 3
{
ÉÉ 
item
ÑÑ 
.
ÑÑ 

created_at
ÑÑ 
=
ÑÑ  !
Convert
ÑÑ" )
.
ÑÑ) *

ToDateTime
ÑÑ* 4
(
ÑÑ4 5
item
ÑÑ5 9
.
ÑÑ9 :

created_at
ÑÑ: D
)
ÑÑD E
.
ÑÑE F
ToString
ÑÑF N
(
ÑÑN O
$str
ÑÑO d
)
ÑÑd e
;
ÑÑe f
}
ÖÖ 
if
áá 
(
áá 

closedTime
áá 
.
áá 
Count
áá  
!=
áá! #
$num
áá$ %
)
áá% &
{
àà 
result
ââ 
.
ââ &
averageDealWithIssueTime
ââ /
=
ââ0 1
TimeSpan
ââ2 :
.
ââ: ;
FromSeconds
ââ; F
(
ââF G

closedTime
ââG Q
.
ââQ R
Average
ââR Y
(
ââY Z
)
ââZ [
)
ââ[ \
.
ââ\ ]
ToString
ââ] e
(
ââe f
$str
ââf }
)
ââ} ~
;
ââ~ 
result
ää 
.
ää &
averageDealWithIssueTime
ää /
=
ää0 1
result
ää2 8
.
ää8 9&
averageDealWithIssueTime
ää9 Q
.
ääQ R
Replace
ääR Y
(
ääY Z
$str
ääZ ^
,
ää^ _
$str
ää` i
)
ääi j
.
ääj k
Replace
ääk r
(
äär s
$str
ääs w
,
ääw x
$strääy Ö
)ääÖ Ü
.ääÜ á
Replaceääá é
(ääé è
$strääè í
,ääí ì
$strääî û
)ääû ü
.ääü †
Replaceää† ß
(ääß ®
$strää® ´
,ää´ ¨
$strää≠ ∂
)ää∂ ∑
;ää∑ ∏
}
ãã 
else
åå 
{
çç 
result
éé 
.
éé &
averageDealWithIssueTime
éé /
=
éé0 1
$str
éé2 ;
;
éé; <
}
èè 
return
êê 
result
êê 
;
êê 
}
ëë 	
private
ìì 
async
ìì 
Task
ìì 
<
ìì 
List
ìì 
<
ìì  #
ResponseRepoIssuesDto
ìì  5
>
ìì5 6
>
ìì6 7
GetRepoIssues
ìì8 E
(
ììE F
string
ììF L
state
ììM R
,
ììR S
string
ììT Z
url
ìì[ ^
,
ìì^ _
int
ìì` c
perPage
ììd k
)
ììk l
{
îî 	
List
ïï 
<
ïï #
ResponseRepoIssuesDto
ïï &
>
ïï& '
result
ïï( .
=
ïï/ 0
new
ïï1 4
List
ïï5 9
<
ïï9 :#
ResponseRepoIssuesDto
ïï: O
>
ïïO P
(
ïïP Q
)
ïïQ R
;
ïïR S
int
ññ 
page
ññ 
=
ññ 
$num
ññ 
;
ññ 
var
òò 
response
òò 
=
òò 
await
òò  
_httpClient
òò! ,
.
òò, -
GetAsync
òò- 5
(
òò5 6
url
òò6 9
+
òò: ;
$"
òò< >
$str
òò> L
{
òòL M
state
òòM R
}
òòR S
$str
òòS f
{
òòf g
page
òòg k
}
òòk l
$str
òòl y
"
òòy z
)
òòz {
;
òò{ |
string
ôô 
content
ôô 
=
ôô 
await
ôô "
response
ôô# +
.
ôô+ ,
Content
ôô, 3
.
ôô3 4
ReadAsStringAsync
ôô4 E
(
ôôE F
)
ôôF G
;
ôôG H
var
öö 
tempList
öö 
=
öö 
JsonSerializer
öö )
.
öö) *
Deserialize
öö* 5
<
öö5 6
List
öö6 :
<
öö: ;#
ResponseRepoIssuesDto
öö; P
>
ööP Q
>
ööQ R
(
ööR S
content
ööS Z
)
ööZ [
;
öö[ \
result
õõ 
.
õõ 
AddRange
õõ 
(
õõ 
tempList
õõ $
)
õõ$ %
;
õõ% &
return
ùù 
result
ùù 
;
ùù 
}
ûû 	
private
†† 
WeekTotalData
†† $
ConvertToWeekChartData
†† 4
(
††4 5#
ResponseCommitInfoDto
††5 J

commitInfo
††K U
)
††U V
{
°° 	
return
¢¢ 
new
¢¢ 
WeekTotalData
¢¢ $
{
££ 
Total
§§ 
=
§§ 

commitInfo
§§ "
.
§§" #
total
§§# (
,
§§( )
Week
•• 
=
•• 
DateHandler
•• "
.
••" #!
ConvertToDateString
••# 6
(
••6 7

commitInfo
••7 A
.
••A B
week
••B F
)
••F G
}
¶¶ 
;
¶¶ 
}
ßß 	
private
©© 
DayOfWeekData
©© &
ConvertToDetailChartData
©© 6
(
©©6 7#
ResponseCommitInfoDto
©©7 L

commitInfo
©©M W
)
©©W X
{
™™ 	
List
´´ 
<
´´ 
	DayCommit
´´ 
>
´´ 
detailDatas
´´ '
=
´´( )
new
´´* -
List
´´. 2
<
´´2 3
	DayCommit
´´3 <
>
´´< =
(
´´= >
)
´´> ?
;
´´? @
int
≠≠ 
dayOfWeekCount
≠≠ 
=
≠≠  
$num
≠≠! "
;
≠≠" #
foreach
ÆÆ 
(
ÆÆ 
var
ÆÆ 
day
ÆÆ 
in
ÆÆ 

commitInfo
ÆÆ  *
.
ÆÆ* +
days
ÆÆ+ /
)
ÆÆ/ 0
{
ØØ 
detailDatas
∞∞ 
.
∞∞ 
Add
∞∞ 
(
∞∞  
new
∞∞  #
	DayCommit
∞∞$ -
{
±± 
Day
≤≤ 
=
≤≤ 
DateHandler
≤≤ %
.
≤≤% & 
ConvertToDayOfWeek
≤≤& 8
(
≤≤8 9
dayOfWeekCount
≤≤9 G
++
≤≤G I
)
≤≤I J
,
≤≤J K
Commit
≥≥ 
=
≥≥ 
day
≥≥  
}
¥¥ 
)
¥¥ 
;
¥¥ 
}
µµ 
return
∑∑ 
new
∑∑ 
DayOfWeekData
∑∑ $
{
∏∏ 
Week
ππ 
=
ππ 
DateHandler
ππ "
.
ππ" #!
ConvertToDateString
ππ# 6
(
ππ6 7

commitInfo
ππ7 A
.
ππA B
week
ππB F
)
ππF G
,
ππG H
DetailDatas
∫∫ 
=
∫∫ 
detailDatas
∫∫ )
}
ªª 
;
ªª 
}
ºº 	
}
ææ 
}øø «õ
{C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\RepoInfo\GitlabInfo.cs
	namespace 	)
project_manage_system_backend
 '
.' (
RepoInfo( 0
{ 
public 

class 

GitlabInfo 
: 
RepoInfoBase *
{ 
private 
const 
string 
token "
=# $
$str% H
;H I
public 

GitlabInfo 
( 
string  

oauthToken! +
,+ ,

HttpClient- 7

httpClient8 B
=C D
nullE I
)I J
:K L
baseM Q
(Q R

oauthTokenR \
,\ ]

httpClient^ h
)h i
{ 	
} 	
public 
override 
async 
Task "
<" #
List# '
<' (
ResponseCodebaseDto( ;
>; <
>< =
RequestCodebase> M
(M N
RepoN R
repoS W
)W X
{ 	
var 
commits 
= 
await 
GetRequestCommits  1
(1 2
repo2 6
.6 7
RepoId7 =
)= >
;> ?
List 
< 
ResponseCodebaseDto $
>$ %
codebaseDtos& 2
=3 4$
BuildResponseCodebaseDto5 M
(M N
commitsN U
[U V
^V W
$numW X
]X Y
.Y Z
committed_dateZ h
)h i
;i j
foreach 
( 
var 
commit 
in  "
commits# *
)* +
{ 
var 
codebaseDto 
=  !
codebaseDtos" .
.. /
Find/ 3
(3 4
codebaseDto4 ?
=>@ B
codebaseDtoC N
.N O
dateO S
.S T
EqualsT Z
(Z [
GetDateOfWeek[ h
(h i
commiti o
.o p
committed_datep ~
)~ 
.	 Ä
ToShortDateString
Ä ë
(
ë í
)
í ì
)
ì î
)
î ï
;
ï ñ
codebaseDto 
. 
numberOfRowsAdded -
+=. 0
commit1 7
.7 8
stats8 =
.= >
	additions> G
;G H
codebaseDto 
. 
numberOfRowsDeleted /
-=0 2
commit3 9
.9 :
stats: ?
.? @
	deletions@ I
;I J
} 
int!! 
numberOfRows!! 
=!! 
$num!!  
;!!  !
foreach"" 
("" 
var"" 
codebaseDto"" $
in""% '
codebaseDtos""( 4
)""4 5
{## 
string$$ 
[$$ 
]$$ 
splitedString$$ &
=$$' (
codebaseDto$$) 4
.$$4 5
date$$5 9
.$$9 :
Split$$: ?
($$? @
$str$$@ C
)$$C D
;$$D E
codebaseDto%% 
.%% 
date%%  
=%%! "
$"%%# %
{%%% &
splitedString%%& 3
[%%3 4
$num%%4 5
]%%5 6
.%%6 7
PadLeft%%7 >
(%%> ?
$num%%? @
,%%@ A
$char%%B E
)%%E F
}%%F G
$str%%G H
{%%H I
splitedString%%I V
[%%V W
$num%%W X
]%%X Y
.%%Y Z
PadLeft%%Z a
(%%a b
$num%%b c
,%%c d
$char%%e h
)%%h i
}%%i j
"%%j k
;%%k l
numberOfRows&& 
+=&& 
codebaseDto&&  +
.&&+ ,
numberOfRowsAdded&&, =
+&&> ?
codebaseDto&&@ K
.&&K L
numberOfRowsDeleted&&L _
;&&_ `
codebaseDto'' 
.'' 
numberOfRows'' (
='') *
numberOfRows''+ 7
;''7 8
}(( 
return)) 
codebaseDtos)) 
;))  
}** 	
public,, 
override,, 
async,, 
Task,, "
<,," # 
RequestCommitInfoDto,,# 7
>,,7 8
RequestCommit,,9 F
(,,F G
Repo,,G K
repo,,L P
),,P Q
{-- 	 
RequestCommitInfoDto..  
requestCommitInfo..! 2
=..3 4
new..5 8 
RequestCommitInfoDto..9 M
(..M N
)..N O
;..O P
List// 
<// 
RequestCommitsDto// "
>//" #
requestCommits//$ 2
=//3 4
await//5 :
GetRequestCommits//; L
(//L M
repo//M Q
.//Q R
RepoId//R X
)//X Y
;//Y Z
requestCommitInfo00 
.00 
WeekTotalData00 +
=00, -
GetWeekTotalDatas00. ?
(00? @
requestCommits00@ N
)00N O
;00O P
requestCommitInfo11 
.11 
DayOfWeekData11 +
=11, -
GetDayOfWeekDatas11. ?
(11? @
requestCommits11@ N
)11N O
;11O P
return33 
requestCommitInfo33 $
;33$ %
}44 	
private66 
List66 
<66 
WeekTotalData66 "
>66" #
GetWeekTotalDatas66$ 5
(665 6
List666 :
<66: ;
RequestCommitsDto66; L
>66L M
requestCommits66N \
)66\ ]
{77 	
List88 
<88 
WeekTotalData88 
>88 
weekTotalDatas88  .
=88/ 0
new881 4
List885 9
<889 :
WeekTotalData88: G
>88G H
(88H I
)88I J
;88J K
List99 
<99 
Week99 
>99 
weeks99 
=99 

BuildWeeks99 )
(99) *
requestCommits99* 8
[998 9
^999 :
$num99: ;
]99; <
.99< =
committed_date99= K
)99K L
;99L M
foreach;; 
(;; 
var;; 
requestCommit;; &
in;;' )
requestCommits;;* 8
);;8 9
{<< 
String== 

commitWeek== !
===" #
GetDateOfWeek==$ 1
(==1 2
requestCommit==2 ?
.==? @
committed_date==@ N
)==N O
.==O P
ToShortDateString==P a
(==a b
)==b c
;==c d
Week>> 
week>> 
=>> 
weeks>> !
.>>! "
Find>>" &
(>>& '
week>>' +
=>>>, .
week>>/ 3
.>>3 4
ws>>4 6
.>>6 7
Equals>>7 =
(>>= >

commitWeek>>> H
)>>H I
)>>I J
;>>J K
week?? 
.?? 
c?? 
+=?? 
$num?? 
;?? 
}@@ 
foreachBB 
(BB 
WeekBB 
weekBB 
inBB !
weeksBB" '
)BB' (
{CC 
weekTotalDatasDD 
.DD 
AddDD "
(DD" #
newDD# &
WeekTotalDataDD' 4
{DD5 6
WeekDD7 ;
=DD< =
weekDD> B
.DDB C
wsDDC E
,DDE F
TotalDDG L
=DDM N
weekDDO S
.DDS T
cDDT U
}DDV W
)DDW X
;DDX Y
}EE 
returnGG 
weekTotalDatasGG !
;GG! "
}HH 	
privateJJ 
ListJJ 
<JJ 
DayOfWeekDataJJ "
>JJ" #
GetDayOfWeekDatasJJ$ 5
(JJ5 6
ListJJ6 :
<JJ: ;
RequestCommitsDtoJJ; L
>JJL M
requestCommitsJJN \
)JJ\ ]
{KK 	
ListLL 
<LL 
DayOfWeekDataLL 
>LL 
dayOfWeekDataLL  -
=LL. /
newLL0 3
ListLL4 8
<LL8 9
DayOfWeekDataLL9 F
>LLF G
(LLG H
)LLH I
;LLI J
ListMM 
<MM 
WeekMM 
>MM 
weeksMM 
=MM 

BuildWeeksMM )
(MM) *
requestCommitsMM* 8
[MM8 9
^MM9 :
$numMM: ;
]MM; <
.MM< =
committed_dateMM= K
)MMK L
;MML M
foreachOO 
(OO 
WeekOO 
weekOO 
inOO !
weeksOO" '
)OO' (
{PP 
ListQQ 
<QQ 
	DayCommitQQ 
>QQ 

dayCommitsQQ  *
=QQ+ ,
newQQ- 0
ListQQ1 5
<QQ5 6
	DayCommitQQ6 ?
>QQ? @
(QQ@ A
)QQA B
;QQB C
dayOfWeekDataRR 
.RR 
AddRR !
(RR! "
newRR" %
DayOfWeekDataRR& 3
{RR4 5
WeekRR6 :
=RR; <
weekRR= A
.RRA B
wsRRB D
,RRD E
DetailDatasRRF Q
=RRR S

dayCommitsRRT ^
}RR_ `
)RR` a
;RRa b
DateTimeSS 
weekDateSS !
=SS" #
DateTimeSS$ ,
.SS, -
ParseSS- 2
(SS2 3
weekSS3 7
.SS7 8
wsSS8 :
)SS: ;
;SS; <
forTT 
(TT 
intTT 
iTT 
=TT 
$numTT 
;TT 
iTT  !
<TT" #
$numTT$ %
;TT% &
iTT' (
++TT( *
)TT* +
{UU 
intVV 
commitsCountVV $
=VV% &
requestCommitsVV' 5
.VV5 6
FindAllVV6 =
(VV= >
requestCommitVV> K
=>VVL N
{VVO P
returnVVQ W
requestCommitVVX e
.VVe f
committed_dateVVf t
.VVt u
DateVVu y
==VVz |
weekDate	VV} Ö
.
VVÖ Ü
Date
VVÜ ä
;
VVä ã
}
VVå ç
)
VVç é
.
VVé è
Count
VVè î
;
VVî ï

dayCommitsWW 
.WW 
AddWW "
(WW" #
newWW# &
	DayCommitWW' 0
{WW1 2
DayWW3 6
=WW7 8
DateHandlerWW9 D
.WWD E
ConvertToDayOfWeekWWE W
(WWW X
iWWX Y
)WWY Z
,WWZ [
CommitWW\ b
=WWc d
commitsCountWWe q
}WWr s
)WWs t
;WWt u
weekDateXX 
=XX 
weekDateXX '
.XX' (
AddDaysXX( /
(XX/ 0
$numXX0 1
)XX1 2
;XX2 3
}YY 
}ZZ 
return\\ 
dayOfWeekData\\  
;\\  !
}]] 	
public__ 
override__ 
async__ 
Task__ "
<__" #
List__# '
<__' ()
ContributorsCommitActivityDto__( E
>__E F
>__F G'
RequestContributorsActivity__H c
(__c d
Repo__d h
repo__i m
)__m n
{`` 	
stringaa 
contributorUrlaa !
=aa" #
$"aa$ &
$straa& [
{aa[ \
repoaa\ `
.aa` a
RepoIdaaa g
}aag h
$str	aah Å
{
aaÅ Ç
token
aaÇ á
}
aaá à
"
aaà â
;
aaâ ä
varbb 
contributorResponsebb #
=bb$ %
awaitbb& +
_httpClientbb, 7
.bb7 8
GetAsyncbb8 @
(bb@ A
contributorUrlbbA O
)bbO P
;bbP Q
stringcc 
contributorContentcc %
=cc& '
awaitcc( -
contributorResponsecc. A
.ccA B
ContentccB I
.ccI J
ReadAsStringAsyncccJ [
(cc[ \
)cc\ ]
;cc] ^
vardd 
contributorResultdd !
=dd" #
JsonSerializerdd$ 2
.dd2 3
Deserializedd3 >
<dd> ?
Listdd? C
<ddC D!
RequestContributorDtoddD Y
>ddY Z
>ddZ [
(dd[ \
contributorContentdd\ n
)ddn o
;ddo p
varee 
commitsResultee 
=ee 
awaitee  %
GetRequestCommitsee& 7
(ee7 8
repoee8 <
.ee< =
RepoIdee= C
)eeC D
;eeD E
Listgg 
<gg )
ContributorsCommitActivityDtogg .
>gg. /
contributorsgg0 <
=gg= >
newgg? B
ListggC G
<ggG H)
ContributorsCommitActivityDtoggH e
>gge f
(ggf g
)ggg h
;ggh i
foreachhh 
(hh 
varhh 
itemhh 
inhh  
contributorResulthh! 2
)hh2 3
{ii 
contributorsjj 
.jj 
Addjj  
(jj  !
newjj! $)
ContributorsCommitActivityDtojj% B
{kk 
authorll 
=ll 
newll  
Dtosll! %
.ll% &
Authorll& ,
{ll- .
loginll/ 4
=ll5 6
itemll7 ;
.ll; <
namell< @
,ll@ A
emailllB G
=llH I
itemllJ N
.llN O
emailllO T
}llU V
,llV W
weeksnn 
=nn 

BuildWeeksnn &
(nn& '
commitsResultnn' 4
[nn4 5
^nn5 6
$numnn6 7
]nn7 8
.nn8 9
committed_datenn9 G
)nnG H
}oo 
)oo 
;oo 
}pp 
MapCommitsToWeeksqq 
(qq 
commitsResultqq +
,qq+ ,
contributorsqq- 9
)qq9 :
;qq: ;
contributorsrr 
.rr 
Sortrr 
(rr 
(rr 
r1rr !
,rr! "
r2rr# %
)rr% &
=>rr' )
r2rr* ,
.rr, -
totalrr- 2
.rr2 3
	CompareTorr3 <
(rr< =
r1rr= ?
.rr? @
totalrr@ E
)rrE F
)rrF G
;rrG H
return}} 
contributors}} 
;}}  
}~~ 	
private
ÄÄ 
async
ÄÄ 
Task
ÄÄ 
<
ÄÄ 
List
ÄÄ 
<
ÄÄ  
Dtos
ÄÄ  $
.
ÄÄ$ %
Gitlab
ÄÄ% +
.
ÄÄ+ ,
User
ÄÄ, 0
>
ÄÄ0 1
>
ÄÄ1 2
GetUsers
ÄÄ3 ;
(
ÄÄ; <
string
ÄÄ< B
repoId
ÄÄC I
)
ÄÄI J
{
ÅÅ 	
string
ÇÇ 
url
ÇÇ 
=
ÇÇ 
$"
ÇÇ 
$str
ÇÇ P
{
ÇÇP Q
repoId
ÇÇQ W
}
ÇÇW X
$str
ÇÇX _
{
ÇÇ_ `
token
ÇÇ` e
}
ÇÇe f
"
ÇÇf g
;
ÇÇg h
var
ÉÉ 
response
ÉÉ 
=
ÉÉ 
await
ÉÉ  
_httpClient
ÉÉ! ,
.
ÉÉ, -
GetAsync
ÉÉ- 5
(
ÉÉ5 6
url
ÉÉ6 9
)
ÉÉ9 :
;
ÉÉ: ;
var
ÑÑ 
content
ÑÑ 
=
ÑÑ 
await
ÑÑ 
response
ÑÑ  (
.
ÑÑ( )
Content
ÑÑ) 0
.
ÑÑ0 1
ReadAsStringAsync
ÑÑ1 B
(
ÑÑB C
)
ÑÑC D
;
ÑÑD E
var
ÖÖ 
users
ÖÖ 
=
ÖÖ 
JsonSerializer
ÖÖ &
.
ÖÖ& '
Deserialize
ÖÖ' 2
<
ÖÖ2 3
List
ÖÖ3 7
<
ÖÖ7 8
Dtos
ÖÖ8 <
.
ÖÖ< =
Gitlab
ÖÖ= C
.
ÖÖC D
User
ÖÖD H
>
ÖÖH I
>
ÖÖI J
(
ÖÖJ K
content
ÖÖK R
)
ÖÖR S
;
ÖÖS T
return
ÜÜ 
users
ÜÜ 
;
ÜÜ 
}
áá 	
private
ââ 
async
ââ 
Task
ââ 
<
ââ 
List
ââ 
<
ââ  
RequestCommitsDto
ââ  1
>
ââ1 2
>
ââ2 3
GetRequestCommits
ââ4 E
(
ââE F
string
ââF L
repoId
ââM S
)
ââS T
{
ää 	
string
ãã 

commitsUrl
ãã 
=
ãã 
$"
ãã  "
$str
ãã" W
{
ããW X
repoId
ããX ^
}
ãã^ _
$str
ãã_ s
{
ããs t
token
ããt y
}
ããy z
$strããz ó
"ããó ò
;ããò ô
var
åå 
commitsResponse
åå 
=
åå  !
await
åå" '
_httpClient
åå( 3
.
åå3 4
GetAsync
åå4 <
(
åå< =

commitsUrl
åå= G
)
ååG H
;
ååH I
string
çç 
commitsContent
çç !
=
çç" #
await
çç$ )
commitsResponse
çç* 9
.
çç9 :
Content
çç: A
.
ççA B
ReadAsStringAsync
ççB S
(
ççS T
)
ççT U
;
ççU V
var
éé 
commitsResult
éé 
=
éé 
JsonSerializer
éé  .
.
éé. /
Deserialize
éé/ :
<
éé: ;
List
éé; ?
<
éé? @
RequestCommitsDto
éé@ Q
>
ééQ R
>
ééR S
(
ééS T
commitsContent
ééT b
)
ééb c
.
ééc d
FindAll
ééd k
(
éék l
commit
éél r
=>
éés u
!
éév w
(
ééw x
commit
ééx ~
.
éé~ 

parent_idséé â
.ééâ ä
Countééä è
>ééê ë
$numééí ì
)ééì î
)ééî ï
;ééï ñ
var
èè 
xTotalPages
èè 
=
èè 

Enumerable
èè (
.
èè( )
ToList
èè) /
<
èè/ 0
string
èè0 6
>
èè6 7
(
èè7 8
commitsResponse
èè8 G
.
èèG H
Headers
èèH O
.
èèO P
	GetValues
èèP Y
(
èèY Z
$str
èèZ i
)
èèi j
)
èèj k
;
èèk l
int
êê 

xTotalPage
êê 
=
êê 
int
êê  
.
êê  !
Parse
êê! &
(
êê& '
xTotalPages
êê' 2
[
êê2 3
$num
êê3 4
]
êê4 5
)
êê5 6
;
êê6 7
for
íí 
(
íí 
int
íí 
i
íí 
=
íí 
$num
íí 
;
íí 
i
íí 
<=
íí  

xTotalPage
íí! +
;
íí+ ,
i
íí- .
++
íí. 0
)
íí0 1
{
ìì 
var
îî 
response
îî 
=
îî 
await
îî $
_httpClient
îî% 0
.
îî0 1
GetAsync
îî1 9
(
îî9 :
$"
îî: <
{
îî< =

commitsUrl
îî= G
}
îîG H
$str
îîH N
{
îîN O
i
îîO P
}
îîP Q
"
îîQ R
)
îîR S
;
îîS T
var
ïï 
content
ïï 
=
ïï 
await
ïï #
response
ïï$ ,
.
ïï, -
Content
ïï- 4
.
ïï4 5
ReadAsStringAsync
ïï5 F
(
ïïF G
)
ïïG H
;
ïïH I
commitsResult
ññ 
.
ññ 
AddRange
ññ &
(
ññ& '
JsonSerializer
ññ' 5
.
ññ5 6
Deserialize
ññ6 A
<
ññA B
List
ññB F
<
ññF G
RequestCommitsDto
ññG X
>
ññX Y
>
ññY Z
(
ññZ [
content
ññ[ b
)
ññb c
.
ññc d
FindAll
óó 
(
óó 
commit
óó "
=>
óó# %
!
óó& '
(
óó' (
commit
óó( .
.
óó. /

parent_ids
óó/ 9
.
óó9 :
Count
óó: ?
>
óó@ A
$num
óóB C
)
óóC D
)
óóD E
)
óóE F
;
óóF G
}
òò 
return
ôô 
commitsResult
ôô  
;
ôô  !
}
öö 	
private
úú 
List
úú 
<
úú 
Week
úú 
>
úú 

BuildWeeks
úú %
(
úú% &
DateTime
úú& .

commitDate
úú/ 9
)
úú9 :
{
ùù 	
List
ûû 
<
ûû 
Week
ûû 
>
ûû 
weeks
ûû 
=
ûû 
new
ûû "
List
ûû# '
<
ûû' (
Week
ûû( ,
>
ûû, -
(
ûû- .
)
ûû. /
;
ûû/ 0
var
üü 
vs
üü 
=
üü #
BuildFirstDaysOfWeeks
üü *
(
üü* +

commitDate
üü+ 5
)
üü5 6
;
üü6 7
foreach
°° 
(
°° 
var
°° 
v
°° 
in
°° 
vs
°°  
)
°°  !
{
¢¢ 
weeks
££ 
.
££ 
Add
££ 
(
££ 
new
££ 
Week
££ "
{
££# $
ws
££% '
=
££( )
v
££* +
}
££, -
)
££- .
;
££. /
}
§§ 
return
¶¶ 
weeks
¶¶ 
;
¶¶ 
}
ßß 	
private
©© 
List
©© 
<
©© !
ResponseCodebaseDto
©© (
>
©©( )&
BuildResponseCodebaseDto
©©* B
(
©©B C
DateTime
©©C K

commitDate
©©L V
)
©©V W
{
™™ 	
List
´´ 
<
´´ !
ResponseCodebaseDto
´´ $
>
´´$ %
codebaseDtos
´´& 2
=
´´3 4
new
´´5 8
List
´´9 =
<
´´= >!
ResponseCodebaseDto
´´> Q
>
´´Q R
(
´´R S
)
´´S T
;
´´T U
var
¨¨ 
weeks
¨¨ 
=
¨¨ #
BuildFirstDaysOfWeeks
¨¨ -
(
¨¨- .

commitDate
¨¨. 8
)
¨¨8 9
;
¨¨9 :
foreach
≠≠ 
(
≠≠ 
var
≠≠ 
week
≠≠ 
in
≠≠  
weeks
≠≠! &
)
≠≠& '
{
ÆÆ 
codebaseDtos
ØØ 
.
ØØ 
Add
ØØ  
(
ØØ  !
new
ØØ! $!
ResponseCodebaseDto
ØØ% 8
{
∞∞ 
date
±± 
=
±± 
week
±± 
,
±±  
numberOfRows
≤≤  
=
≤≤! "
$num
≤≤# $
,
≤≤$ %
numberOfRowsAdded
≥≥ %
=
≥≥& '
$num
≥≥( )
,
≥≥) *!
numberOfRowsDeleted
¥¥ '
=
¥¥( )
$num
¥¥* +
}
µµ 
)
µµ 
;
µµ 
}
∂∂ 
return
∑∑ 
codebaseDtos
∑∑ 
;
∑∑  
}
∏∏ 	
private
∫∫ 
List
∫∫ 
<
∫∫ 
string
∫∫ 
>
∫∫ #
BuildFirstDaysOfWeeks
∫∫ 2
(
∫∫2 3
DateTime
∫∫3 ;

commitDate
∫∫< F
)
∫∫F G
{
ªª 	
List
ºº 
<
ºº 
string
ºº 
>
ºº 
weeks
ºº 
=
ºº  
new
ºº! $
List
ºº% )
<
ºº) *
string
ºº* 0
>
ºº0 1
(
ºº1 2
)
ºº2 3
;
ºº3 4
var
ΩΩ 
dateOfCommitWeek
ΩΩ  
=
ΩΩ! "
GetDateOfWeek
ΩΩ# 0
(
ΩΩ0 1

commitDate
ΩΩ1 ;
)
ΩΩ; <
;
ΩΩ< =
var
ææ 
dateOfCurrentWeek
ææ !
=
ææ" #
GetDateOfWeek
ææ$ 1
(
ææ1 2
DateTime
ææ2 :
.
ææ: ;
Today
ææ; @
)
ææ@ A
;
ææA B
while
øø 
(
øø 
dateOfCommitWeek
øø #
<=
øø$ &
dateOfCurrentWeek
øø' 8
)
øø8 9
{
¿¿ 
weeks
¡¡ 
.
¡¡ 
Add
¡¡ 
(
¡¡ 
dateOfCommitWeek
¡¡ *
.
¡¡* +
ToShortDateString
¡¡+ <
(
¡¡< =
)
¡¡= >
)
¡¡> ?
;
¡¡? @
dateOfCommitWeek
¬¬  
=
¬¬! "
dateOfCommitWeek
¬¬# 3
.
¬¬3 4
AddDays
¬¬4 ;
(
¬¬; <
$num
¬¬< =
)
¬¬= >
;
¬¬> ?
}
√√ 
return
≈≈ 
weeks
≈≈ 
;
≈≈ 
}
∆∆ 	
private
»» 
DateTime
»» 
GetDateOfWeek
»» &
(
»»& '
DateTime
»»' /
dateTime
»»0 8
)
»»8 9
{
…… 	
return
   
dateTime
   
.
   
AddDays
   #
(
  # $
-
  $ %
(
  % &
(
  & '
int
  ' *
)
  * +
dateTime
  + 3
.
  3 4
	DayOfWeek
  4 =
)
  = >
)
  > ?
.
  ? @
Date
  @ D
;
  D E
}
ÀÀ 	
private
ÕÕ 
void
ÕÕ 
MapCommitsToWeeks
ÕÕ &
(
ÕÕ& '
List
ÕÕ' +
<
ÕÕ+ ,
RequestCommitsDto
ÕÕ, =
>
ÕÕ= >
commitsResult
ÕÕ? L
,
ÕÕL M
List
ÕÕN R
<
ÕÕR S+
ContributorsCommitActivityDto
ÕÕS p
>
ÕÕp q
contributors
ÕÕr ~
)
ÕÕ~ 
{
ŒŒ 	
foreach
œœ 
(
œœ 
var
œœ 
commit
œœ 
in
œœ  "
commitsResult
œœ# 0
)
œœ0 1
{
–– 
string
—— 

commitWeek
—— !
=
——" #
GetDateOfWeek
——$ 1
(
——1 2
commit
——2 8
.
——8 9
committed_date
——9 G
)
——G H
.
——H I
ToShortDateString
——I Z
(
——Z [
)
——[ \
;
——\ ]
foreach
““ 
(
““ 
var
““ 
contributor
““ (
in
““) +
contributors
““, 8
)
““8 9
{
”” 
if
‘‘ 
(
‘‘ 
contributor
‘‘ #
.
‘‘# $
author
‘‘$ *
.
‘‘* +
login
‘‘+ 0
.
‘‘0 1
Equals
‘‘1 7
(
‘‘7 8
commit
‘‘8 >
.
‘‘> ?
committer_name
‘‘? M
)
‘‘M N
&&
‘‘O Q
contributor
‘‘R ]
.
‘‘] ^
author
‘‘^ d
.
‘‘d e
email
‘‘e j
.
‘‘j k
Equals
‘‘k q
(
‘‘q r
commit
‘‘r x
.
‘‘x y
committer_email‘‘y à
)‘‘à â
)‘‘â ä
{
’’ 
Week
÷÷ 
week
÷÷ !
=
÷÷" #
contributor
÷÷$ /
.
÷÷/ 0
weeks
÷÷0 5
.
÷÷5 6
Find
÷÷6 :
(
÷÷: ;
week
÷÷; ?
=>
÷÷@ B
week
÷÷C G
.
÷÷G H
ws
÷÷H J
.
÷÷J K
Equals
÷÷K Q
(
÷÷Q R

commitWeek
÷÷R \
)
÷÷\ ]
)
÷÷] ^
;
÷÷^ _
week
◊◊ 
.
◊◊ 
a
◊◊ 
+=
◊◊ !
commit
◊◊" (
.
◊◊( )
stats
◊◊) .
.
◊◊. /
	additions
◊◊/ 8
;
◊◊8 9
week
ÿÿ 
.
ÿÿ 
d
ÿÿ 
+=
ÿÿ !
commit
ÿÿ" (
.
ÿÿ( )
stats
ÿÿ) .
.
ÿÿ. /
	deletions
ÿÿ/ 8
;
ÿÿ8 9
week
ŸŸ 
.
ŸŸ 
c
ŸŸ 
+=
ŸŸ !
$num
ŸŸ" #
;
ŸŸ# $
contributor
⁄⁄ #
.
⁄⁄# $
totalAdditions
⁄⁄$ 2
+=
⁄⁄3 5
commit
⁄⁄6 <
.
⁄⁄< =
stats
⁄⁄= B
.
⁄⁄B C
	additions
⁄⁄C L
;
⁄⁄L M
contributor
€€ #
.
€€# $
totalDeletions
€€$ 2
+=
€€3 5
commit
€€6 <
.
€€< =
stats
€€= B
.
€€B C
	deletions
€€C L
;
€€L M
contributor
‹‹ #
.
‹‹# $
total
‹‹$ )
+=
‹‹* ,
$num
‹‹- .
;
‹‹. /
break
›› 
;
›› 
}
ﬁﬁ 
}
ﬂﬂ 
}
‡‡ 
}
·· 	
public
„„ 
override
„„ 
async
„„ 
Task
„„ "
<
„„" #
RepoIssuesDto
„„# 0
>
„„0 1
RequestIssue
„„2 >
(
„„> ?
Repo
„„? C
repo
„„D H
)
„„H I
{
‰‰ 	
string
ÂÂ 
issueUrl
ÂÂ 
=
ÂÂ 
$"
ÂÂ  
$str
ÂÂ  U
{
ÂÂU V
repo
ÂÂV Z
.
ÂÂZ [
RepoId
ÂÂ[ a
}
ÂÂa b
$str
ÂÂb j
{
ÂÂj k
token
ÂÂk p
}
ÂÂp q
"
ÂÂq r
;
ÂÂr s
var
ÊÊ 
issueResponse
ÊÊ 
=
ÊÊ 
await
ÊÊ  %
_httpClient
ÊÊ& 1
.
ÊÊ1 2
GetAsync
ÊÊ2 :
(
ÊÊ: ;
issueUrl
ÊÊ; C
)
ÊÊC D
;
ÊÊD E
string
ÁÁ 
issueContent
ÁÁ 
=
ÁÁ  !
await
ÁÁ" '
issueResponse
ÁÁ( 5
.
ÁÁ5 6
Content
ÁÁ6 =
.
ÁÁ= >
ReadAsStringAsync
ÁÁ> O
(
ÁÁO P
)
ÁÁP Q
;
ÁÁQ R
var
ËË 
issueResult
ËË 
=
ËË 
JsonSerializer
ËË ,
.
ËË, -
Deserialize
ËË- 8
<
ËË8 9
List
ËË9 =
<
ËË= >
RequestIssueDto
ËË> M
>
ËËM N
>
ËËN O
(
ËËO P
issueContent
ËËP \
)
ËË\ ]
;
ËË] ^
List
ÈÈ 
<
ÈÈ #
ResponseRepoIssuesDto
ÈÈ &
>
ÈÈ& '

openIssues
ÈÈ( 2
=
ÈÈ3 4
new
ÈÈ5 8
List
ÈÈ9 =
<
ÈÈ= >#
ResponseRepoIssuesDto
ÈÈ> S
>
ÈÈS T
(
ÈÈT U
)
ÈÈU V
;
ÈÈV W
List
ÍÍ 
<
ÍÍ #
ResponseRepoIssuesDto
ÍÍ &
>
ÍÍ& '
closeIssues
ÍÍ( 3
=
ÍÍ4 5
new
ÍÍ6 9
List
ÍÍ: >
<
ÍÍ> ?#
ResponseRepoIssuesDto
ÍÍ? T
>
ÍÍT U
(
ÍÍU V
)
ÍÍV W
;
ÍÍW X
List
ÎÎ 
<
ÎÎ 
double
ÎÎ 
>
ÎÎ 

closedTime
ÎÎ #
=
ÎÎ$ %
new
ÎÎ& )
List
ÎÎ* .
<
ÎÎ. /
double
ÎÎ/ 5
>
ÎÎ5 6
(
ÎÎ6 7
)
ÎÎ7 8
;
ÎÎ8 9
RepoIssuesDto
ÏÏ 

repoIssues
ÏÏ $
=
ÏÏ% &
new
ÏÏ' *
RepoIssuesDto
ÏÏ+ 8
{
ÌÌ 

openIssues
ÓÓ 
=
ÓÓ 

openIssues
ÓÓ '
,
ÓÓ' (
closeIssues
ÔÔ 
=
ÔÔ 
closeIssues
ÔÔ )
}
 
;
 
foreach
ÚÚ 
(
ÚÚ 
var
ÚÚ 
issue
ÚÚ 
in
ÚÚ !
issueResult
ÚÚ" -
)
ÚÚ- .
{
ÛÛ 
if
ÙÙ 
(
ÙÙ 
issue
ÙÙ 
.
ÙÙ 
state
ÙÙ 
.
ÙÙ  
Equals
ÙÙ  &
(
ÙÙ& '
$str
ÙÙ' /
)
ÙÙ/ 0
)
ÙÙ0 1
{
ıı 

openIssues
ˆˆ 
.
ˆˆ 
Add
ˆˆ "
(
ˆˆ" #)
CreateResponseRepoIssuesDto
ˆˆ# >
(
ˆˆ> ?
issue
ˆˆ? D
)
ˆˆD E
)
ˆˆE F
;
ˆˆF G
}
˜˜ 
else
¯¯ 
{
˘˘ 
closeIssues
˙˙ 
.
˙˙  
Add
˙˙  #
(
˙˙# $)
CreateResponseRepoIssuesDto
˙˙$ ?
(
˙˙? @
issue
˙˙@ E
)
˙˙E F
)
˙˙F G
;
˙˙G H
}
˚˚ 
}
¸¸ 
foreach
ÄÄ 
(
ÄÄ 
var
ÄÄ 
item
ÄÄ 
in
ÄÄ  

repoIssues
ÄÄ! +
.
ÄÄ+ ,
closeIssues
ÄÄ, 7
)
ÄÄ7 8
{
ÅÅ 
DateTime
ÇÇ 
closed
ÇÇ 
=
ÇÇ  !
Convert
ÇÇ" )
.
ÇÇ) *

ToDateTime
ÇÇ* 4
(
ÇÇ4 5
item
ÇÇ5 9
.
ÇÇ9 :
	closed_at
ÇÇ: C
)
ÇÇC D
;
ÇÇD E
DateTime
ÉÉ 
created
ÉÉ  
=
ÉÉ! "
Convert
ÉÉ# *
.
ÉÉ* +

ToDateTime
ÉÉ+ 5
(
ÉÉ5 6
item
ÉÉ6 :
.
ÉÉ: ;

created_at
ÉÉ; E
)
ÉÉE F
;
ÉÉF G
item
ÖÖ 
.
ÖÖ 
	closed_at
ÖÖ 
=
ÖÖ  
closed
ÖÖ! '
.
ÖÖ' (
ToString
ÖÖ( 0
(
ÖÖ0 1
$str
ÖÖ1 F
)
ÖÖF G
;
ÖÖG H
item
ÜÜ 
.
ÜÜ 

created_at
ÜÜ 
=
ÜÜ  !
created
ÜÜ" )
.
ÜÜ) *
ToString
ÜÜ* 2
(
ÜÜ2 3
$str
ÜÜ3 H
)
ÜÜH I
;
ÜÜI J

closedTime
àà 
.
àà 
Add
àà 
(
àà 
(
àà  
closed
àà  &
-
àà' (
created
àà) 0
)
àà0 1
.
àà1 2
TotalSeconds
àà2 >
)
àà> ?
;
àà? @
}
ââ 
foreach
ää 
(
ää 
var
ää 
item
ää 
in
ää  

repoIssues
ää! +
.
ää+ ,

openIssues
ää, 6
)
ää6 7
{
ãã 
item
åå 
.
åå 

created_at
åå 
=
åå  !
Convert
åå" )
.
åå) *

ToDateTime
åå* 4
(
åå4 5
item
åå5 9
.
åå9 :

created_at
åå: D
)
ååD E
.
ååE F
ToString
ååF N
(
ååN O
$str
ååO d
)
ååd e
;
ååe f
}
çç 
if
èè 
(
èè 

closedTime
èè 
.
èè 
Count
èè  
!=
èè! #
$num
èè$ %
)
èè% &
{
êê 

repoIssues
ëë 
.
ëë &
averageDealWithIssueTime
ëë 3
=
ëë4 5
TimeSpan
ëë6 >
.
ëë> ?
FromSeconds
ëë? J
(
ëëJ K

closedTime
ëëK U
.
ëëU V
Average
ëëV ]
(
ëë] ^
)
ëë^ _
)
ëë_ `
.
ëë` a
ToString
ëëa i
(
ëëi j
$strëëj Å
)ëëÅ Ç
;ëëÇ É

repoIssues
íí 
.
íí &
averageDealWithIssueTime
íí 3
=
íí4 5

repoIssues
íí6 @
.
íí@ A&
averageDealWithIssueTime
ííA Y
.
ííY Z
Replace
ííZ a
(
íía b
$str
ííb f
,
ííf g
$str
ííh q
)
ííq r
.
íír s
Replace
íís z
(
ííz {
$str
íí{ 
,íí Ä
$strííÅ ç
)ííç é
.ííé è
Replaceííè ñ
(ííñ ó
$strííó ö
,ííö õ
$strííú ¶
)íí¶ ß
.ííß ®
Replaceíí® Ø
(ííØ ∞
$stríí∞ ≥
,íí≥ ¥
$strííµ æ
)ííæ ø
;ííø ¿
}
ìì 
else
îî 
{
ïï 

repoIssues
ññ 
.
ññ &
averageDealWithIssueTime
ññ 3
=
ññ4 5
$str
ññ6 ?
;
ññ? @
}
óó 
return
òò 

repoIssues
òò 
;
òò 
}
ôô 	
private
õõ #
ResponseRepoIssuesDto
õõ %)
CreateResponseRepoIssuesDto
õõ& A
(
õõA B
RequestIssueDto
õõB Q
issue
õõR W
)
õõW X
{
úú 	
return
ùù 
new
ùù #
ResponseRepoIssuesDto
ùù ,
{
ûû 
number
üü 
=
üü 
issue
üü 
.
üü 
iid
üü "
,
üü" #
title
†† 
=
†† 
issue
†† 
.
†† 
title
†† #
,
††# $
state
°° 
=
°° 
issue
°° 
.
°° 
state
°° #
,
°°# $
html_url
¢¢ 
=
¢¢ 
issue
¢¢  
.
¢¢  !
web_url
¢¢! (
,
¢¢( )

created_at
££ 
=
££ 
issue
££ "
.
££" #

created_at
££# -
,
££- .
	closed_at
§§ 
=
§§ 
issue
§§ !
.
§§! "
	closed_at
§§" +
,
§§+ ,
user
•• 
=
•• 
new
•• 
user
•• 
{
¶¶ 
html_url
ßß 
=
ßß 
issue
ßß $
.
ßß$ %
author
ßß% +
.
ßß+ ,
web_url
ßß, 3
,
ßß3 4
login
®® 
=
®® 
issue
®® !
.
®®! "
author
®®" (
.
®®( )
username
®®) 1
}
©© 
}
™™ 
;
™™ 
}
´´ 	
}
¨¨ 
}≠≠ ì

zC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\RepoInfo\IRepoInfo.cs
	namespace 	)
project_manage_system_backend
 '
.' (
RepoInfo( 0
{ 
public 

	interface 
	IRepoInfo 
{		 
public

 
Task

 
<

  
RequestCommitInfoDto

 (
>

( )
RequestCommit

* 7
(

7 8
Repo

8 <
repo

= A
)

A B
;

B C
public 
Task 
< 
List 
< 
ResponseCodebaseDto ,
>, -
>- .
RequestCodebase/ >
(> ?
Repo? C
repoD H
)H I
;I J
public 
Task 
< 
RepoIssuesDto !
>! "
RequestIssue# /
(/ 0
Repo0 4
repo5 9
)9 :
;: ;
public 
Task 
< 
List 
< )
ContributorsCommitActivityDto 6
>6 7
>7 8'
RequestContributorsActivity9 T
(T U
RepoU Y
repoZ ^
)^ _
;_ `
} 
} Ä
}C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\RepoInfo\RepoInfoBase.cs
	namespace 	)
project_manage_system_backend
 '
.' (
RepoInfo( 0
{ 
public		 

abstract		 
class		 
RepoInfoBase		 &
:		' (
	IRepoInfo		) 2
{

 
	protected 
readonly 

HttpClient %
_httpClient& 1
;1 2
	protected 
RepoInfoBase 
( 
string %

oauthToken& 0
,0 1

HttpClient2 <

httpClient= G
=H I
nullJ N
)N O
{ 	
_httpClient 
= 

httpClient $
??% '
new( +

HttpClient, 6
(6 7
)7 8
;8 9
_httpClient 
. !
DefaultRequestHeaders -
.- .
Add. 1
(1 2
$str2 >
,> ?
$str@ I
)I J
;J K
} 	
public 
abstract 
Task 
< 
List !
<! "
ResponseCodebaseDto" 5
>5 6
>6 7
RequestCodebase8 G
(G H
RepoH L
repoM Q
)Q R
;R S
public 
abstract 
Task 
<  
RequestCommitInfoDto 1
>1 2
RequestCommit3 @
(@ A
RepoA E
repoF J
)J K
;K L
public 
abstract 
Task 
< 
List !
<! ")
ContributorsCommitActivityDto" ?
>? @
>@ A'
RequestContributorsActivityB ]
(] ^
Repo^ b
repoc g
)g h
;h i
public 
abstract 
Task 
< 
RepoIssuesDto *
>* +
RequestIssue, 8
(8 9
Repo9 =
repo> B
)B C
;C D
} 
} ˘
}C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Repository\GithubRepo.cs
	namespace 	)
project_manage_system_backend
 '
.' (

Repository( 2
{ 
public 

class 

GithubRepo 
: 
RepoBase &
{ 
public		 

GithubRepo		 
(		 
string		  

oauthToken		! +
,		+ ,
System		- 3
.		3 4
Net		4 7
.		7 8
Http		8 <
.		< =

HttpClient		= G

httpClient		H R
)		R S
:		T U
base		V Z
(		Z [

oauthToken		[ e
,		e f

httpClient		g q
)		q r
{

 	
} 	
public 
override 
async 
Task "
<" #
ResponseRepoInfoDto# 6
>6 7$
GetRepositoryInformation8 P
(P Q
stringQ W
urlX [
)[ \
{ 	
url 
= 
url 
. 
Replace 
( 
$str $
,$ %
$str& (
)( )
;) *
url 
= 
url 
. 
Replace 
( 
$str *
,* +
$str, B
)B C
;C D
var 
result 
= 
await 
_httpClient *
.* +
GetAsync+ 3
(3 4
url4 7
)7 8
;8 9
string 
content 
= 
await "
result# )
.) *
Content* 1
.1 2
ReadAsStringAsync2 C
(C D
)D E
;E F
var 
response 
= 
JsonSerializer )
.) *
Deserialize* 5
<5 6
ResponseRepoInfoDto6 I
>I J
(J K
contentK R
)R S
;S T
response 
. 
success 
= 
string %
.% &
IsNullOrEmpty& 3
(3 4
response4 <
.< =
message= D
)D E
;E F
return 
response 
; 
} 	
} 
} ø
}C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Repository\GitlabRepo.cs
	namespace 	)
project_manage_system_backend
 '
.' (

Repository( 2
{ 
public 

class 

GitlabRepo 
: 
RepoBase &
{		 
private

 
const

 
string

 
ACCESS_TOKEN

 )
=

* +
$str

, O
;

O P
public 

GitlabRepo 
( 
string  

oauthToken! +
,+ ,

HttpClient- 7

httpClient8 B
)B C
:D E
baseF J
(J K

oauthTokenK U
,U V

httpClientW a
)a b
{ 	
} 	
public 
override 
async 
Task "
<" #
ResponseRepoInfoDto# 6
>6 7$
GetRepositoryInformation8 P
(P Q
stringQ W
urlX [
)[ \
{ 	
const 
string 
API_URL  
=! "
$str# Z
;Z [
const 
string 
TEMP_KEY_WORD &
=' (
$str) 3
;3 4
url 
= 
url 
. 
Replace 
( 
$str $
,$ %
$str& (
)( )
;) *
url 
= 
url 
. 
Replace 
( 
$str E
,E F
TEMP_KEY_WORDG T
)T U
;U V
url 
= 
url 
. 
Replace 
( 
$str !
,! "
$str# (
)( )
;) *
url 
= 
url 
. 
Replace 
( 
TEMP_KEY_WORD +
,+ ,
API_URL- 4
)4 5
;5 6
url 
= 
$" 
{ 
url 
} 
$str 
{ 
ACCESS_TOKEN '
}' (
"( )
;) *
var 
result 
= 
await 
_httpClient *
.* +
GetAsync+ 3
(3 4
url4 7
)7 8
;8 9
string 
content 
= 
await "
result# )
.) *
Content* 1
.1 2
ReadAsStringAsync2 C
(C D
)D E
;E F
var 
response 
= 
JsonSerializer )
.) *
Deserialize* 5
<5 6
ResponseRepoInfoDto6 I
>I J
(J K
contentK R
)R S
;S T
response 
. 
success 
= 
string %
.% &
IsNullOrEmpty& 3
(3 4
response4 <
.< =
message= D
)D E
;E F
return 
response 
; 
} 	
} 
} ¥
xC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Repository\IRepo.cs
	namespace 	)
project_manage_system_backend
 '
.' (

Repository( 2
{ 
public 

	interface 
IRepo 
{ 
public 
Task 
< 
ResponseRepoInfoDto '
>' ($
GetRepositoryInformation) A
(A B
stringB H
urlI L
)L M
;M N
}		 
}

 Ó
{C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Repository\RepoBase.cs
	namespace 	)
project_manage_system_backend
 '
.' (

Repository( 2
{ 
public 

abstract 
class 
RepoBase "
:# $
IRepo% *
{ 
	protected		 
readonly		 

HttpClient		 %
_httpClient		& 1
;		1 2
	protected

 
readonly

 
string

 !
_oauthToken

" -
;

- .
	protected 
RepoBase 
( 
string !

oauthToken" ,
,, -

HttpClient. 8

httpClient9 C
)C D
{ 	
_httpClient 
= 

httpClient $
??% '
new( +

HttpClient, 6
(6 7
)7 8
;8 9
_httpClient 
. !
DefaultRequestHeaders -
.- .
Add. 1
(1 2
$str2 >
,> ?
$str@ I
)I J
;J K
_oauthToken 
= 

oauthToken $
;$ %
} 	
public 
abstract 
Task 
< 
ResponseRepoInfoDto 0
>0 1$
GetRepositoryInformation2 J
(J K
stringK Q
urlR U
)U V
;V W
} 
} ∆R
ÅC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Services\AuthorizeService.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Services( 0
{ 
public 

class 
AuthorizeService !
:" #
BaseService$ /
{ 
private 
readonly 
	JwtHelper "

_jwtHelper# -
;- .
private 
readonly 
UserService $
_userService% 1
;1 2
private 
readonly 

HttpClient #
_httpClient$ /
;/ 0
public 
AuthorizeService 
(  

PMSContext  *
	dbContext+ 4
,4 5
IConfiguration  .
configuration/ <
,< =
	JwtHelper  )
jwt* -
,- .

HttpClient  *
client+ 1
=2 3
null4 8
)8 9
:: ;
base< @
(@ A
	dbContextA J
,J K
configurationL Y
)Y Z
{ 	
_configuration 
= 
configuration *
;* +

_jwtHelper 
= 
jwt 
; 
_httpClient 
= 
client  
??! #
new$ '

HttpClient( 2
(2 3
)3 4
;4 5
_userService 
= 
new 
UserService *
(* +
	dbContext+ 4
)4 5
;5 6
} 	
public!! 
async!! 
Task!! 
<!! 
AuthorizeDto!! &
>!!& '
AuthenticateGithub!!( :
(!!: ;
GithubLoginDto!!; I
dto!!J M
)!!M N
{"" 	
string## 
accessToken## 
=##  
await##! &$
RequestGithubAccessToken##' ?
(##? @
dto##@ C
.##C D
Code##D H
)##H I
;##I J
if%% 
(%% 
!%% 
string%% 
.%% 
IsNullOrEmpty%% %
(%%% &
accessToken%%& 1
)%%1 2
)%%2 3
{&& 
User'' 
user'' 
='' 
await'' !!
RequestGithubUserInfo''" 7
(''7 8
accessToken''8 C
)''C D
;''D E
if)) 
()) 
!)) 
_userService)) !
.))! "
CheckUserExist))" 0
())0 1
user))1 5
.))5 6
Account))6 =
)))= >
)))> ?
{** 
_userService++  
.++  !

CreateUser++! +
(+++ ,
user++, 0
)++0 1
;++1 2
},, 
return.. 
new.. 
AuthorizeDto.. '
{// 
Token00 
=00 

_jwtHelper00 &
.00& '
GenerateToken00' 4
(004 5
user005 9
.009 :
Account00: A
,00A B
accessToken00C N
,00N O
user00P T
.00T U
	Authority00U ^
)00^ _
,00_ `
	Authority11 
=11 
user11  $
.11$ %
	Authority11% .
,11. /
UserAccount22 
=22  !
user22" &
.22& '
Account22' .
}33 
;33 
}44 
else55 
{66 
throw77 
new77 
	Exception77 #
(77# $
$str77$ 0
)770 1
;771 2
}88 
}99 	
public;; 
AuthorizeDto;; 
AuthenticateLocal;; -
(;;- .
LocalAccountDto;;. =
dto;;> A
);;A B
{<< 	
User== 
	loginUser== 
=== 

_dbContext== '
.==' (
Users==( -
.==- .
Find==. 2
(==2 3
dto==3 6
.==6 7
Account==7 >
)==> ?
;==? @
if?? 
(?? 
	loginUser?? 
!=?? 
null?? !
&&??" $
Argon2??% +
.??+ ,
Verify??, 2
(??2 3
	loginUser??3 <
.??< =
Password??= E
,??E F
dto??G J
.??J K
Password??K S
)??S T
)??T U
{@@ 
stringAA 
accessTokenAA "
=AA# $
_configurationAA% 3
.AA3 4
GetValueAA4 <
<AA< =
stringAA= C
>AAC D
(AAD E
$strAAE _
)AA_ `
;AA` a
returnBB 
newBB 
AuthorizeDtoBB '
{CC 
TokenDD 
=DD 

_jwtHelperDD &
.DD& '
GenerateTokenDD' 4
(DD4 5
	loginUserDD5 >
.DD> ?
AccountDD? F
,DDF G
accessTokenDDH S
,DDS T
	loginUserDDU ^
.DD^ _
	AuthorityDD_ h
)DDh i
,DDi j
	AuthorityEE 
=EE 
	loginUserEE  )
.EE) *
	AuthorityEE* 3
,EE3 4
UserAccountFF 
=FF  !
	loginUserFF" +
.FF+ ,
AccountFF, 3
}GG 
;GG 
}HH 
returnII 
nullII 
;II 
}JJ 	
publicLL 
asyncLL 
TaskLL 
<LL 
stringLL  
>LL  !$
RequestGithubAccessTokenLL" :
(LL: ;
stringLL; A
codeLLB F
)LLF G
{MM 	
constNN 
stringNN 
urlNN 
=NN 
$strNN L
;NNL M
stringOO 
clientIdOO 
=OO 
_configurationOO ,
.OO, -
GetValueOO- 5
<OO5 6
stringOO6 <
>OO< =
(OO= >
$strOO> V
)OOV W
;OOW X
stringPP 
clientSecretPP 
=PP  !
_configurationPP" 0
.PP0 1
GetValuePP1 9
<PP9 :
stringPP: @
>PP@ A
(PPA B
$strPPB ^
)PP^ _
;PP_ `
RequestOauthDtoRR 
requestDataRR '
=RR( )
newRR* -
RequestOauthDtoRR. =
{SS 
	Client_idTT 
=TT 
clientIdTT $
,TT$ %
Client_secretUU 
=UU 
clientSecretUU  ,
,UU, -
CodeVV 
=VV 
codeVV 
}WW 
;WW 
varYY 
stringContentYY 
=YY 
newYY  #
StringContentYY$ 1
(YY1 2
JsonSerializerYY2 @
.YY@ A
	SerializeYYA J
(YYJ K
requestDataYYK V
)YYV W
.YYW X
ToLowerYYX _
(YY_ `
)YY` a
,YYa b
EncodingYYc k
.YYk l
UTF8YYl p
,YYp q
$str	YYr Ñ
)
YYÑ Ö
;
YYÖ Ü
varZZ 
responseTaskZZ 
=ZZ 
awaitZZ $
_httpClientZZ% 0
.ZZ0 1
	PostAsyncZZ1 :
(ZZ: ;
urlZZ; >
,ZZ> ?
stringContentZZ@ M
)ZZM N
;ZZN O
string\\ 
resultContent\\  
=\\! "
await\\# (
responseTask\\) 5
.\\5 6
Content\\6 =
.\\= >
ReadAsStringAsync\\> O
(\\O P
)\\P Q
;\\Q R
string^^ 
result^^ 
=^^ 
null^^  
;^^  !
resultContent__ 
.__ 
Split__ 
(__  
$char__  #
)__# $
.__$ %
ToList__% +
(__+ ,
)__, -
.__- .
ForEach__. 5
(__5 6
x__6 7
=>__8 :
{`` 
ifaa 
(aa 
xaa 
.aa 
Containsaa 
(aa 
$straa -
)aa- .
)aa. /
{bb 
resultcc 
=cc 
xcc 
.cc 
Splitcc $
(cc$ %
$charcc% (
)cc( )
.cc) *
ToListcc* 0
(cc0 1
)cc1 2
[cc2 3
$numcc3 4
]cc4 5
;cc5 6
}dd 
}ee 
)ee 
;ee 
returnff 
resultff 
;ff 
}gg 	
publicii 
asyncii 
Taskii 
<ii 
Userii 
>ii !
RequestGithubUserInfoii  5
(ii5 6
stringii6 <
accessTokenii= H
)iiH I
{jj 	
constkk 
stringkk 
urlkk 
=kk 
$strkk <
;kk< =
_httpClientmm 
.mm !
DefaultRequestHeadersmm -
.mm- .
Authorizationmm. ;
=mm< =
newmm> A%
AuthenticationHeaderValuemmB [
(mm[ \
$strmm\ d
,mmd e
accessTokenmmf q
)mmq r
;mmr s
_httpClientnn 
.nn !
DefaultRequestHeadersnn -
.nn- .
Addnn. 1
(nn1 2
$strnn2 >
,nn> ?
$strnn@ I
)nnI J
;nnJ K
varoo 
responseTaskoo 
=oo 
awaitoo $
_httpClientoo% 0
.oo0 1
GetAsyncoo1 9
(oo9 :
urloo: =
)oo= >
;oo> ?
stringqq 
resultContentqq  
=qq! "
awaitqq# (
responseTaskqq) 5
.qq5 6
Contentqq6 =
.qq= >
ReadAsStringAsyncqq> O
(qqO P
)qqP Q
;qqQ R
varrr 
userInforr 
=rr 
JsonSerializerrr )
.rr) *
Deserializerr* 5
<rr5 6
ResponseUserInfoDtorr6 I
>rrI J
(rrJ K
resultContentrrK X
)rrX Y
;rrY Z
Userss 
resultss 
=ss 
newss 
Userss "
{tt 
Accountuu 
=uu 
$struu #
+uu$ %
userInfouu& .
.uu. /
loginuu/ 4
,uu4 5
Namevv 
=vv 
userInfovv 
.vv  
loginvv  %
,vv% &
	AvatarUrlww 
=ww 
userInfoww $
.ww$ %

avatar_urlww% /
,ww/ 0
	Authorityxx 
=xx 
$strxx "
}yy 
;yy 
returnzz 
resultzz 
;zz 
}{{ 	
}|| 
}}} Ù
|C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Services\BaseService.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Services( 0
{ 
public 

class 
BaseService 
{ 
	protected 

PMSContext 

_dbContext '
;' (
	protected		 
IConfiguration		  
_configuration		! /
;		/ 0
public 
BaseService 
( 

PMSContext %
	dbContext& /
)/ 0
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
public 
BaseService 
( 

PMSContext %
	dbContext& /
,/ 0
IConfiguration1 ?
configuration@ M
)M N
{ 	

_dbContext 
= 
	dbContext "
;" #
_configuration 
= 
configuration *
;* +
} 	
} 
} œ5
ÇC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Services\InvitationService.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Services( 0
{		 
public

 

class

 
InvitationService

 "
:

# $
BaseService

% 0
{ 
public 
InvitationService  
(  !

PMSContext! +
	dbContext, 5
)5 6
:7 8
base9 =
(= >
	dbContext> G
)G H
{I J
}K L
public 

Invitation 
CreateInvitation *
(* +
User+ /
inviter0 7
,7 8
User9 =
	applicant> G
,G H
ProjectI P
projectQ X
)X Y
{ 	
var 

invitation 
= 
new  

Invitation! +
{ 
Inviter 
= 
inviter !
,! "
	Applicant 
= 
	applicant %
,% &
InvitedProject 
=  
project! (
,( )
IsAgreed 
= 
false  
} 
; 
return 

invitation 
; 
} 	
public 
List 
< 

Invitation 
> 
GetInvitations  .
(. /
User/ 3
user4 8
)8 9
{ 	
List 
< 

Invitation 
> 
invitations (
=) *

_dbContext+ 5
.5 6
Invitations6 A
.5 6
Include6 =
(= >
i> ?
=>@ B
iC D
.D E
InviterE L
)L M
.5 6
Include6 =
(= >
i> ?
=>@ B
iC D
.D E
InvitedProjectE S
)S T
.  5 6
Where  6 ;
(  ; <
i  < =
=>  > @
i  A B
.  B C
	Applicant  C L
.  L M
Equals  M S
(  S T
user  T X
)  X Y
)  Y Z
.  Z [
ToList  [ a
(  a b
)  b c
;  c d
invitations!! 
.!! 
Reverse!! 
(!!  
)!!  !
;!!! "
return"" 
invitations"" 
;"" 
}## 	
public%% 
void%% 
AddInvitation%% !
(%%! "

Invitation%%" ,

invitation%%- 7
)%%7 8
{&& 	

_dbContext'' 
.'' 
Invitations'' "
.''" #
Add''# &
(''& '

invitation''' 1
)''1 2
;''2 3
if)) 
()) 

_dbContext)) 
.)) 
SaveChanges)) &
())& '
)))' (
==))) +
$num)), -
)))- .
throw** 
new** 
	Exception** #
(**# $
$str**$ =
)**= >
;**> ?
}++ 	
public-- 
bool-- 
IsInvitationExist-- %
(--% &

Invitation--& 0

invitation--1 ;
)--; <
{.. 	
var// 

Invitation// 
=// 

_dbContext// '
.//' (
Invitations//( 3
.//3 4
Where//4 9
(00 
i00 
=>00 
i11 
.11 
Inviter11 
.11 
Equals11 $
(11$ %

invitation11% /
.11/ 0
Inviter110 7
)117 8
&&119 ;
i11< =
.11= >
	Applicant11> G
.11G H
Equals11H N
(11N O

invitation11O Y
.11Y Z
	Applicant11Z c
)11c d
&&11e g
i11h i
.11i j
InvitedProject11j x
.11x y
Equals11y 
(	11 Ä

invitation
11Ä ä
.
11ä ã
InvitedProject
11ã ô
)
11ô ö
)22 
;22 
return33 

Invitation33 
.33 
Any33 !
(33! "
)33" #
;33# $
}44 	
public66 
bool66 
IsUserInProject66 #
(66# $
User66$ (
user66) -
,66- .
Project66/ 6
project667 >
)66> ?
{77 	
var88 
projectList88 
=88 
user88 "
.88" #
Projects88# +
.88+ ,
Where88, 1
(881 2
p882 3
=>884 6
p887 8
.888 9
	ProjectId889 B
==88C E
project88F M
.88M N
ID88N P
)88P Q
.88Q R
ToList88R X
(88X Y
)88Y Z
;88Z [
return99 
projectList99 
.99 
Any99 "
(99" #
)99# $
;99$ %
}:: 	
public<< 
void<< 
DeleteInvitation<< $
(<<$ %

Invitation<<% /

invitation<<0 :
)<<: ;
{== 	

_dbContext>> 
.>> 
Invitations>> "
.>>" #
Remove>># )
(>>) *

invitation>>* 4
)>>4 5
;>>5 6
if@@ 
(@@ 

_dbContext@@ 
.@@ 
SaveChanges@@ &
(@@& '
)@@' (
==@@) +
$num@@, -
)@@- .
throwAA 
newAA 
	ExceptionAA #
(AA# $
$strAA$ =
)AA= >
;AA> ?
}BB 	
publicDD 

InvitationDD 
GetInvitationDD '
(DD' (
intDD( +
idDD, .
)DD. /
{EE 	
varFF 

invitationFF 
=FF 

_dbContextFF '
.FF' (
InvitationsFF( 3
.FF3 4
IncludeFF4 ;
(FF; <
uFF< =
=>FF> @
uFFA B
.FFB C
InvitedProjectFFC Q
)FFQ R
.FFR S
IncludeFFS Z
(FFZ [
uFF[ \
=>FF] _
uFF` a
.FFa b
InviterFFb i
)FFi j
.FFj k
IncludeFFk r
(FFr s
uFFs t
=>FFu w
uFFx y
.FFy z
	Applicant	FFz É
)
FFÉ Ñ
.
FFÑ Ö
Where
FFÖ ä
(
FFä ã
i
FFã å
=>
FFç è
i
FFê ë
.
FFë í
ID
FFí î
.
FFî ï
Equals
FFï õ
(
FFõ ú
id
FFú û
)
FFû ü
)
FFü †
.
FF† °
First
FF° ¶
(
FF¶ ß
)
FFß ®
;
FF® ©
returnGG 

invitationGG 
;GG 
}HH 	
}II 
}JJ å
C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Services\ProjectService.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Services( 0
{ 
public 

class 
ProjectService 
:  !
BaseService" -
{ 
public 
ProjectService 
( 

PMSContext (
	dbContext) 2
)2 3
:4 5
base6 :
(: ;
	dbContext; D
)D E
{F G
}H I
public 
void 
CreateProject !
(! "

ProjectDto" ,

projectDto- 7
,7 8
string9 ?
userId@ F
)F G
{ 	
string 
regexPattern 
=  !
$str" 1
;1 2
Regex 
regex 
= 
new 
Regex #
(# $
regexPattern$ 0
)0 1
;1 2
if 
( 

projectDto 
. 
ProjectName &
==' )
$str* ,
||- /
!0 1
regex1 6
.6 7
IsMatch7 >
(> ?

projectDto? I
.I J
ProjectNameJ U
)U V
)V W
{ 
throw 
new 
	Exception #
(# $
$str$ ?
)? @
;@ A
} 
var 
user 
= 

_dbContext !
.! "
Users" '
.' (
Include( /
(/ 0
u0 1
=>2 4
u5 6
.6 7
Projects7 ?
)? @
.@ A
ThenIncludeA L
(L M
pM N
=>O Q
pR S
.S T
ProjectT [
)[ \
.\ ]
FirstOrDefault] k
(k l
ul m
=>n p
uq r
.r s
Accounts z
.z {
Equals	{ Å
(
Å Ç
userId
Ç à
)
à â
)
â ä
;
ä ã
if 
( 
user 
!= 
null 
) 
{ 
var 
userProject 
=  !
(" #
from# '
up( *
in+ -
user. 2
.2 3
Projects3 ;
where# (
up) +
.+ ,
Project, 3
.3 4
Name4 8
==9 ;

projectDto< F
.F G
ProjectNameG R
select# )
up* ,
., -
Project- 4
.4 5
Name5 9
)9 :
.: ;
ToList; A
(A B
)B C
;C D
if   
(   
userProject   
.    
Count    %
==  & (
$num  ) *
)  * +
{!! 
var"" 

newProject"" "
=""# $
new""% (
Models"") /
.""/ 0
UserProject""0 ;
{## 
Project$$ 
=$$  !
new$$" %
Models$$& ,
.$$, -
Project$$- 4
{$$5 6
Name$$7 ;
=$$< =

projectDto$$> H
.$$H I
ProjectName$$I T
,$$T U
Owner$$V [
=$$\ ]
user$$^ b
}$$c d
,$$d e
}%% 
;%% 
user'' 
.'' 
Projects'' !
.''! "
Add''" %
(''% &

newProject''& 0
)''0 1
;''1 2
}(( 
else)) 
{** 
throw++ 
new++ 
	Exception++ '
(++' (
$str++( @
)++@ A
;++A B
},, 
}-- 
else.. 
{// 
throw00 
new00 
	Exception00 #
(00# $
$str00$ G
)00G H
;00H I
}11 
if44 
(44 

_dbContext44 
.44 
SaveChanges44 &
(44& '
)44' (
==44) +
$num44, -
)44- .
{55 
throw66 
new66 
	Exception66 #
(66# $
$str66$ 9
)669 :
;66: ;
}77 
}88 	
public:: 
void:: 
EditProjectName:: #
(::# $

ProjectDto::$ .

projectDto::/ 9
)::9 :
{;; 	
string<< 
regexPattern<< 
=<<  !
$str<<" 4
;<<4 5
Regex== 
regex== 
=== 
new== 
Regex== #
(==# $
regexPattern==$ 0
)==0 1
;==1 2
if>> 
(>> 

projectDto>> 
.>> 
ProjectName>> &
==>>' )
$str>>* ,
||>>- /
!>>0 1
regex>>1 6
.>>6 7
IsMatch>>7 >
(>>> ?

projectDto>>? I
.>>I J
ProjectName>>J U
)>>U V
)>>V W
{?? 
throw@@ 
new@@ 
	Exception@@ #
(@@# $
$str@@$ ?
)@@? @
;@@@ A
}AA 
elseBB 
ifBB 
(BB 

_dbContextBB 
.BB  
ProjectsBB  (
.BB( )
WhereBB) .
(BB. /
pBB/ 0
=>BB1 3
pBB4 5
.BB5 6
NameBB6 :
==BB; =

projectDtoBB> H
.BBH I
ProjectNameBBI T
)BBT U
.BBU V
ToListBBV \
(BB\ ]
)BB] ^
.BB^ _
CountBB_ d
!=BBe g
$numBBh i
)BBi j
{CC 
throwDD 
newDD 
	ExceptionDD #
(DD# $
$strDD$ <
)DD< =
;DD= >
}EE 
varGG 
projectGG 
=GG 

_dbContextGG $
.GG$ %
ProjectsGG% -
.GG- .
FindGG. 2
(GG2 3

projectDtoGG3 =
.GG= >
	ProjectIdGG> G
)GGG H
;GGH I
projectII 
.II 
NameII 
=II 

projectDtoII %
.II% &
ProjectNameII& 1
;II1 2

_dbContextKK 
.KK 
UpdateKK 
(KK 
projectKK %
)KK% &
;KK& '
ifMM 
(MM 

_dbContextMM 
.MM 
SaveChangesMM &
(MM& '
)MM' (
==MM) +
$numMM, -
)MM- .
{NN 
throwOO 
newOO 
	ExceptionOO #
(OO# $
$strOO$ <
)OO< =
;OO= >
}PP 
}QQ 	
publicSS 
ListSS 
<SS 
ProjectResultDtoSS $
>SS$ %#
GetProjectByUserAccountSS& =
(SS= >
stringSS> D
accountSSE L
)SSL M
{TT 	
varUU 
userUU 
=UU 

_dbContextUU !
.UU! "
UsersUU" '
.UU' (
IncludeUU( /
(UU/ 0
uUU0 1
=>UU2 4
uUU5 6
.UU6 7
ProjectsUU7 ?
)UU? @
.UU@ A
ThenIncludeUUA L
(UUL M
pUUM N
=>UUO Q
pUUR S
.UUS T
ProjectUUT [
)UU[ \
.UU\ ]
ThenIncludeUU] h
(UUh i
pUUi j
=>UUk m
pUUn o
.UUo p
OwnerUUp u
)UUu v
.UUv w
FirstOrDefault	UUw Ö
(
UUÖ Ü
u
UUÜ á
=>
UUà ä
u
UUã å
.
UUå ç
Account
UUç î
.
UUî ï
Equals
UUï õ
(
UUõ ú
account
UUú £
)
UU£ §
)
UU§ •
;
UU• ¶
varVV 
queryVV 
=VV 
(VV 
fromVV 
upVV  
inVV! #
userVV$ (
.VV( )
ProjectsVV) 1
selectWW 
newWW  #
ProjectResultDtoWW$ 4
{WW5 6
IdWW7 9
=WW: ;
upWW< >
.WW> ?
ProjectWW? F
.WWF G
IDWWG I
,WWI J
NameWWK O
=WWP Q
upWWR T
.WWT U
ProjectWWU \
.WW\ ]
NameWW] a
,WWa b
OwnerIdWWc j
=WWk l
upWWm o
.WWo p
ProjectWWp w
.WWw x
OwnerWWx }
.WW} ~
Account	WW~ Ö
,
WWÖ Ü
	OwnerName
WWá ê
=
WWë í
up
WWì ï
.
WWï ñ
Project
WWñ ù
.
WWù û
Owner
WWû £
.
WW£ §
Name
WW§ ®
}
WW© ™
)
WW™ ´
.
WW´ ¨
ToList
WW¨ ≤
(
WW≤ ≥
)
WW≥ ¥
;
WW¥ µ
returnXX 
queryXX 
;XX 
}YY 	
public[[ 
ProjectResultDto[[ !
GetProjectByProjectId[[  5
([[5 6
int[[6 9
	projectId[[: C
,[[C D
string[[E K
account[[L S
)[[S T
{\\ 	
List]] 
<]] 
ProjectResultDto]] !
>]]! "
userProject]]# .
=]]/ 0#
GetProjectByUserAccount]]1 H
(]]H I
account]]I P
)]]P Q
;]]Q R
foreach__ 
(__ 
ProjectResultDto__ %
projectResultDto__& 6
in__7 9
userProject__: E
)__E F
{`` 
ifaa 
(aa 
projectResultDtoaa $
.aa$ %
Idaa% '
==aa( *
	projectIdaa+ 4
)aa4 5
{bb 
returncc 
projectResultDtocc +
;cc+ ,
}dd 
}ee 
throwff 
newff 
	Exceptionff 
(ff  
$strff  /
)ff/ 0
;ff0 1
}gg 	
publicii 
Listii 
<ii 
UserInfoDtoii 
>ii  
GetProjectMemberii! 1
(ii1 2
intii2 5
	projectIdii6 ?
)ii? @
{jj 	
varkk 
projectByIdkk 
=kk 

_dbContextkk (
.kk( )
Projectskk) 1
.kk1 2
Includekk2 9
(kk9 :
pkk: ;
=>kk< >
pkk? @
.kk@ A
UserskkA F
)kkF G
.kkG H
ThenIncludekkH S
(kkS T
ukkT U
=>kkV X
ukkY Z
.kkZ [
Userkk[ _
)kk_ `
.kk` a
FirstOrDefaultkka o
(kko p
pkkp q
=>kkr t
pkku v
.kkv w
IDkkw y
==kkz |
	projectId	kk} Ü
)
kkÜ á
;
kká à
ifmm 
(mm 
projectByIdmm 
!=mm 
nullmm #
)mm# $
{nn 
varoo 
projectMemberoo !
=oo" #
projectByIdoo$ /
.oo/ 0
Usersoo0 5
;oo5 6
Listqq 
<qq 
UserInfoDtoqq  
>qq  !
resultqq" (
=qq) *
newqq+ .
Listqq/ 3
<qq3 4
UserInfoDtoqq4 ?
>qq? @
(qq@ A
)qqA B
;qqB C
foreachss 
(ss 
UserProjectss $
userProjectss% 0
inss1 3
projectMemberss4 A
)ssA B
{tt 
resultuu 
.uu 
Adduu 
(uu 
newuu "
UserInfoDtouu# .
{uu/ 0
iduu1 3
=uu4 5
userProjectuu6 A
.uuA B
UseruuB F
.uuF G
AccountuuG N
,uuN O
nameuuP T
=uuU V
userProjectuuW b
.uub c
Useruuc g
.uug h
Nameuuh l
}uum n
)uun o
;uuo p
}vv 
returnxx 
resultxx 
;xx 
}yy 
elsezz 
{{{ 
throw|| 
new|| 
	Exception|| #
(||# $
$str||$ :
)||: ;
;||; <
}}} 
} 	
public
ÅÅ 
List
ÅÅ 
<
ÅÅ 
ProjectResultDto
ÅÅ $
>
ÅÅ$ %
GetAllProject
ÅÅ& 3
(
ÅÅ3 4
)
ÅÅ4 5
{
ÇÇ 	
return
ÉÉ 

_dbContext
ÉÉ 
.
ÉÉ 
Projects
ÉÉ &
.
ÉÉ& '
Select
ÉÉ' -
(
ÉÉ- .
p
ÉÉ. /
=>
ÉÉ0 2
new
ÉÉ3 6
ProjectResultDto
ÉÉ7 G
{
ÉÉH I
Id
ÉÉJ L
=
ÉÉM N
p
ÉÉO P
.
ÉÉP Q
ID
ÉÉQ S
,
ÉÉS T
Name
ÉÉU Y
=
ÉÉZ [
p
ÉÉ\ ]
.
ÉÉ] ^
Name
ÉÉ^ b
,
ÉÉb c
OwnerId
ÉÉd k
=
ÉÉl m
p
ÉÉn o
.
ÉÉo p
Owner
ÉÉp u
.
ÉÉu v
Account
ÉÉv }
,
ÉÉ} ~
	OwnerNameÉÉ à
=ÉÉâ ä
pÉÉã å
.ÉÉå ç
OwnerÉÉç í
.ÉÉí ì
NameÉÉì ó
,ÉÉó ò
MembersÉÉô †
=ÉÉ° ¢
pÉÉ£ §
.ÉÉ§ •
UsersÉÉ• ™
.ÉÉ™ ´
CountÉÉ´ ∞
}ÉÉ± ≤
)ÉÉ≤ ≥
.ÉÉ≥ ¥
ToListÉÉ¥ ∫
(ÉÉ∫ ª
)ÉÉª º
;ÉÉº Ω
}
ÑÑ 	
public
ÜÜ 
void
ÜÜ 
DeleteProject
ÜÜ !
(
ÜÜ! "
int
ÜÜ" %
	projectId
ÜÜ& /
)
ÜÜ/ 0
{
áá 	
var
àà 
invitations
àà 
=
àà 

_dbContext
àà (
.
àà( )
Invitations
àà) 4
.
àà4 5
Where
àà5 :
(
àà: ;
i
àà; <
=>
àà= ?
i
àà@ A
.
ààA B
InvitedProject
ààB P
.
ààP Q
ID
ààQ S
.
ààS T
Equals
ààT Z
(
ààZ [
	projectId
àà[ d
)
ààd e
)
ààe f
;
ààf g

_dbContext
ââ 
.
ââ 
Invitations
ââ "
.
ââ" #
RemoveRange
ââ# .
(
ââ. /
invitations
ââ/ :
)
ââ: ;
;
ââ; <
var
ää 
repos
ää 
=
ää 

_dbContext
ää "
.
ää" #
Repositories
ää# /
.
ää/ 0
Where
ää0 5
(
ää5 6
r
ää6 7
=>
ää8 :
r
ää; <
.
ää< =
Project
ää= D
.
ääD E
ID
ääE G
.
ääG H
Equals
ääH N
(
ääN O
	projectId
ääO X
)
ääX Y
)
ääY Z
;
ääZ [

_dbContext
ãã 
.
ãã 
Repositories
ãã #
.
ãã# $
RemoveRange
ãã$ /
(
ãã/ 0
repos
ãã0 5
)
ãã5 6
;
ãã6 7
var
åå 
project
åå 
=
åå 

_dbContext
åå $
.
åå$ %
Projects
åå% -
.
åå- .
Find
åå. 2
(
åå2 3
	projectId
åå3 <
)
åå< =
;
åå= >

_dbContext
çç 
.
çç 
Projects
çç 
.
çç  
Remove
çç  &
(
çç& '
project
çç' .
)
çç. /
;
çç/ 0
if
èè 
(
èè 

_dbContext
èè 
.
èè 
SaveChanges
èè &
(
èè& '
)
èè' (
==
èè) +
$num
èè, -
)
èè- .
throw
êê 
new
êê 
	Exception
êê #
(
êê# $
$str
êê$ :
)
êê: ;
;
êê; <
}
ëë 	
public
ìì 
void
ìì !
DeleteProjectMember
ìì '
(
ìì' (
string
ìì( .
userId
ìì/ 5
,
ìì5 6
int
ìì7 :
	projectId
ìì; D
)
ììD E
{
îî 	
var
ïï 
user
ïï 
=
ïï 

_dbContext
ïï !
.
ïï! "
Users
ïï" '
.
ïï' (
Find
ïï( ,
(
ïï, -
userId
ïï- 3
)
ïï3 4
;
ïï4 5
var
ññ 
project
ññ 
=
ññ 
user
ññ 
.
ññ 
Projects
ññ '
.
ññ' (
Where
ññ( -
(
ññ- .
p
ññ. /
=>
ññ0 2
p
ññ3 4
.
ññ4 5
	ProjectId
ññ5 >
.
ññ> ?
Equals
ññ? E
(
ññE F
	projectId
ññF O
)
ññO P
)
ññP Q
.
ññQ R
FirstOrDefault
ññR `
(
ññ` a
)
ñña b
;
ññb c
user
óó 
.
óó 
Projects
óó 
.
óó 
Remove
óó  
(
óó  !
project
óó! (
)
óó( )
;
óó) *
if
ôô 
(
ôô 

_dbContext
ôô 
.
ôô 
SaveChanges
ôô &
(
ôô& '
)
ôô' (
==
ôô) +
$num
ôô, -
)
ôô- .
throw
öö 
new
öö 
	Exception
öö #
(
öö# $
$str
öö$ A
)
ööA B
;
ööB C
}
õõ 	
public
ùù 
bool
ùù $
EditProjectNameByAdmin
ùù *
(
ùù* +
int
ùù+ .
	projectId
ùù/ 8
,
ùù8 9
JsonPatchDocument
ùù: K
<
ùùK L
Project
ùùL S
>
ùùS T

newProject
ùùU _
)
ùù_ `
{
ûû 	
var
üü 
project
üü 
=
üü 

_dbContext
üü $
.
üü$ %
Projects
üü% -
.
üü- .
Find
üü. 2
(
üü2 3
	projectId
üü3 <
)
üü< =
;
üü= >

newProject
†† 
.
†† 
ApplyTo
†† 
(
†† 
project
†† &
)
††& '
;
††' (
return
°° 
!
°° 
(
°° 

_dbContext
°° 
.
°°  
SaveChanges
°°  +
(
°°+ ,
)
°°, -
==
°°. 0
$num
°°1 2
)
°°2 3
;
°°3 4
}
¢¢ 	
}
££ 
}§§ ◊+
ÄC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Services\RepoInfoService.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Services( 0
{ 
public 

class 
RepoInfoService  
:! "
BaseService# .
{ 
private 
readonly 

HttpClient #
_httpClient$ /
;/ 0
private 
readonly 
RepoInfoFactory (
_repoInfoFactory) 9
;9 :
public 
RepoInfoService 
( 

PMSContext )
	dbContext* 3
,3 4

HttpClient5 ?
client@ F
=G H
nullI M
)M N
:O P
baseQ U
(U V
	dbContextV _
)_ `
{ 	
_httpClient 
= 
client  
??! #
new$ '

HttpClient( 2
(2 3
)3 4
;4 5
_repoInfoFactory 
= 
new "
RepoInfoFactory# 2
(2 3
)3 4
;4 5
} 	
public 
async 
Task 
<  
RequestCommitInfoDto .
>. /
RequestCommit0 =
(= >
int> A
repoIdB H
,H I
stringJ P

oauthTokenQ [
)[ \
{ 	
Repo 
repo 
= 
	GetRepoBy !
(! "
repoId" (
)( )
;) *
	IRepoInfo 
repoInfo 
=  
_repoInfoFactory! 1
.1 2
CreateRepoInfo2 @
(@ A
repoA E
,E F
_httpClientG R
,R S

oauthTokenT ^
)^ _
;_ `
return 
await 
repoInfo !
.! "
RequestCommit" /
(/ 0
repo0 4
)4 5
;5 6
} 	
public 
async 
Task 
< 
List 
< 
ResponseCodebaseDto 2
>2 3
>3 4
RequestCodebase5 D
(D E
intE H
repoIdI O
,O P
stringQ W

oauthTokenX b
)b c
{ 	
Repo   
repo   
=   
	GetRepoBy   !
(  ! "
repoId  " (
)  ( )
;  ) *
	IRepoInfo!! 
repoInfo!! 
=!!  
_repoInfoFactory!!! 1
.!!1 2
CreateRepoInfo!!2 @
(!!@ A
repo!!A E
,!!E F
_httpClient!!G R
,!!R S

oauthToken!!T ^
)!!^ _
;!!_ `
return"" 
await"" 
repoInfo"" !
.""! "
RequestCodebase""" 1
(""1 2
repo""2 6
)""6 7
;""7 8
}## 	
public%% 
async%% 
Task%% 
<%% 
RepoIssuesDto%% '
>%%' (
RequestIssue%%) 5
(%%5 6
int%%6 9
repoId%%: @
,%%@ A
string%%B H

oauthToken%%I S
)%%S T
{&& 	
Repo'' 
repo'' 
='' 
	GetRepoBy'' !
(''! "
repoId''" (
)''( )
;'') *
	IRepoInfo(( 
repoInfo(( 
=((  
_repoInfoFactory((! 1
.((1 2
CreateRepoInfo((2 @
(((@ A
repo((A E
,((E F
_httpClient((G R
,((R S

oauthToken((T ^
)((^ _
;((_ `
return)) 
await)) 
repoInfo)) !
.))! "
RequestIssue))" .
()). /
repo))/ 3
)))3 4
;))4 5
}** 	
public,, 
async,, 
Task,, 
<,, 
List,, 
<,, )
ContributorsCommitActivityDto,, <
>,,< =
>,,= >'
RequestContributorsActivity,,? Z
(,,Z [
int,,[ ^
repoId,,_ e
,,,e f
string,,g m

oauthToken,,n x
),,x y
{-- 	
Repo.. 
repo.. 
=.. 
	GetRepoBy.. !
(..! "
repoId.." (
)..( )
;..) *
	IRepoInfo// 
repoInfo// 
=//  
_repoInfoFactory//! 1
.//1 2
CreateRepoInfo//2 @
(//@ A
repo//A E
,//E F
_httpClient//G R
,//R S

oauthToken//T ^
)//^ _
;//_ `
return00 
await00 
repoInfo00 !
.00! "'
RequestContributorsActivity00" =
(00= >
repo00> B
)00B C
;00C D
}11 	
private33 
Repo33 
	GetRepoBy33 
(33 
int33 "
repoId33# )
)33) *
{44 	
Repo55 
repo55 
=55 

_dbContext55 "
.55" #
Repositories55# /
.55/ 0
Find550 4
(554 5
repoId555 ;
)55; <
;55< =
if66 
(66 
null66 
==66 
repo66 
)66 
{77 
throw88 
new88 
	Exception88 #
(88# $
$str88$ /
)88/ 0
;880 1
}99 
return:: 
repo:: 
;:: 
};; 	
}<< 
}== ¥m
|C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Services\RepoService.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Services( 0
{ 
public 

class 
RepoService 
: 
BaseService *
{ 
private 
readonly 

HttpClient #
_httpClient$ /
;/ 0
private 
readonly 
RepoFactory $
_repoFactory% 1
;1 2
public 
RepoService 
( 

PMSContext %
	dbContext& /
,/ 0

HttpClient1 ;
client< B
=C D
nullE I
)I J
:K L
baseM Q
(Q R
	dbContextR [
)[ \
{ 	
_httpClient 
= 
client  
??! #
new$ '

HttpClient( 2
(2 3
)3 4
;4 5
_httpClient 
. 
Timeout 
=  !
TimeSpan" *
.* +
FromSeconds+ 6
(6 7
$num7 8
)8 9
;9 :
_httpClient 
. !
DefaultRequestHeaders -
.- .
Add. 1
(1 2
$str2 >
,> ?
$str@ I
)I J
;J K
_repoFactory 
= 
new 
RepoFactory *
(* +
)+ ,
;, -
} 	
private 
async 
Task 
< 
ResponseRepoInfoDto .
>. /$
GetRepositoryInformation0 H
(H I
stringI O
urlP S
)S T
{ 	
IRepo 
repo 
= 
_repoFactory %
.% &
CreateRepoBy& 2
(2 3
url3 6
,6 7
_httpClient8 C
,C D
nullE I
)I J
;J K
return 
await 
repo 
. $
GetRepositoryInformation 6
(6 7
url7 :
): ;
;; <
} 	
private!! 
async!! 
Task!! 
<!! 
ResponseDto!! &
>!!& '0
$CheckSonarqubeAliveAndProjectExisted!!( L
(!!L M

AddRepoDto!!M W

addRepoDto!!X b
)!!b c
{"" 	
ResponseDto## 
responseDto## #
=##$ %
new##& )
ResponseDto##* 5
(##5 6
)##6 7
{##8 9
success##: A
=##B C
false##D I
,##I J
message##K R
=##S T
$str##U g
}##h i
;##i j
try$$ 
{%% 
var&& 
sonarqubeUrl&&  
=&&! "

addRepoDto&&# -
.&&- .
sonarqubeUrl&&. :
+&&; <
$"&&= ?
$str&&? c
{&&c d

addRepoDto&&d n
.&&n o

projectKey&&o y
}&&y z
"&&z {
;&&{ |
_httpClient'' 
.'' !
DefaultRequestHeaders'' 1
.''1 2
Add''2 5
(''5 6
$str''6 E
,''E F
$"''G I
$str''I O
{''O P

addRepoDto''P Z
.''Z [ 
accountColonPassword''[ o
}''o p
"''p q
)''q r
;''r s
var(( 
result(( 
=(( 
await(( "
_httpClient((# .
.((. /
GetAsync((/ 7
(((7 8
sonarqubeUrl((8 D
)((D E
;((E F
responseDto)) 
.)) 
success)) #
=))$ %
result))& ,
.)), -
IsSuccessStatusCode))- @
;))@ A
responseDto** 
.** 
message** #
=**$ %
result**& ,
.**, -
IsSuccessStatusCode**- @
?**A B
$str**C U
:**V W
$str**X y
;**y z
return++ 
responseDto++ "
;++" #
},, 
catch-- 
(-- 
	Exception-- 
ex-- 
)--  
{.. 
responseDto// 
.// 
message// #
.//# $
Insert//$ *
(//* +
$num//+ ,
,//, -
ex//. 0
.//0 1
Message//1 8
)//8 9
;//9 :
return00 
responseDto00 "
;00" #
}11 
}22 	
public44 
async44 
Task44 
<44 
ResponseDto44 %
>44% &
AddRepo44' .
(44. /

AddRepoDto44/ 9

addRepoDto44: D
)44D E
{55 	
try66 
{77 
var88 
githubResponse88 "
=88# $
await88% *$
GetRepositoryInformation88+ C
(88C D

addRepoDto88D N
.88N O
url88O R
)88R S
;88S T
var99 
sonarqubeResponse99 %
=99& '
await99( -0
$CheckSonarqubeAliveAndProjectExisted99. R
(99R S

addRepoDto99S ]
)99] ^
;99^ _
ResponseDto:: 
result:: "
=::# $
new::% (
ResponseDto::) 4
(::4 5
)::5 6
{::7 8
success::9 @
=::A B
githubResponse::C Q
.::Q R
success::R Y
,::Y Z
message::[ b
=::c d
githubResponse::e s
.::s t
message::t {
}::| }
;::} ~
if;; 
(;; 
githubResponse;; "
.;;" #
success;;# *
);;* +
{<< 
if== 
(== 
(== 
!== 

addRepoDto== $
.==$ %
isSonarqube==% 0
)==0 1
||==2 4
sonarqubeResponse==5 F
.==F G
success==G N
)==N O
{>> 
Repo?? 
model?? "
=??# $
MakeRepoModel??% 2
(??2 3
githubResponse??3 A
,??A B

addRepoDto??C M
)??M N
;??N O

CreateRepo@@ "
(@@" #
model@@# (
)@@( )
;@@) *
resultAA 
.AA 
messageAA &
=AA' (
$strAA) 6
;AA6 7
returnBB 
resultBB %
;BB% &
}CC 
elseDD 
{EE 
resultFF 
.FF 
successFF &
=FF' (
sonarqubeResponseFF) :
.FF: ;
successFF; B
;FFB C
resultGG 
.GG 
messageGG &
=GG' (
sonarqubeResponseGG) :
.GG: ;
messageGG; B
;GGB C
}HH 
}II 
returnJJ 
resultJJ 
;JJ 
}KK 
catchLL 
(LL 
	ExceptionLL 
exLL 
)LL  
{MM 
returnNN 
newNN 
ResponseDtoNN &
(NN& '
)NN' (
{NN) *
messageNN+ 2
=NN3 4
exNN5 7
.NN7 8
MessageNN8 ?
,NN? @
successNNA H
=NNI J
falseNNK P
}NNQ R
;NNR S
}OO 
}PP 	
privateRR 
RepoRR 
MakeRepoModelRR "
(RR" #
ResponseRepoInfoDtoRR# 6
githubResponseRR7 E
,RRE F

AddRepoDtoRRG Q

addRepoDtoRRR \
)RR\ ]
{SS 	
varTT 
projectTT 
=TT !
GetProjectByProjectIdTT /
(TT/ 0

addRepoDtoTT0 :
.TT: ;
	projectIdTT; D
)TTD E
;TTE F
stringUU 
ownerUU 
=UU 
stringUU !
.UU! "
EmptyUU" '
;UU' (
ifVV 
(VV 
githubResponseVV 
.VV 
ownerVV $
!=VV% '
nullVV( ,
)VV, -
{WW 
ownerXX 
=XX 
githubResponseXX &
.XX& '
ownerXX' ,
.XX, -
loginXX- 2
??XX3 5
githubResponseXX6 D
.XXD E
ownerXXE J
.XXJ K
nameXXK O
;XXO P
}YY 
returnZZ 
newZZ 
RepoZZ 
(ZZ 
)ZZ 
{[[ 
Name\\ 
=\\ 
githubResponse\\ %
.\\% &
name\\& *
,\\* +
Owner]] 
=]] 
owner]] 
,]] 
Url^^ 
=^^ 
githubResponse^^ $
.^^$ %
html_url^^% -
??^^. 0
githubResponse^^1 ?
.^^? @
web_url^^@ G
,^^G H
Project__ 
=__ 
project__ !
,__! "
RepoId`` 
=`` 
githubResponse`` '
.``' (
id``( *
.``* +
ToString``+ 3
(``3 4
)``4 5
,``5 6
IsSonarqubeaa 
=aa 

addRepoDtoaa (
.aa( )
isSonarqubeaa) 4
,aa4 5
SonarqubeUrlbb 
=bb 

addRepoDtobb )
.bb) *
sonarqubeUrlbb* 6
,bb6 7
AccountColonPwcc 
=cc  

addRepoDtocc! +
.cc+ , 
accountColonPasswordcc, @
,cc@ A

ProjectKeydd 
=dd 

addRepoDtodd '
.dd' (

projectKeydd( 2
}ee 
;ee 
}ff 	
privatehh 
voidhh 

CreateRepohh 
(hh  
Repohh  $
modelhh% *
)hh* +
{ii 	
varkk 
repokk 
=kk 
modelkk 
.kk 
Projectkk $
.kk$ %
Repositorieskk% 1
.kk1 2
Wherekk2 7
(kk7 8
rkk8 9
=>kk: <
rkk= >
.kk> ?
Urlkk? B
==kkC E
modelkkF K
.kkK L
UrlkkL O
)kkO P
;kkP Q
ifmm 
(mm 
!mm 
repomm 
.mm 
Anymm 
(mm 
)mm 
)mm 

_dbContextnn 
.nn 
Addnn 
(nn 
modelnn $
)nn$ %
;nn% &
elseoo 
throwpp 
newpp 
	Exceptionpp #
(pp# $
$strpp$ 5
)pp5 6
;pp6 7
ifrr 
(rr 

_dbContextrr 
.rr 
SaveChangesrr &
(rr& '
)rr' (
==rr) +
$numrr, -
)rr- .
throwss 
newss 
	Exceptionss #
(ss# $
$strss$ 4
)ss4 5
;ss5 6
}tt 	
publicvv 
Listvv 
<vv 
Repovv 
>vv $
GetRepositoryByProjectIdvv 2
(vv2 3
intvv3 6
idvv7 9
)vv9 :
{ww 	
varxx 
projectxx 
=xx 

_dbContextxx $
.xx$ %
Projectsxx% -
.xx- .
Wherexx. 3
(xx3 4
pxx4 5
=>xx6 8
pxx9 :
.xx: ;
IDxx; =
.xx= >
Equalsxx> D
(xxD E
idxxE G
)xxG H
)xxH I
.xxI J
IncludexxJ Q
(xxQ R
pxxR S
=>xxT V
pxxW X
.xxX Y
RepositoriesxxY e
)xxe f
.xxf g
Firstxxg l
(xxl m
)xxm n
;xxn o
returnyy 
projectyy 
.yy 
Repositoriesyy '
;yy' (
}zz 	
public|| 
Project|| !
GetProjectByProjectId|| ,
(||, -
int||- 0
id||1 3
)||3 4
{}} 	
var~~ 
project~~ 
=~~ 

_dbContext~~ $
.~~$ %
Projects~~% -
.~~- .
Include~~. 5
(~~5 6
r~~6 7
=>~~8 :
r~~; <
.~~< =
Repositories~~= I
)~~I J
.~~J K
Where~~K P
(~~P Q
p~~Q R
=>~~S U
p~~V W
.~~W X
ID~~X Z
==~~[ ]
id~~^ `
)~~` a
.~~a b
First~~b g
(~~g h
)~~h i
;~~i j
return 
project 
; 
}
ÄÄ 	
public
ÇÇ 
bool
ÇÇ 

DeleteRepo
ÇÇ 
(
ÇÇ 
int
ÇÇ "
	projectId
ÇÇ# ,
,
ÇÇ, -
int
ÇÇ. 1
repoId
ÇÇ2 8
)
ÇÇ8 9
{
ÉÉ 	
try
ÑÑ 
{
ÖÖ 
var
ÜÜ 
repo
ÜÜ 
=
ÜÜ 

_dbContext
ÜÜ %
.
ÜÜ% &
Repositories
ÜÜ& 2
.
ÜÜ2 3
Include
ÜÜ3 :
(
ÜÜ: ;
p
ÜÜ; <
=>
ÜÜ= ?
p
ÜÜ@ A
.
ÜÜA B
Project
ÜÜB I
)
ÜÜI J
.
ÜÜJ K
First
ÜÜK P
(
ÜÜP Q
r
ÜÜQ R
=>
ÜÜS U
r
ÜÜV W
.
ÜÜW X
ID
ÜÜX Z
==
ÜÜ[ ]
repoId
ÜÜ^ d
&&
ÜÜe g
r
ÜÜh i
.
ÜÜi j
Project
ÜÜj q
.
ÜÜq r
ID
ÜÜr t
==
ÜÜu w
	projectIdÜÜx Å
)ÜÜÅ Ç
;ÜÜÇ É

_dbContext
áá 
.
áá 
Repositories
áá '
.
áá' (
Remove
áá( .
(
áá. /
repo
áá/ 3
)
áá3 4
;
áá4 5
return
àà 
!
àà 
(
àà 

_dbContext
àà #
.
àà# $
SaveChanges
àà$ /
(
àà/ 0
)
àà0 1
==
àà2 4
$num
àà5 6
)
àà6 7
;
àà7 8
}
ââ 
catch
ää 
(
ää 
	Exception
ää 
)
ää 
{
ãã 
return
åå 
false
åå 
;
åå 
}
çç 
}
éé 	
}
èè 
}êê ˆß
ÅC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Services\SonarqubeService.cs
	namespace

 	)
project_manage_system_backend


 '
.

' (
Services

( 0
{ 
public 

class 
SonarqubeService !
:" #
BaseService$ /
{ 
private 
readonly 

HttpClient #
_httpClient$ /
;/ 0
private 
const 
int 
	PAGE_SIZE #
=$ %
$num& )
;) *
public 
SonarqubeService 
(  

PMSContext  *
	dbContext+ 4
,4 5

HttpClient6 @
clientA G
=H I
nullJ N
)N O
:P Q
baseR V
(V W
	dbContextW `
)` a
{ 	
_httpClient 
= 
client  
??! #
new$ '

HttpClient( 2
(2 3
)3 4
;4 5
} 	
public 
async 
Task 
< 
SonarqubeInfoDto *
>* +!
GetSonarqubeInfoAsync, A
(A B
intB E
repoIdF L
)L M
{ 	
Repo 
repo 
= 

_dbContext "
." #
Repositories# /
./ 0
Find0 4
(4 5
repoId5 ;
); <
;< =
string 
sonarqubeHostUrl #
=$ %
repo& *
.* +
SonarqubeUrl+ 7
;7 8
string 
apiUrl 
= 
$str 2
;2 3
string 

projectKey 
= 
repo  $
.$ %

ProjectKey% /
;/ 0
string 
query 
= 
$str k
;k l
_httpClient 
. !
DefaultRequestHeaders -
.- .
Add. 1
(1 2
$str2 >
,> ?
$str@ I
)I J
;J K
_httpClient 
. !
DefaultRequestHeaders -
.- .
Add. 1
(1 2
$str2 A
,A B
$"C E
$strE K
{K L
repoL P
.P Q
AccountColonPwQ _
}_ `
"` a
)a b
;b c
var 
response 
= 
await  
_httpClient! ,
., -
GetAsync- 5
(5 6
$"6 8
{8 9
sonarqubeHostUrl9 I
}I J
{J K
apiUrlK Q
}Q R
$strR ^
{^ _

projectKey_ i
}i j
{j k
queryk p
}p q
"q r
)r s
;s t
string   
content   
=   
await   "
response  # +
.  + ,
Content  , 3
.  3 4
ReadAsStringAsync  4 E
(  E F
)  F G
;  G H
var!! 
result!! 
=!! 
JsonSerializer!! '
.!!' (
Deserialize!!( 3
<!!3 4
SonarqubeInfoDto!!4 D
>!!D E
(!!E F
content!!F M
)!!M N
;!!N O
result"" 
."" 
projectName"" 
=""  

projectKey""! +
;""+ ,
return## 
result## 
;## 
}$$ 	
public&& 
async&& 
Task&& 
<&& 

Dictionary&& $
<&&$ %
string&&% +
,&&+ ,
List&&- 1
<&&1 2
Issues&&2 8
>&&8 9
>&&9 :
>&&: ;&
GetSonarqubeCodeSmellAsync&&< V
(&&V W
int&&W Z
repoId&&[ a
)&&a b
{'' 	
Repo(( 
repo(( 
=(( 

_dbContext(( "
.((" #
Repositories((# /
.((/ 0
Find((0 4
(((4 5
repoId((5 ;
)((; <
;((< =
_httpClient)) 
.)) !
DefaultRequestHeaders)) -
.))- .
Add)). 1
())1 2
$str))2 >
,))> ?
$str))@ I
)))I J
;))J K
_httpClient** 
.** !
DefaultRequestHeaders** -
.**- .
Add**. 1
(**1 2
$str**2 A
,**A B
$"**C E
$str**E K
{**K L
repo**L P
.**P Q
AccountColonPw**Q _
}**_ `
"**` a
)**a b
;**b c
var++ 
result++ 
=++ 
await++  
RequestCodeSmellData++ 3
(++3 4
repoId++4 :
)++: ;
;++; <
int,, 

totalPages,, 
=,, 
(,, 
result,, $
.,,$ %
total,,% *
-,,+ ,
$num,,- .
),,. /
/,,0 1
	PAGE_SIZE,,2 ;
+,,< =
$num,,> ?
;,,? @
for.. 
(.. 
int.. 
i.. 
=.. 
$num.. 
;.. 
i.. 
<=..  

totalPages..! +
;..+ ,
i..- .
++... 0
)..0 1
{// 
var00 
others00 
=00 
await00 " 
RequestCodeSmellData00# 7
(007 8
repoId008 >
,00> ?
i00@ A
)00A B
;00B C
result11 
.11 
issues11 
.11 
AddRange11 &
(11& '
others11' -
.11- .
issues11. 4
)114 5
;115 6
}22 
return44 

MapIssueBy44 
(44 
result44 $
.44$ %
issues44% +
)44+ ,
;44, -
}55 	
public77 
async77 
Task77 
<77 

Dictionary77 $
<77$ %
string77% +
,77+ ,
List77- 1
<771 2
Issues772 8
>778 9
>779 :
>77: ; 
GetSonarqubeBugAsync77< P
(77P Q
int77Q T
repoId77U [
)77[ \
{88 	
Repo99 
repo99 
=99 

_dbContext99 "
.99" #
Repositories99# /
.99/ 0
Find990 4
(994 5
repoId995 ;
)99; <
;99< =
_httpClient:: 
.:: !
DefaultRequestHeaders:: -
.::- .
Add::. 1
(::1 2
$str::2 >
,::> ?
$str::@ I
)::I J
;::J K
_httpClient;; 
.;; !
DefaultRequestHeaders;; -
.;;- .
Add;;. 1
(;;1 2
$str;;2 A
,;;A B
$";;C E
$str;;E K
{;;K L
repo;;L P
.;;P Q
AccountColonPw;;Q _
};;_ `
";;` a
);;a b
;;;b c
var<< 
result<< 
=<< 
await<< 
RequestBugData<< -
(<<- .
repoId<<. 4
)<<4 5
;<<5 6
int== 

totalPages== 
=== 
(== 
result== $
.==$ %
total==% *
-==+ ,
$num==- .
)==. /
/==0 1
	PAGE_SIZE==2 ;
+==< =
$num==> ?
;==? @
Console>> 
.>> 
Write>> 
(>> 
result>>  
.>>  !
total>>! &
)>>& '
;>>' (
Console?? 
.?? 
Write?? 
(?? 
result??  
.??  !
issues??! '
)??' (
;??( )
for@@ 
(@@ 
int@@ 
i@@ 
=@@ 
$num@@ 
;@@ 
i@@ 
<=@@  

totalPages@@! +
;@@+ ,
i@@- .
++@@. 0
)@@0 1
{AA 
varBB 
othersBB 
=BB 
awaitBB "
RequestBugDataBB# 1
(BB1 2
repoIdBB2 8
,BB8 9
iBB: ;
)BB; <
;BB< =
resultCC 
.CC 
issuesCC 
.CC 
AddRangeCC &
(CC& '
othersCC' -
.CC- .
issuesCC. 4
)CC4 5
;CC5 6
}DD 
returnFF 

MapIssueByFF 
(FF 
resultFF $
.FF$ %
issuesFF% +
)FF+ ,
;FF, -
}GG 	
privateII 

DictionaryII 
<II 
stringII !
,II! "
ListII# '
<II' (
IssuesII( .
>II. /
>II/ 0

MapIssueByII1 ;
(II; <
ListII< @
<II@ A
IssuesIIA G
>IIG H
issuesIII O
)IIO P
{JJ 	

DictionaryKK 
<KK 
stringKK 
,KK 
ListKK #
<KK# $
IssuesKK$ *
>KK* +
>KK+ ,
infoKK- 1
=KK2 3
newKK4 7

DictionaryKK8 B
<KKB C
stringKKC I
,KKI J
ListKKK O
<KKO P
IssuesKKP V
>KKV W
>KKW X
(KKX Y
)KKY Z
;KKZ [
foreachMM 
(MM 
varMM 
itemMM 
inMM  
issuesMM! '
)MM' (
{NN 
ListOO 
<OO 
IssuesOO 
>OO 
theIssueOO %
;OO% &
ifPP 
(PP 
infoPP 
.PP 
TryGetValuePP $
(PP$ %
itemPP% )
.PP) *
	componentPP* 3
,PP3 4
outPP5 8
theIssuePP9 A
)PPA B
)PPB C
{QQ 
theIssueRR 
.RR 
AddRR  
(RR  !
itemRR! %
)RR% &
;RR& '
}SS 
elseTT 
{UU 
infoVV 
.VV 
AddVV 
(VV 
itemVV !
.VV! "
	componentVV" +
,VV+ ,
newVV- 0
ListVV1 5
<VV5 6
IssuesVV6 <
>VV< =
(VV= >
)VV> ?
{VV@ A
itemVVB F
}VVG H
)VVH I
;VVI J
}WW 
}XX 
returnZZ 
infoZZ 
;ZZ 
}[[ 	
private]] 
async]] 
Task]] 
<]] 
CodeSmellDataDto]] +
>]]+ , 
RequestCodeSmellData]]- A
(]]A B
int]]B E
repoId]]F L
,]]L M
int]]N Q
	pageIndex]]R [
=]]\ ]
$num]]^ _
)]]_ `
{^^ 	
Repo__ 
repo__ 
=__ 

_dbContext__ "
.__" #
Repositories__# /
.__/ 0
Find__0 4
(__4 5
repoId__5 ;
)__; <
;__< =
string`` 
sonarqubeHostUrl`` #
=``$ %
repo``& *
.``* +
SonarqubeUrl``+ 7
;``7 8
stringaa 
apiUrlaa 
=aa 
$straa 0
;aa0 1
stringbb 

projectKeybb 
=bb 
repobb  $
.bb$ %

ProjectKeybb% /
;bb/ 0
stringcc 
querycc 
=cc 
$"cc 
$strcc +
{cc+ ,

projectKeycc, 6
}cc6 7
$strcc7 V
{ccV W
	PAGE_SIZEccW `
}cc` a
$str	cca Æ
"
ccÆ Ø
;
ccØ ∞
vardd 
responsedd 
=dd 
awaitdd  
_httpClientdd! ,
.dd, -
GetAsyncdd- 5
(dd5 6
$"dd6 8
{dd8 9
sonarqubeHostUrldd9 I
}ddI J
{ddJ K
apiUrlddK Q
}ddQ R
$strddR ^
{dd^ _

projectKeydd_ i
}ddi j
$strddj k
{ddk l
queryddl q
}ddq r
$strddr u
{ddu v
	pageIndexddv 
}	dd Ä
"
ddÄ Å
)
ddÅ Ç
;
ddÇ É
stringee 
contentee 
=ee 
awaitee "
responseee# +
.ee+ ,
Contentee, 3
.ee3 4
ReadAsStringAsyncee4 E
(eeE F
)eeF G
;eeG H
returnff 
JsonSerializerff !
.ff! "
Deserializeff" -
<ff- .
CodeSmellDataDtoff. >
>ff> ?
(ff? @
contentff@ G
)ffG H
;ffH I
}gg 	
privateii 
asyncii 
Taskii 
<ii 

BugDataDtoii %
>ii% &
RequestBugDataii' 5
(ii5 6
intii6 9
repoIdii: @
,ii@ A
intiiB E
	pageIndexiiF O
=iiP Q
$numiiR S
)iiS T
{jj 	
Repokk 
repokk 
=kk 

_dbContextkk "
.kk" #
Repositorieskk# /
.kk/ 0
Findkk0 4
(kk4 5
repoIdkk5 ;
)kk; <
;kk< =
stringll 
sonarqubeHostUrlll #
=ll$ %
repoll& *
.ll* +
SonarqubeUrlll+ 7
;ll7 8
stringmm 
apiUrlmm 
=mm 
$strmm 0
;mm0 1
stringnn 

projectKeynn 
=nn 
reponn  $
.nn$ %

ProjectKeynn% /
;nn/ 0
stringoo 
queryoo 
=oo 
$"oo 
$stroo +
{oo+ ,

projectKeyoo, 6
}oo6 7
$stroo7 V
{ooV W
	PAGE_SIZEooW `
}oo` a
$str	ooa ß
"
ooß ®
;
oo® ©
varpp 
responsepp 
=pp 
awaitpp  
_httpClientpp! ,
.pp, -
GetAsyncpp- 5
(pp5 6
$"pp6 8
{pp8 9
sonarqubeHostUrlpp9 I
}ppI J
{ppJ K
apiUrlppK Q
}ppQ R
$strppR ^
{pp^ _

projectKeypp_ i
}ppi j
$strppj k
{ppk l
queryppl q
}ppq r
$strppr u
{ppu v
	pageIndexppv 
}	pp Ä
"
ppÄ Å
)
ppÅ Ç
;
ppÇ É
stringqq 
contentqq 
=qq 
awaitqq "
responseqq# +
.qq+ ,
Contentqq, 3
.qq3 4
ReadAsStringAsyncqq4 E
(qqE F
)qqF G
;qqG H
returnrr 
JsonSerializerrr !
.rr! "
Deserializerr" -
<rr- .

BugDataDtorr. 8
>rr8 9
(rr9 :
contentrr: A
)rrA B
;rrB C
}ss 	
publicuu 
asyncuu 
Taskuu 
<uu 
SonarSheetDtouu '
>uu' (
GetCoverageuu) 4
(uu4 5
intuu5 8
repoIduu9 ?
,uu? @
intuuA D
	pageIndexuuE N
=uuO P
$numuuQ R
)uuR S
{vv 	
Repoww 
repoww 
=ww 

_dbContextww "
.ww" #
Repositoriesww# /
.ww/ 0
Findww0 4
(ww4 5
repoIdww5 ;
)ww; <
;ww< =
stringxx 
sonarqubeHostUrlxx #
=xx$ %
repoxx& *
.xx* +
SonarqubeUrlxx+ 7
;xx7 8
stringyy 
apiUrlyy 
=yy 
$stryy :
;yy: ;
stringzz 

projectKeyzz 
=zz 
repozz  $
.zz$ %

ProjectKeyzz% /
;zz/ 0
string{{ 
query{{ 
={{ 
$"{{ 
$str{{ '
{{{' (

projectKey{{( 2
}{{2 3
$str{{3 Q
{{{Q R
	PAGE_SIZE{{R [
}{{[ \
$str	{{\ û
"
{{û ü
;
{{ü †
_httpClient|| 
.|| !
DefaultRequestHeaders|| -
.||- .
Add||. 1
(||1 2
$str||2 >
,||> ?
$str||@ I
)||I J
;||J K
_httpClient}} 
.}} !
DefaultRequestHeaders}} -
.}}- .
Add}}. 1
(}}1 2
$str}}2 A
,}}A B
$"}}C E
$str}}E K
{}}K L
repo}}L P
.}}P Q
AccountColonPw}}Q _
}}}_ `
"}}` a
)}}a b
;}}b c
var~~ 
response~~ 
=~~ 
await~~  
_httpClient~~! ,
.~~, -
GetAsync~~- 5
(~~5 6
$"~~6 8
{~~8 9
sonarqubeHostUrl~~9 I
}~~I J
{~~J K
apiUrl~~K Q
}~~Q R
$str~~R ^
{~~^ _

projectKey~~_ i
}~~i j
$str~~j k
{~~k l
query~~l q
}~~q r
$str~~r u
{~~u v
	pageIndex~~v 
}	~~ Ä
"
~~Ä Å
)
~~Å Ç
;
~~Ç É
string 
content 
= 
await "
response# +
.+ ,
Content, 3
.3 4
ReadAsStringAsync4 E
(E F
)F G
;G H
var
ÄÄ 
result
ÄÄ 
=
ÄÄ 
JsonSerializer
ÄÄ '
.
ÄÄ' (
Deserialize
ÄÄ( 3
<
ÄÄ3 4
SonarSheetDto
ÄÄ4 A
>
ÄÄA B
(
ÄÄB C
content
ÄÄC J
)
ÄÄJ K
;
ÄÄK L
Console
ÅÅ 
.
ÅÅ 
	WriteLine
ÅÅ 
(
ÅÅ 
result
ÅÅ $
)
ÅÅ$ %
;
ÅÅ% &
return
ÇÇ 
result
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
public
ÖÖ 
async
ÖÖ 
Task
ÖÖ 
<
ÖÖ 
SonarSheetDto
ÖÖ '
>
ÖÖ' (
GetDuplication
ÖÖ) 7
(
ÖÖ7 8
int
ÖÖ8 ;
repoId
ÖÖ< B
,
ÖÖB C
int
ÖÖD G
	pageIndex
ÖÖH Q
=
ÖÖR S
$num
ÖÖT U
)
ÖÖU V
{
ÜÜ 	
Repo
áá 
repo
áá 
=
áá 

_dbContext
áá "
.
áá" #
Repositories
áá# /
.
áá/ 0
Find
áá0 4
(
áá4 5
repoId
áá5 ;
)
áá; <
;
áá< =
string
àà 
sonarqubeHostUrl
àà #
=
àà$ %
repo
àà& *
.
àà* +
SonarqubeUrl
àà+ 7
;
àà7 8
string
ââ 
apiUrl
ââ 
=
ââ 
$str
ââ :
;
ââ: ;
string
ää 

projectKey
ää 
=
ää 
repo
ää  $
.
ää$ %

ProjectKey
ää% /
;
ää/ 0
string
ãã 
query
ãã 
=
ãã 
$"
ãã 
$str
ãã '
{
ãã' (

projectKey
ãã( 2
}
ãã2 3
$str
ãã3 Q
{
ããQ R
	PAGE_SIZE
ããR [
}
ãã[ \
$strãã\ £
"ãã£ §
;ãã§ •
_httpClient
åå 
.
åå #
DefaultRequestHeaders
åå -
.
åå- .
Add
åå. 1
(
åå1 2
$str
åå2 >
,
åå> ?
$str
åå@ I
)
ååI J
;
ååJ K
_httpClient
çç 
.
çç #
DefaultRequestHeaders
çç -
.
çç- .
Add
çç. 1
(
çç1 2
$str
çç2 A
,
ççA B
$"
ççC E
$str
ççE K
{
ççK L
repo
ççL P
.
ççP Q
AccountColonPw
ççQ _
}
çç_ `
"
çç` a
)
çça b
;
ççb c
var
éé 
response
éé 
=
éé 
await
éé  
_httpClient
éé! ,
.
éé, -
GetAsync
éé- 5
(
éé5 6
$"
éé6 8
{
éé8 9
sonarqubeHostUrl
éé9 I
}
ééI J
{
ééJ K
apiUrl
ééK Q
}
ééQ R
$str
ééR ^
{
éé^ _

projectKey
éé_ i
}
ééi j
$str
ééj k
{
éék l
query
éél q
}
ééq r
$str
éér u
{
ééu v
	pageIndex
éév 
}éé Ä
"ééÄ Å
)ééÅ Ç
;ééÇ É
string
èè 
content
èè 
=
èè 
await
èè "
response
èè# +
.
èè+ ,
Content
èè, 3
.
èè3 4
ReadAsStringAsync
èè4 E
(
èèE F
)
èèF G
;
èèG H
var
êê 
result
êê 
=
êê 
JsonSerializer
êê '
.
êê' (
Deserialize
êê( 3
<
êê3 4
SonarSheetDto
êê4 A
>
êêA B
(
êêB C
content
êêC J
)
êêJ K
;
êêK L
Console
ëë 
.
ëë 
	WriteLine
ëë 
(
ëë 
result
ëë $
)
ëë$ %
;
ëë% &
return
íí 
result
íí 
;
íí 
}
ìì 	
public
ïï 
async
ïï 
Task
ïï 
<
ïï 
bool
ïï 
>
ïï 
IsHaveSonarqube
ïï  /
(
ïï/ 0
int
ïï0 3
repoId
ïï4 :
)
ïï: ;
{
ññ 	
Repo
óó 
repo
óó 
=
óó 
await
óó 

_dbContext
óó (
.
óó( )
Repositories
óó) 5
.
óó5 6
	FindAsync
óó6 ?
(
óó? @
repoId
óó@ F
)
óóF G
;
óóG H
return
òò 
repo
òò 
.
òò 
IsSonarqube
òò #
;
òò# $
}
ôô 	
}
öö 
}õõ ∫t
|C:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Services\UserService.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Services( 0
{ 
public 

class 
UserService 
: 
BaseService *
{ 
public 
UserService 
( 

PMSContext %
	dbContext& /
)/ 0
:1 2
base3 7
(7 8
	dbContext8 A
)A B
{C D
}E F
public 
void 

CreateUser 
( 
User #
model$ )
)) *
{ 	

_dbContext 
. 
Users 
. 
Add  
(  !
model! &
)& '
;' (
if 
( 

_dbContext 
. 
SaveChanges &
(& '
)' (
==) +
$num, -
)- .
{ 
throw 
new 
	Exception #
(# $
$str$ 6
)6 7
;7 8
} 
} 	
public 
void 

CreateUser 
( 
LocalAccountDto .
dto/ 2
)2 3
{ 	
User 
user 
= 
new 
User  
{ 
Account 
= 
dto 
. 
Account %
,% &
	Authority   
=   
$str   #
,  # $
	AvatarUrl!! 
=!! 
$str!! =
,!!= >
Name"" 
="" 
$str"" 
,"" 
Password## 
=## 
Argon2## !
.##! "
Hash##" &
(##& '
dto##' *
.##* +
Password##+ 3
)##3 4
}$$ 
;$$ 

_dbContext%% 
.%% 
Users%% 
.%% 
Add%%  
(%%  !
user%%! %
)%%% &
;%%& '
if&& 
(&& 

_dbContext&& 
.&& 
SaveChanges&& &
(&&& '
)&&' (
==&&) +
$num&&, -
)&&- .
{'' 
throw(( 
new(( 
	Exception(( #
(((# $
$str(($ 6
)((6 7
;((7 8
})) 
}** 	
public,, 
bool,, 
CheckUserExist,, "
(,," #
string,,# )
account,,* 1
),,1 2
{-- 	
var.. 
Users.. 
=.. 

_dbContext.. "
..." #
Users..# (
...( )
Where..) .
(... /
u../ 0
=>..1 3
u..4 5
...5 6
Account..6 =
...= >
Equals..> D
(..D E
account..E L
)..L M
)..M N
...N O
ToList..O U
(..U V
)..V W
;..W X
return// 
Users// 
.// 
Any// 
(// 
)// 
;// 
}00 	
public22 
bool22 
IsProjectOwner22 "
(22" #
User22# '
owner22( -
,22- .
int22/ 2
	projectId223 <
)22< =
{33 	
var44 
project44 
=44 

_dbContext44 $
.44$ %
Projects44% -
.44- .
Include44. 5
(445 6
p446 7
=>448 :
p44; <
.44< =
Owner44= B
)44B C
.44C D
Where44D I
(44I J
p44J K
=>44L N
p44O P
.44P Q
ID44Q S
.44S T
Equals44T Z
(44Z [
	projectId44[ d
)44d e
)44e f
.44f g
First44g l
(44l m
)44m n
;44n o
return55 
project55 
.55 
Owner55  
.55  !
Equals55! '
(55' (
owner55( -
)55- .
;55. /
}66 	
public88 
UserInfoDto88 
GetUser88 "
(88" #
string88# )
account88* 1
)881 2
{99 	
var:: 
user:: 
=:: 

_dbContext:: !
.::! "
Users::" '
.::' (
Find::( ,
(::, -
account::- 4
)::4 5
;::5 6
if;; 
(;; 
user;; 
==;; 
null;; 
);; 
throw<< 
new<< 
	Exception<< #
(<<# $
$str<<$ 5
)<<5 6
;<<6 7
return== 
new== 
UserInfoDto== "
{==# $
id==% '
===( )
user==* .
.==. /
Account==/ 6
,==6 7
name==8 <
==== >
user==? C
.==C D
Name==D H
,==H I
	avatarUrl==J S
===T U
user==V Z
.==Z [
	AvatarUrl==[ d
}==e f
;==f g
}>> 	
public@@ 
List@@ 
<@@ 
UserInfoDto@@ 
>@@  

GetAllUser@@! +
(@@+ ,
string@@, 2
	inviterId@@3 <
)@@< =
{AA 	
returnBB 

_dbContextBB 
.BB 
UsersBB #
.BB# $
WhereBB$ )
(BB) *
uBB* +
=>BB, .
uBB/ 0
.BB0 1
AccountBB1 8
!=BB9 ;
	inviterIdBB< E
)BBE F
.BBF G
SelectBBG M
(BBM N
uBBN O
=>BBP R
newBBS V
UserInfoDtoBBW b
{CC 
idDD 
=DD 
uDD 
.DD 
AccountDD 
,DD 
nameEE 
=EE 
uEE 
.EE 
NameEE 
,EE 
	avatarUrlFF 
=FF 
uFF 
.FF 
	AvatarUrlFF '
}GG 
)GG 
.GG 
ToListGG 
(GG 
)GG 
;GG 
}HH 	
publicJJ 
voidJJ 
EditUserNameJJ  
(JJ  !
stringJJ! '
accountJJ( /
,JJ/ 0
stringJJ1 7
newUserNameJJ8 C
)JJC D
{KK 	
stringLL 
regexPatternLL 
=LL  !
$strLL" 2
;LL2 3
RegexMM 
regexMM 
=MM 
newMM 
RegexMM #
(MM# $
regexPatternMM$ 0
)MM0 1
;MM1 2
ifNN 
(NN 
newUserNameNN 
==NN 
$strNN !
||NN" $
!NN% &
regexNN& +
.NN+ ,
IsMatchNN, 3
(NN3 4
newUserNameNN4 ?
)NN? @
)NN@ A
{OO 
throwPP 
newPP 
	ExceptionPP #
(PP# $
$strPP$ <
)PP< =
;PP= >
}QQ 
UserSS 
userSS 
=SS 

_dbContextSS "
.SS" #
UsersSS# (
.SS( )
FindSS) -
(SS- .
accountSS. 5
)SS5 6
;SS6 7
ifTT 
(TT 
userTT 
!=TT 
nullTT 
)TT 
{UU 
userVV 
.VV 
NameVV 
=VV 
newUserNameVV '
;VV' (

_dbContextWW 
.WW 
UpdateWW !
(WW! "
userWW" &
)WW& '
;WW' (
}XX 
elseYY 
{ZZ 
throw[[ 
new[[ 
	Exception[[ #
([[# $
$str[[$ 4
)[[4 5
;[[5 6
}\\ 
if^^ 
(^^ 

_dbContext^^ 
.^^ 
SaveChanges^^ &
(^^& '
)^^' (
==^^) +
$num^^, -
)^^- .
{__ 
throw`` 
new`` 
	Exception`` #
(``# $
$str``$ 9
)``9 :
;``: ;
}aa 
}bb 	
publicdd 
Userdd 
GetUserModeldd  
(dd  !
stringdd! '
accountdd( /
)dd/ 0
{ee 	
varff 
userff 
=ff 

_dbContextff !
.ff! "
Usersff" '
.ff' (
Includeff( /
(ff/ 0
uff0 1
=>ff2 4
uff5 6
.ff6 7
Projectsff7 ?
)ff? @
.ff@ A
ThenIncludeffA L
(ffL M
pffM N
=>ffO Q
pffR S
.ffS T
ProjectffT [
)ff[ \
.ff\ ]
Firstff] b
(ffb c
uffc d
=>ffe g
uffh i
.ffi j
Accountffj q
.ffq r
Equalsffr x
(ffx y
account	ffy Ä
)
ffÄ Å
)
ffÅ Ç
;
ffÇ É
returnhh 
userhh 
;hh 
}ii 	
publickk 
voidkk 

AddProjectkk 
(kk 

Invitationkk )

invitationkk* 4
)kk4 5
{ll 	
varmm 
usermm 
=mm 

invitationmm !
.mm! "
	Applicantmm" +
;mm+ ,
usernn 
.nn 
Projectsnn 
.nn 
Addnn 
(nn 
newnn !
UserProjectnn" -
{nn. /
Usernn0 4
=nn5 6
usernn7 ;
,nn; <
Projectnn= D
=nnE F

invitationnnG Q
.nnQ R
InvitedProjectnnR `
}nna b
)nnb c
;nnc d
ifpp 
(pp 

_dbContextpp 
.pp 
SaveChangespp &
(pp& '
)pp' (
==pp) +
$numpp, -
)pp- .
{qq 
throwrr 
newrr 
	Exceptionrr #
(rr# $
$strrr$ 7
)rr7 8
;rr8 9
}ss 
}tt 	
publicvv 
Listvv 
<vv 
Uservv 
>vv  
GetAllUserNotIncludevv .
(vv. /
stringvv/ 5
accountvv6 =
)vv= >
{ww 	
returnxx 

_dbContextxx 
.xx 
Usersxx #
.xx# $
Wherexx$ )
(xx) *
uxx* +
=>xx, .
uxx/ 0
.xx0 1
Accountxx1 8
!=xx9 ;
accountxx< C
)xxC D
.xxD E
ToListxxE K
(xxK L
)xxL M
;xxM N
}yy 	
public{{ 
void{{ 
DeleteUserByAccount{{ '
({{' (
string{{( .
account{{/ 6
){{6 7
{|| 	
var}} 
user}} 
=}} 

_dbContext}} !
.}}! "
Users}}" '
.}}' (
Include}}( /
(}}/ 0
u}}0 1
=>}}2 4
u}}5 6
.}}6 7
Projects}}7 ?
)}}? @
.}}@ A
ThenInclude}}A L
(}}L M
up}}M O
=>}}P R
up}}S U
.}}U V
Project}}V ]
)}}] ^
.}}^ _
ThenInclude}}_ j
(}}j k
upp}}k n
=>}}o q
upp}}r u
.}}u v
Owner}}v {
)}}{ |
.}}| }
FirstOrDefault	}}} ã
(
}}ã å
u
}}å ç
=>
}}é ê
u
}}ë í
.
}}í ì
Account
}}ì ö
==
}}õ ù
account
}}û •
)
}}• ¶
;
}}¶ ß
if~~ 
(~~ 
user~~ 
==~~ 
null~~ 
)~~ 
throw 
new 
	Exception #
(# $
$str$ 5
)5 6
;6 7
if
ÄÄ 
(
ÄÄ 
user
ÄÄ 
.
ÄÄ 
Projects
ÄÄ 
.
ÄÄ 
Any
ÄÄ !
(
ÄÄ! "
)
ÄÄ" #
)
ÄÄ# $
{
ÅÅ 
var
ÇÇ 
userProjects
ÇÇ  
=
ÇÇ! "
user
ÇÇ# '
.
ÇÇ' (
Projects
ÇÇ( 0
.
ÇÇ0 1
Where
ÇÇ1 6
(
ÇÇ6 7
up
ÇÇ7 9
=>
ÇÇ: <
up
ÇÇ= ?
.
ÇÇ? @
Project
ÇÇ@ G
.
ÇÇG H
Owner
ÇÇH M
.
ÇÇM N
Account
ÇÇN U
==
ÇÇV X
user
ÇÇY ]
.
ÇÇ] ^
Account
ÇÇ^ e
)
ÇÇe f
.
ÇÇf g
ToList
ÇÇg m
(
ÇÇm n
)
ÇÇn o
;
ÇÇo p
ProjectService
ÉÉ 
projectService
ÉÉ -
=
ÉÉ. /
new
ÉÉ0 3
ProjectService
ÉÉ4 B
(
ÉÉB C

_dbContext
ÉÉC M
)
ÉÉM N
;
ÉÉN O
userProjects
ÑÑ 
.
ÑÑ 
ForEach
ÑÑ $
(
ÑÑ$ %
up
ÑÑ% '
=>
ÑÑ( *
projectService
ÑÑ+ 9
.
ÑÑ9 :
DeleteProject
ÑÑ: G
(
ÑÑG H
up
ÑÑH J
.
ÑÑJ K
	ProjectId
ÑÑK T
)
ÑÑT U
)
ÑÑU V
;
ÑÑV W
}
ÖÖ 

_dbContext
ÜÜ 
.
ÜÜ 
Users
ÜÜ 
.
ÜÜ 
Remove
ÜÜ #
(
ÜÜ# $
user
ÜÜ$ (
)
ÜÜ( )
;
ÜÜ) *
if
áá 
(
áá 

_dbContext
áá 
.
áá 
SaveChanges
áá &
(
áá& '
)
áá' (
==
áá) +
$num
áá, -
)
áá- .
throw
àà 
new
àà 
	Exception
àà #
(
àà# $
$str
àà$ 6
)
àà6 7
;
àà7 8
}
ââ 	
public
ãã 
bool
ãã 
IsAdmin
ãã 
(
ãã 
string
ãã "
account
ãã# *
)
ãã* +
{
åå 	
return
çç 

_dbContext
çç 
.
çç 
Users
çç #
.
çç# $
Find
çç$ (
(
çç( )
account
çç) 0
)
çç0 1
.
çç1 2
	Authority
çç2 ;
.
çç; <
Equals
çç< B
(
ççB C
$str
ççC J
)
ççJ K
;
ççK L
}
éé 	
public
êê 
bool
êê 
EditUserInfo
êê  
(
êê  !
string
êê! '
account
êê( /
,
êê/ 0
JsonPatchDocument
êê1 B
<
êêB C
User
êêC G
>
êêG H
newUserInfo
êêI T
)
êêT U
{
ëë 	
var
íí 
user
íí 
=
íí 
GetUserModel
íí #
(
íí# $
account
íí$ +
)
íí+ ,
;
íí, -
newUserInfo
ìì 
.
ìì 
ApplyTo
ìì 
(
ìì  
user
ìì  $
)
ìì$ %
;
ìì% &
return
îî 
!
îî 
(
îî 

_dbContext
îî 
.
îî  
SaveChanges
îî  +
(
îî+ ,
)
îî, -
==
îî. 0
$num
îî1 2
)
îî2 3
;
îî3 4
}
ïï 	
}
ññ 
}óó ≥
zC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Shares\DateHandler.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Shares( .
{ 
public 

static 
class 
DateHandler #
{ 
public 
static 
string 
ConvertToDateString 0
(0 1
long1 5
javascriptTicks6 E
)E F
{ 	
const		 
long		 
baseTick		 
=		  !
$num		" 4
;		4 5
var

 
dateTime

 
=

 
new

 
DateTime

 '
(

' (
javascriptTicks

( 7
*

8 9
$num

: B
+

C D
baseTick

E M
)

M N
;

N O
return 
dateTime 
. 
ToString $
($ %
$str% ,
), -
;- .
} 	
public 
static 
string 
ConvertToDayOfWeek /
(/ 0
int0 3
	dayOfWeek4 =
)= >
{ 	
return 
	dayOfWeek 
switch #
{ 
$num 
=> 
$str 
, 
$num 
=> 
$str 
, 
$num 
=> 
$str 
, 
$num 
=> 
$str  
,  !
$num 
=> 
$str 
,  
$num 
=> 
$str 
, 
$num 
=> 
$str 
,  
_ 
=> 
throw 
new 
	Exception (
(( )
$str) A
)A B
,B C
} 
; 
} 	
} 
} Â%
xC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Shares\JwtHelper.cs
	namespace		 	)
project_manage_system_backend		
 '
.		' (
Shares		( .
{

 
public 

class 
	JwtHelper 
{ 
private 
readonly 
IConfiguration '
Configuration( 5
;5 6
public 
	JwtHelper 
( 
IConfiguration '
configuration( 5
)5 6
{ 	
this 
. 
Configuration 
=  
configuration! .
;. /
} 	
public 
string 
GenerateToken #
(# $
string$ *
userAccount+ 6
,6 7
string8 >

oauthToken? I
,I J
stringK Q
roleR V
=W X
$strY _
,_ `
inta d
expireMinutese r
=s t
$numu y
)y z
{ 	
var 
issuer 
= 
Configuration &
.& '
GetValue' /
</ 0
string0 6
>6 7
(7 8
$str8 L
)L M
;M N
var 
signKey 
= 
Configuration '
.' (
GetValue( 0
<0 1
string1 7
>7 8
(8 9
$str9 N
)N O
;O P
var 
claims 
= 
new 
List !
<! "
Claim" '
>' (
(( )
)) *
;* +
claims 
. 
Add 
( 
new 
Claim  
(  !#
JwtRegisteredClaimNames! 8
.8 9
Sub9 <
,< =
userAccount> I
)I J
)J K
;K L
claims 
. 
Add 
( 
new 
Claim  
(  !#
JwtRegisteredClaimNames! 8
.8 9
Jti9 <
,< =
Guid> B
.B C
NewGuidC J
(J K
)K L
.L M
ToStringM U
(U V
)V W
)W X
)X Y
;Y Z
claims 
. 
Add 
( 
new 
Claim  
(  !
$str! (
,( )

oauthToken* 4
)4 5
)5 6
;6 7
claims!! 
.!! 
Add!! 
(!! 
new!! 
Claim!!  
(!!  !
$str!!! (
,!!( )
role!!* .
)!!. /
)!!/ 0
;!!0 1
var## 
userClaimsIdentity## "
=### $
new##% (
ClaimsIdentity##) 7
(##7 8
claims##8 >
)##> ?
;##? @
var&& 
securityKey&& 
=&& 
new&& ! 
SymmetricSecurityKey&&" 6
(&&6 7
Encoding&&7 ?
.&&? @
UTF8&&@ D
.&&D E
GetBytes&&E M
(&&M N
signKey&&N U
)&&U V
)&&V W
;&&W X
var** 
signingCredentials** "
=**# $
new**% (
SigningCredentials**) ;
(**; <
securityKey**< G
,**G H
SecurityAlgorithms**I [
.**[ \
HmacSha256Signature**\ o
)**o p
;**p q
var-- 
tokenDescriptor-- 
=--  !
new--" %#
SecurityTokenDescriptor--& =
{.. 
Issuer// 
=// 
issuer// 
,//  
Subject00 
=00 
userClaimsIdentity00 ,
,00, -
Expires11 
=11 
DateTime11 "
.11" #
Now11# &
.11& '

AddMinutes11' 1
(111 2
expireMinutes112 ?
)11? @
,11@ A
SigningCredentials22 "
=22# $
signingCredentials22% 7
}33 
;33 
var66 
tokenHandler66 
=66 
new66 "#
JwtSecurityTokenHandler66# :
(66: ;
)66; <
;66< =
var77 
securityToken77 
=77 
tokenHandler77  ,
.77, -
CreateToken77- 8
(778 9
tokenDescriptor779 H
)77H I
;77I J
var88 
serializeToken88 
=88  
tokenHandler88! -
.88- .

WriteToken88. 8
(888 9
securityToken889 F
)88F G
;88G H
return:: 
serializeToken:: !
;::! "
};; 	
}<< 
}== ò
yC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Shares\PMSContext.cs
	namespace 	)
project_manage_system_backend
 '
.' (
Shares( .
{ 
public 

class 

PMSContext 
: 
	DbContext '
{ 
public 

PMSContext 
( 
DbContextOptions *
<* +

PMSContext+ 5
>5 6
options7 >
)> ?
:@ A
baseB F
(F G
optionsG N
)N O
{P Q
}R S
public

 
DbSet

 
<

 
User

 
>

 
Users

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 
DbSet 
< 
Project 
> 
Projects &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Repo 
> 
Repositories '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
DbSet 
< 

Invitation 
>  
Invitations! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
modelBuilder 
. 
Entity 
<  
UserProject  +
>+ ,
(, -
)- .
.. /
HasKey/ 5
(5 6
p6 7
=>8 :
new; >
{? @
pA B
.B C
	ProjectIdC L
,L M
pN O
.O P
AccountP W
}X Y
)Y Z
;Z [
modelBuilder 
. 
Entity 
<  
UserProject  +
>+ ,
(, -
)- .
. 
HasOne 
( 
up 
=> 
up  
.  !
Project! (
)( )
. 
WithMany 
( 
p 
=> 
p  
.  !
Users! &
)& '
. 
HasForeignKey 
( 
ut !
=>" $
ut% '
.' (
	ProjectId( 1
)1 2
;2 3
modelBuilder 
. 
Entity 
<  
UserProject  +
>+ ,
(, -
)- .
. 
HasOne 
( 
pt 
=> 
pt  
.  !
User! %
)% &
. 
WithMany 
( 
t 
=> 
t  
.  !
Projects! )
)) *
. 
HasForeignKey 
( 
pt !
=>" $
pt% '
.' (
Account( /
)/ 0
;0 1
} 	
} 
} ·Q
oC:\NTUT_KAI\Project_Manage_Project_ForCourse\backend-main\backend-main\project-manage-system-backend\Startup.cs
	namespace 	)
project_manage_system_backend
 '
{ 
public 

class 
Startup 
{ 
private 
readonly 
IWebHostEnvironment ,
_env- 1
;1 2
public 
Startup 
( 
IConfiguration %
configuration& 3
,3 4
IWebHostEnvironment5 H
envI L
)L M
{ 	
Configuration 
= 
configuration )
;) *
_env 
= 
env 
; 
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
private 
readonly 
string #
_developmentAllowOrigin  7
=8 9
$str: Q
;Q R
private 
readonly 
string 
_deployAllowOrigin  2
=3 4
$str5 E
;E F
public!! 
void!! 
ConfigureServices!! %
(!!% &
IServiceCollection!!& 8
services!!9 A
)!!A B
{"" 	
services## 
.## 

AddLogging## 
(##  
builder##  '
=>##( *
{$$ 
builder%% 
.%% 
AddConfiguration%% (
(%%( )
Configuration%%) 6
.%%6 7

GetSection%%7 A
(%%A B
$str%%B K
)%%K L
)%%L M
.&& 

AddConsole&& "
(&&" #
)&&# $
.'' 
AddDebug''  
(''  !
)''! "
;''" #
}(( 
)(( 
;(( 
if** 
(** 
_env** 
.** 
IsEnvironment** "
(**" #
$str**# ,
)**, -
)**- .
{++ 
var,, 
connect,, 
=,, 
new,, !
SqliteConnection,," 2
(,,2 3
$str,,3 H
),,H I
;,,I J
connect-- 
.-- 
Open-- 
(-- 
)-- 
;-- 
services// 
.// 
AddDbContext// %
<//% &

PMSContext//& 0
>//0 1
(//1 2
options//2 9
=>//: <
options00 
.00 
	UseSqlite00 !
(00! "
connect00" )
)00) *
)00* +
;00+ ,
}11 
else22 
{33 
services44 
.44 
AddDbContext44 %
<44% &

PMSContext44& 0
>440 1
(441 2
options442 9
=>44: <
options55 
.55 
	UseSqlite55 !
(55! "
$str55" ?
)55? @
)55@ A
;55A B
}66 
services88 
.88 
AddSingleton88 !
<88! "
	JwtHelper88" +
>88+ ,
(88, -
)88- .
;88. /
services99 
.:: 
AddAuthentication:: 
(:: 
JwtBearerDefaults:: 0
.::0 1 
AuthenticationScheme::1 E
)::E F
.;; 
AddJwtBearer;; 
(;; 
options;; !
=>;;" $
{<< 
options== 
.== 
	SaveToken== !
===" #
true==$ (
;==( )
options>> 
.>> 
IncludeErrorDetails>> +
=>>, -
true>>. 2
;>>2 3
options@@ 
.@@ %
TokenValidationParameters@@ 1
=@@2 3
new@@4 7%
TokenValidationParameters@@8 Q
{AA 
NameClaimTypeCC !
=CC" #
$strCC$ j
,CCj k
RoleClaimTypeEE !
=EE" #
$strEE$ b
,EEb c
ValidateIssuerHH "
=HH# $
trueHH% )
,HH) *
ValidIssuerII 
=II  !
ConfigurationII" /
.II/ 0
GetValueII0 8
<II8 9
stringII9 ?
>II? @
(II@ A
$strIIA U
)IIU V
,IIV W
ValidateAudienceLL $
=LL% &
falseLL' ,
,LL, -
ValidateLifetimeOO $
=OO% &
trueOO' +
,OO+ ,$
ValidateIssuerSigningKeyRR ,
=RR- .
falseRR/ 4
,RR4 5
IssuerSigningKeyUU $
=UU% &
newUU' * 
SymmetricSecurityKeyUU+ ?
(UU? @
EncodingUU@ H
.UUH I
UTF8UUI M
.UUM N
GetBytesUUN V
(UUV W
ConfigurationUUW d
.UUd e
GetValueUUe m
<UUm n
stringUUn t
>UUt u
(UUu v
$str	UUv ã
)
UUã å
)
UUå ç
)
UUç é
}VV 
;VV 
optionsXX 
.XX 
EventsXX 
=XX  
newXX! $
JwtBearerEventsXX% 4
{YY 
OnMessageReceivedZZ %
=ZZ& '
contextZZ( /
=>ZZ0 2
{[[ 
var\\ 
accessToken\\ '
=\\( )
context\\* 1
.\\1 2
Request\\2 9
.\\9 :
Headers\\: A
[\\A B
$str\\B Q
]\\Q R
;\\R S
var__ 
path__  
=__! "
context__# *
.__* +
HttpContext__+ 6
.__6 7
Request__7 >
.__> ?
Path__? C
;__C D
if`` 
(`` 
!`` 
string`` #
.``# $
IsNullOrEmpty``$ 1
(``1 2
accessToken``2 =
)``= >
&&``? A
(aa 
pathaa !
.aa! "
StartsWithSegmentsaa" 4
(aa4 5
$straa5 B
)aaB C
)aaC D
)aaD E
{bb 
contextdd #
.dd# $
Tokendd$ )
=dd* +
accessTokendd, 7
;dd7 8
}ee 
returnff 
Taskff #
.ff# $
CompletedTaskff$ 1
;ff1 2
}gg 
}hh 
;hh 
}ii 
)ii 
;ii 
serviceskk 
.kk 
AddCorskk 
(kk 
optionskk $
=>kk% '
{ll 
optionsmm 
.mm 
	AddPolicymm !
(mm! "
$strmm" 5
,mm5 6
policymm7 =
=>mm> @
{nn 
policyoo 
.oo 
WithOriginsoo &
(oo& '#
_developmentAllowOriginoo' >
)oo> ?
.pp 
AllowAnyHeaderpp )
(pp) *
)pp* +
.qq 
AllowAnyMethodqq )
(qq) *
)qq* +
.rr 
AllowCredentialsrr +
(rr+ ,
)rr, -
;rr- .
}ss 
)ss 
;ss 
optionsuu 
.uu 
	AddPolicyuu !
(uu! "
$struu" 0
,uu0 1
policyuu2 8
=>uu9 ;
{vv 
policyww 
.ww 
WithOriginsww &
(ww& '
_deployAllowOriginww' 9
)ww9 :
.xx 
AllowAnyHeaderxx )
(xx) *
)xx* +
.yy 
AllowAnyMethodyy )
(yy) *
)yy* +
.zz 
AllowCredentialszz +
(zz+ ,
)zz, -
;zz- .
}{{ 
){{ 
;{{ 
}|| 
)|| 
;|| 
services~~ 
.~~ 

AddSignalR~~ 
(~~  
)~~  !
;~~! "
services 
. 
AddControllers #
(# $
)$ %
.% &
AddNewtonsoftJson& 7
(7 8
opt8 ;
=>< >
opt? B
.B C
SerializerSettingsC U
.U V!
ReferenceLoopHandlingV k
=l m

Newtonsoftn x
.x y
Jsony }
.} ~"
ReferenceLoopHandling	~ ì
.
ì î
Ignore
î ö
)
ö õ
;
õ ú
}
ÄÄ 	
public
ÉÉ 
void
ÉÉ 
	Configure
ÉÉ 
(
ÉÉ !
IApplicationBuilder
ÉÉ 1
app
ÉÉ2 5
,
ÉÉ5 6!
IWebHostEnvironment
ÉÉ7 J
env
ÉÉK N
)
ÉÉN O
{
ÑÑ 	
if
ÖÖ 
(
ÖÖ 
env
ÖÖ 
.
ÖÖ 
IsDevelopment
ÖÖ !
(
ÖÖ! "
)
ÖÖ" #
)
ÖÖ# $
{
ÜÜ 
app
áá 
.
áá !
UseExceptionHandler
áá '
(
áá' (
$str
áá( B
)
ááB C
;
ááC D
}
àà 
else
ââ 
{
ää 
app
ãã 
.
ãã !
UseExceptionHandler
ãã '
(
ãã' (
$str
ãã( 0
)
ãã0 1
;
ãã1 2
}
åå 
app
éé 
.
éé !
UseHttpsRedirection
éé #
(
éé# $
)
éé$ %
;
éé% &
app
êê 
.
êê 

UseRouting
êê 
(
êê 
)
êê 
;
êê 
if
íí 
(
íí 
env
íí 
.
íí 
IsDevelopment
íí !
(
íí! "
)
íí" #
)
íí# $
{
ìì 
app
îî 
.
îî 
UseCors
îî 
(
îî 
$str
îî /
)
îî/ 0
;
îî0 1
}
ïï 
else
ññ 
{
óó 
app
òò 
.
òò 
UseCors
òò 
(
òò 
$str
òò *
)
òò* +
;
òò+ ,
}
ôô 
app
öö 
.
öö 
UseAuthentication
öö !
(
öö! "
)
öö" #
;
öö# $
app
úú 
.
úú 
UseAuthorization
úú  
(
úú  !
)
úú! "
;
úú" #
app
üü 
.
üü 
UseEndpoints
üü 
(
üü 
	endpoints
üü &
=>
üü' )
{
†† 
	endpoints
°° 
.
°° 
MapHub
°°  
<
°°  !
	NotifyHub
°°! *
>
°°* +
(
°°+ ,
$str
°°, 9
)
°°9 :
;
°°: ;
	endpoints
¢¢ 
.
¢¢ 
MapControllers
¢¢ (
(
¢¢( )
)
¢¢) *
;
¢¢* +
}
££ 
)
££ 
;
££ 
}
•• 	
}
¶¶ 
}ßß 